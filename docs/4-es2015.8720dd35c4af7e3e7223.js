(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"5Pgx":function(t,c,i){"use strict";i.d(c,"a",(function(){return E}));var s=i("d2bA"),e=i("C7yL"),r=i("g/JT"),n=i("fXoL"),o=i("tyNb"),a=i("pr82"),b=i("DLVw"),d=i("QLLi"),u=i("5eHb"),l=i("LqlI"),h=i("OpGx"),m=i("ofXK"),f=i("C4D8"),g=i("6No5"),p=i("3Pt+");function y(t,c){1&t&&(n.cc(0,"div",21),n.cc(1,"h4"),n.Lc(2,"No records found"),n.bc(),n.bc())}function v(t,c){if(1&t){const t=n.dc();n.ac(0),n.cc(1,"button",28),n.kc("click",(function(){n.Dc(t);const c=n.mc().$implicit;return n.mc(2).onAssign(c)})),n.Xb(2,"i",29),n.bc(),n.Zb()}}function _(t,c){if(1&t){const t=n.dc();n.ac(0),n.cc(1,"button",30),n.kc("click",(function(){n.Dc(t);const c=n.mc().$implicit;return n.mc(2).onDelete(c)})),n.Xb(2,"i",31),n.bc(),n.Zb()}}function S(t,c){if(1&t&&(n.cc(0,"tr"),n.cc(1,"td"),n.Lc(2),n.bc(),n.cc(3,"td"),n.Lc(4),n.bc(),n.cc(5,"td"),n.Lc(6),n.bc(),n.cc(7,"td"),n.Lc(8),n.bc(),n.cc(9,"td"),n.Lc(10),n.bc(),n.cc(11,"td",26),n.Jc(12,v,3,0,"ng-container",27),n.Jc(13,_,3,0,"ng-container",27),n.bc(),n.bc()),2&t){const t=c.$implicit,i=n.mc(2);n.Kb(2),n.Mc(t.username),n.Kb(2),n.Mc(t.email),n.Kb(2),n.Mc(t.first_name),n.Kb(2),n.Mc(t.last_name),n.Kb(2),n.Mc(i.getUserRoles(t)),n.Kb(2),n.sc("ngIf",0===i.tab),n.Kb(1),n.sc("ngIf",1===i.tab)}}function L(t,c){if(1&t){const t=n.dc();n.cc(0,"div",22),n.cc(1,"table",23),n.cc(2,"thead"),n.cc(3,"tr"),n.cc(4,"th"),n.cc(5,"app-sort-column",24),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(6,"th"),n.cc(7,"app-sort-column",24),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(8,"th"),n.cc(9,"app-sort-column",24),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(10,"th"),n.cc(11,"app-sort-column",24),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(12,"th"),n.Lc(13,"Role"),n.bc(),n.Xb(14,"th"),n.bc(),n.bc(),n.cc(15,"tbody"),n.Jc(16,S,14,7,"tr",25),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(5),n.sc("name","Username")("sort","username")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","First name")("sort","first_name")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Last name")("sort","last_name")("dir",t.sortDir)("current",t.sort),n.Kb(5),n.sc("ngForOf",t.list)}}function k(t,c){if(1&t){const t=n.dc();n.cc(0,"div",32),n.cc(1,"div",33),n.cc(2,"pagination",34),n.kc("ngModelChange",(function(c){return n.Dc(t),n.mc().page=c}))("pageChanged",(function(c){return n.Dc(t),n.mc().pageChanged(c)})),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(2),n.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}const D=function(t){return{active:t}};let E=(()=>{class t{constructor(t,c,i,s,n,o,a){this.route=t,this.router=c,this.userService=i,this.buyerService=s,this.msService=n,this.toastr=o,this.modalService=a,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=e.a.PAGE_SIZE,this.page=1,this.search="",this.sort="username",this.sortDir="asc",this.tab=0,this.sx=0,this.sy=0,this.uiState="setup.buyer.user-listing",this.isEmpty=r.a.isEmpty,this.PAGE_SIZE=e.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=e.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){if(""!==this.search)return void this.onSearch(this.search);this.isLoading=!0;let t=null;t=0===this.tab?this.userService.listPending(this.page,e.a.PAGE_SIZE,this.sort,this.sortDir):this.userService.listActive(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir),t.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}onSearch(t){this.search=t,this.isLoading=!0;let c=null;c=0===this.tab?this.userService.searchPending(this.page,e.a.PAGE_SIZE,this.sort,this.sortDir,t):this.userService.searchActive(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir,t),c.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="username",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}onTab(t){return this.tab!==t&&(this.page=1),this.tab=t,this.load(),!1}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onAssign(t){this.userService.assign({buyer_id:this.buyer_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully assigned"),this.load()})}onDelete(t){this.bsModalRef=this.modalService.show(s.a,{initialState:{title:"Delete User from "+this._buyer,message:`Are you sure to delete this User ${t.username} from ${this._buyer} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.userService.remove({buyer_id:this.buyer_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully deleted"),this.load()})})}getUserRoles(t){return t.groups.map(t=>t.name).join(", ")}get _buyer(){return this.buyer.replace(" - ","")}}return t.\u0275fac=function(c){return new(c||t)(n.Wb(o.a),n.Wb(o.g),n.Wb(a.a),n.Wb(b.a),n.Wb(d.a),n.Wb(u.b),n.Wb(l.b))},t.\u0275cmp=n.Qb({type:t,selectors:[["app-user-listing"]],decls:28,vars:11,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"fas","fa-chevron-circle-left"],[1,"card-body"],["role","tablist",1,"nav","nav-tabs"],[1,"nav-item"],["data-toggle","pill","href","#","role","tab",1,"nav-link",3,"ngClass","click"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],[4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(n.cc(0,"section",0),n.cc(1,"div",1),n.cc(2,"div",2),n.cc(3,"div",3),n.cc(4,"h1",4),n.Lc(5),n.bc(),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(6,"section",5),n.cc(7,"div",1),n.cc(8,"div",6),n.cc(9,"div",7),n.cc(10,"div",8),n.cc(11,"div",9),n.cc(12,"app-search-input",10),n.kc("onSearch",(function(t){return c.onSearch(t)})),n.bc(),n.bc(),n.cc(13,"div",11),n.cc(14,"button",12),n.kc("click",(function(){return c.onBack()})),n.Xb(15,"i",13),n.Lc(16," Back"),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(17,"div",14),n.cc(18,"ul",15),n.cc(19,"li",16),n.cc(20,"a",17),n.kc("click",(function(){return c.onTab(1)})),n.Lc(21,"Active"),n.bc(),n.bc(),n.cc(22,"li",16),n.cc(23,"a",17),n.kc("click",(function(){return c.onTab(0)})),n.Lc(24,"Pending"),n.bc(),n.bc(),n.bc(),n.Jc(25,y,3,0,"div",18),n.Jc(26,L,17,17,"div",19),n.bc(),n.Jc(27,k,3,4,"div",20),n.bc(),n.bc(),n.bc()),2&t&&(n.Kb(5),n.Nc("User Listing ",c.buyer,""),n.Kb(7),n.sc("search",c.search),n.Kb(8),n.sc("ngClass",n.vc(7,D,1===c.tab)),n.Kb(3),n.sc("ngClass",n.vc(9,D,0===c.tab)),n.Kb(2),n.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",c.totalCount))},directives:[h.a,m.k,m.m,f.a,m.l,g.a,p.j,p.l],styles:[""]}),t})()},LNgY:function(t,c,i){"use strict";i.d(c,"a",(function(){return S}));var s=i("d2bA"),e=i("C7yL"),r=i("g/JT"),n=i("fXoL"),o=i("tyNb"),a=i("DLVw"),b=i("QLLi"),d=i("5eHb"),u=i("LqlI"),l=i("OpGx"),h=i("ofXK"),m=i("C4D8"),f=i("6No5"),g=i("3Pt+");function p(t,c){1&t&&(n.cc(0,"div",18),n.cc(1,"h4"),n.Lc(2,"No records found"),n.bc(),n.bc())}function y(t,c){if(1&t){const t=n.dc();n.cc(0,"tr"),n.cc(1,"td"),n.Lc(2),n.bc(),n.cc(3,"td"),n.Lc(4),n.bc(),n.cc(5,"td"),n.Lc(6),n.bc(),n.cc(7,"td"),n.Lc(8),n.bc(),n.cc(9,"td"),n.Lc(10),n.bc(),n.cc(11,"td"),n.Lc(12),n.bc(),n.cc(13,"td"),n.Lc(14),n.bc(),n.cc(15,"td"),n.Lc(16),n.bc(),n.cc(17,"td"),n.Lc(18),n.bc(),n.cc(19,"td"),n.Lc(20),n.bc(),n.cc(21,"td"),n.cc(22,"button",23),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onTruck(i)})),n.Xb(23,"i",24),n.bc(),n.bc(),n.cc(24,"td"),n.cc(25,"button",23),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onDriver(i)})),n.Xb(26,"i",25),n.bc(),n.bc(),n.cc(27,"td"),n.cc(28,"button",23),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onUser(i)})),n.Xb(29,"i",26),n.bc(),n.bc(),n.cc(30,"td",27),n.cc(31,"button",28),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onEdit(i)})),n.Xb(32,"i",29),n.bc(),n.cc(33,"button",30),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onDelete(i)})),n.Xb(34,"i",31),n.bc(),n.bc(),n.bc()}if(2&t){const t=c.$implicit;n.Kb(2),n.Mc(t.name),n.Kb(2),n.Mc(t.registration_num),n.Kb(2),n.Mc(t.contact_no),n.Kb(2),n.Mc(t.email),n.Kb(2),n.Mc(t.fax_no),n.Kb(2),n.Mc(t.addr_line_1),n.Kb(2),n.Mc(t.postcode),n.Kb(2),n.Mc(t.city),n.Kb(2),n.Mc(t.state.name),n.Kb(2),n.Mc(t.country.name)}}function v(t,c){if(1&t){const t=n.dc();n.cc(0,"div",19),n.cc(1,"table",20),n.cc(2,"thead"),n.cc(3,"tr"),n.cc(4,"th"),n.cc(5,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(6,"th"),n.cc(7,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(8,"th"),n.cc(9,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(10,"th"),n.cc(11,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(12,"th"),n.cc(13,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(14,"th"),n.cc(15,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(16,"th"),n.cc(17,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(18,"th"),n.cc(19,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(20,"th"),n.cc(21,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(22,"th"),n.cc(23,"app-sort-column",21),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(24,"th"),n.Lc(25,"Trucks"),n.bc(),n.cc(26,"th"),n.Lc(27,"Drivers"),n.bc(),n.cc(28,"th"),n.Lc(29,"Users"),n.bc(),n.Xb(30,"th"),n.bc(),n.bc(),n.cc(31,"tbody"),n.Jc(32,y,35,10,"tr",22),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(5),n.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Business Reg. No.")("sort","registration_num")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Contact No.")("sort","contact_no")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Fax No.")("sort","fax_no")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Address 1")("sort","addr_line_1")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Postcode")("sort","pstcode")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","City")("sort","city")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","State")("sort","state__name")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","Country")("sort","country__name")("dir",t.sortDir)("current",t.sort),n.Kb(9),n.sc("ngForOf",t.list)}}function _(t,c){if(1&t){const t=n.dc();n.cc(0,"div",32),n.cc(1,"div",33),n.cc(2,"pagination",34),n.kc("ngModelChange",(function(c){return n.Dc(t),n.mc().page=c}))("pageChanged",(function(c){return n.Dc(t),n.mc().pageChanged(c)})),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(2),n.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let S=(()=>{class t{constructor(t,c,i,s,n){this.router=t,this.buyerService=c,this.msService=i,this.toastr=s,this.modalService=n,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=e.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.buyer-listing",this.isEmpty=r.a.isEmpty,this.PAGE_SIZE=e.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=e.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.buyerService.list(this.page,e.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.buyerService.search(this.page,e.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/buyer/"+t])}onTruck(t){this.goto(`truck/${t.id}/list`)}onDriver(t){this.goto(`driver/${t.id}/list`)}onUser(t){this.goto(`user/${t.id}/list`)}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(s.a,{initialState:{title:"Delete Buyer",message:`Are you sure to delete this Buyer ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.buyerService.remove(t.id).subscribe(t=>{this.toastr.success("Buyer successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(n.Wb(o.g),n.Wb(a.a),n.Wb(b.a),n.Wb(d.b),n.Wb(u.b))},t.\u0275cmp=n.Qb({type:t,selectors:[["app-buyer-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-truck"],[1,"fas","fa-id-card"],[1,"fas","fa-user"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(n.cc(0,"section",0),n.cc(1,"div",1),n.cc(2,"div",2),n.cc(3,"div",3),n.cc(4,"h1",4),n.Lc(5,"Buyer Listing"),n.bc(),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(6,"section",5),n.cc(7,"div",1),n.cc(8,"div",6),n.cc(9,"div",7),n.cc(10,"div",8),n.cc(11,"div",9),n.cc(12,"app-search-input",10),n.kc("onSearch",(function(t){return c.onSearch(t)})),n.bc(),n.bc(),n.cc(13,"div",11),n.cc(14,"button",12),n.kc("click",(function(){return c.goto("create")})),n.Xb(15,"i",13),n.Lc(16," Add New"),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(17,"div",14),n.Jc(18,p,3,0,"div",15),n.Jc(19,v,33,41,"div",16),n.bc(),n.Jc(20,_,3,4,"div",17),n.bc(),n.bc(),n.bc()),2&t&&(n.Kb(12),n.sc("search",c.search),n.Kb(6),n.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",c.totalCount))},directives:[l.a,h.m,m.a,h.l,f.a,g.j,g.l],styles:[""]}),t})()},VuLe:function(t,c,i){"use strict";i.d(c,"a",(function(){return D}));var s=i("3Pt+"),e=i("LvDl"),r=i.n(e),n=i("fwOm"),o=i("fXoL"),a=i("tyNb"),b=i("wgH9"),d=i("DLVw"),u=i("5eHb"),l=i("ofXK"),h=i("ZOsW");function m(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Name is required "),o.bc())}function f(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Business Registration No. is required "),o.bc())}function g(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Contact No. is required "),o.bc())}function p(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Address 1 is required "),o.bc())}function y(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Postcode is required "),o.bc())}function v(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," City is required "),o.bc())}function _(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," State is required "),o.bc())}function S(t,c){1&t&&(o.cc(0,"small",36),o.Lc(1," Country is required "),o.bc())}const L=function(t){return{"is-invalid":t}};function k(t,c){if(1&t){const t=o.dc();o.cc(0,"div",1),o.cc(1,"form",7),o.kc("ngSubmit",(function(){return o.Dc(t),o.mc().onSubmit()})),o.cc(2,"div",8),o.cc(3,"div",9),o.cc(4,"div",10),o.cc(5,"label",11),o.Lc(6,"Name\xa0"),o.cc(7,"span",12),o.Lc(8,"*"),o.bc(),o.bc(),o.cc(9,"div",13),o.Xb(10,"input",14),o.Jc(11,m,2,0,"small",15),o.bc(),o.bc(),o.cc(12,"div",10),o.cc(13,"label",11),o.Lc(14,"Business Registration No.\xa0"),o.cc(15,"span",12),o.Lc(16,"*"),o.bc(),o.bc(),o.cc(17,"div",13),o.Xb(18,"input",16),o.Jc(19,f,2,0,"small",15),o.bc(),o.bc(),o.cc(20,"div",10),o.cc(21,"label",11),o.Lc(22,"Contact No.\xa0"),o.cc(23,"span",12),o.Lc(24,"*"),o.bc(),o.bc(),o.cc(25,"div",13),o.Xb(26,"input",17),o.Jc(27,g,2,0,"small",15),o.bc(),o.bc(),o.cc(28,"div",10),o.cc(29,"label",11),o.Lc(30,"Email"),o.bc(),o.cc(31,"div",13),o.Xb(32,"input",18),o.bc(),o.bc(),o.cc(33,"div",10),o.cc(34,"label",11),o.Lc(35,"Fax No."),o.bc(),o.cc(36,"div",13),o.Xb(37,"input",19),o.bc(),o.bc(),o.cc(38,"div",10),o.cc(39,"label",11),o.Lc(40,"Address\xa0"),o.cc(41,"span",12),o.Lc(42,"*"),o.bc(),o.bc(),o.cc(43,"div",13),o.Xb(44,"input",20),o.Jc(45,p,2,0,"small",15),o.bc(),o.bc(),o.cc(46,"div",10),o.cc(47,"div",21),o.Xb(48,"input",22),o.bc(),o.bc(),o.cc(49,"div",10),o.cc(50,"div",21),o.Xb(51,"input",23),o.bc(),o.bc(),o.cc(52,"div",10),o.cc(53,"label",11),o.Lc(54,"Postcode\xa0"),o.cc(55,"span",12),o.Lc(56,"*"),o.bc(),o.bc(),o.cc(57,"div",24),o.Xb(58,"input",25),o.Jc(59,y,2,0,"small",15),o.bc(),o.cc(60,"label",26),o.Lc(61,"City\xa0"),o.cc(62,"span",12),o.Lc(63,"*"),o.bc(),o.bc(),o.cc(64,"div",27),o.Xb(65,"input",28),o.Jc(66,v,2,0,"small",15),o.bc(),o.bc(),o.cc(67,"div",10),o.cc(68,"label",11),o.Lc(69,"State\xa0"),o.cc(70,"span",12),o.Lc(71,"*"),o.bc(),o.bc(),o.cc(72,"div",24),o.Xb(73,"ng-select",29),o.Jc(74,_,2,0,"small",15),o.bc(),o.cc(75,"label",26),o.Lc(76,"Country\xa0"),o.cc(77,"span",12),o.Lc(78,"*"),o.bc(),o.bc(),o.cc(79,"div",27),o.cc(80,"ng-select",30),o.kc("change",(function(c){return o.Dc(t),o.mc().onChangeCountry(c)})),o.bc(),o.Jc(81,S,2,0,"small",15),o.bc(),o.bc(),o.bc(),o.cc(82,"div",31),o.cc(83,"button",32),o.kc("click",(function(){return o.Dc(t),o.mc().onBack()})),o.Xb(84,"i",33),o.Lc(85," Back"),o.bc(),o.cc(86,"button",34),o.Xb(87,"i",35),o.Lc(88," Save"),o.bc(),o.bc(),o.bc(),o.bc(),o.bc()}if(2&t){const t=o.mc();o.Kb(1),o.sc("formGroup",t.mform),o.Kb(9),o.sc("ngClass",o.vc(17,L,t.invalid("name"))),o.Kb(1),o.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),o.Kb(7),o.sc("ngClass",o.vc(19,L,t.invalid("registration_num"))),o.Kb(1),o.sc("ngIf",t.invalid("registration_num")&&t.f.registration_num.hasError("required")),o.Kb(7),o.sc("ngClass",o.vc(21,L,t.invalid("contact_no"))),o.Kb(1),o.sc("ngIf",t.invalid("contact_no")&&t.f.contact_no.hasError("required")),o.Kb(17),o.sc("ngClass",o.vc(23,L,t.invalid("addr_line_1"))),o.Kb(1),o.sc("ngIf",t.invalid("addr_line_1")&&t.f.addr_line_1.hasError("required")),o.Kb(13),o.sc("ngClass",o.vc(25,L,t.invalid("postcode"))),o.Kb(1),o.sc("ngIf",t.invalid("postcode")&&t.f.postcode.hasError("required")),o.Kb(6),o.sc("ngClass",o.vc(27,L,t.invalid("city"))),o.Kb(1),o.sc("ngIf",t.invalid("city")&&t.f.city.hasError("required")),o.Kb(7),o.sc("items",t.stateList),o.Kb(1),o.sc("ngIf",t.invalid("state_id")&&t.f.state_id.hasError("required")),o.Kb(6),o.sc("items",t.countryList),o.Kb(1),o.sc("ngIf",t.invalid("country_id")&&t.f.country_id.hasError("required"))}}let D=(()=>{class t extends n.a{constructor(t,c,i,s,e,r){super(),this.fb=t,this.route=c,this.router=i,this.lookupService=s,this.buyerService=e,this.toastr=r,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),r.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[s.r.required]],registration_num:["",[s.r.required]],contact_no:["",[s.r.required]],email:[""],fax_no:[""],addr_line_1:["",[s.r.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[s.r.required]],city:["",[s.r.required]],state_id:[null,[s.r.required]],country_id:[null,[s.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,registration_num:t.registration_num,contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,country_id:t.country.id}),this.lookupService.listStates(t.country.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({state_id:t.state.id})})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(t=>{this.countryList=t,this.mform.patchValue({country_id:this.countryList[0].id}),this.onChangeCountry(this.countryList[0]),this.loadDetails()},t=>{this.isLoading=!1})}loadDetails(){r.a.isNull(this.id)||r.a.isUndefined(this.id)?this.isLoading=!1:this.buyerService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,registration_num:t.registration_num,contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,state_id:t.state_id,country_id:t.country_id};this.isEdit?this.buyerService.update(this.data.id,c).subscribe(t=>{this.toastr.success("Buyer successfully updated")}):this.buyerService.create(c).subscribe(t=>{this.toastr.success("New Buyer successfully created"),this.mform.reset()})}onChangeCountry(t){this.lookupService.listStates(t.id).subscribe(t=>{this.stateList=t,this.mform.patchValue({state_id:null})})}}return t.\u0275fac=function(c){return new(c||t)(o.Wb(s.c),o.Wb(a.a),o.Wb(a.g),o.Wb(b.a),o.Wb(d.a),o.Wb(u.b))},t.\u0275cmp=o.Qb({type:t,selectors:[["app-buyer-create"]],features:[o.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(o.cc(0,"section",0),o.cc(1,"div",1),o.cc(2,"div",2),o.cc(3,"div",3),o.cc(4,"h1",4),o.Lc(5,"Add / Edit Buyer"),o.bc(),o.bc(),o.bc(),o.bc(),o.bc(),o.cc(6,"section",5),o.Jc(7,k,89,29,"div",6),o.bc()),2&t&&(o.Kb(7),o.sc("ngIf",!c.isLoading))},directives:[l.m,s.t,s.k,s.e,s.a,s.j,s.d,l.k,h.a],styles:[""]}),t})()},"a+IK":function(t,c,i){"use strict";i.d(c,"a",(function(){return n}));var s=i("tk/3"),e=i("AytR"),r=i("fXoL");let n=(()=>{class t{constructor(t){this.http=t,this.baseUrl=e.a.baseUrl}list(t,c,i,e){let r=(new s.f).set("_page",t).set("_limit",c);return""!==i&&(""===e&&(e="asc"),r=r.append("sort",`${i}:${e}`)),this.http.get(this.baseUrl+"/api/mining-companies",{params:r,observe:"response"})}search(t,c,i,e,r){let n=(new s.f).set("_page",t).set("_limit",c);return""!==i&&(""===e&&(e="asc"),n=n.append("sort",`${i}:${e}`)),this.http.post(this.baseUrl+"/api/mining-companies",{keyword:r},{params:n,observe:"response"})}create(t){return this.http.post(this.baseUrl+"/api/mining-company",t)}edit(t){return this.http.get(`${this.baseUrl}/api/mining-company/${t}`)}update(t,c){return this.http.put(`${this.baseUrl}/api/mining-company/${t}`,c)}remove(t){return this.http.delete(`${this.baseUrl}/api/mining-company/${t}`)}}return t.\u0275fac=function(c){return new(c||t)(r.gc(s.b))},t.\u0275prov=r.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},bOQg:function(t,c,i){"use strict";i.d(c,"a",(function(){return f}));var s=i("3Pt+"),e=i("LvDl"),r=i.n(e),n=i("fwOm"),o=i("fXoL"),a=i("tyNb"),b=i("lSWO"),d=i("5eHb"),u=i("ofXK");function l(t,c){1&t&&(o.cc(0,"div",3),o.cc(1,"div",18),o.cc(2,"div",19),o.cc(3,"h1",20),o.Lc(4,"Add / Edit Truck"),o.bc(),o.bc(),o.bc(),o.bc())}function h(t,c){1&t&&(o.cc(0,"small",21),o.Lc(1," Registration No. is required "),o.bc())}const m=function(t){return{"is-invalid":t}};let f=(()=>{class t extends n.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.truckService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),this.buyer_id=t.get("buyer_id"),r.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({registration_num:["",[s.r.required]]})}setForm(){this.mform.patchValue({registration_num:this.data.registration_num})}load(){r.a.isNull(this.id)||r.a.isUndefined(this.id)||(this.isLoading=!0,this.truckService.edit(this.buyer_id,this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate([`/ams/setup/buyer/truck/${this.buyer_id}/list`])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t={registration_num:this.mform.value.registration_num,buyer_id:this.buyer_id};this.isEdit?this.truckService.update(this.buyer_id,this.data.id,t).subscribe(t=>{this.toastr.success("Truck successfully updated")}):this.truckService.create(this.buyer_id,t).subscribe(t=>{this.toastr.success("New Truck successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(o.Wb(s.c),o.Wb(a.a),o.Wb(a.g),o.Wb(b.a),o.Wb(d.b))},t.\u0275cmp=o.Qb({type:t,selectors:[["app-truck-create"]],features:[o.Hb],decls:22,vars:6,consts:[[1,"content-header"],["class","container-fluid",4,"ngIf"],[1,"content"],[1,"container-fluid"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(o.cc(0,"section",0),o.Jc(1,l,5,0,"div",1),o.bc(),o.cc(2,"section",2),o.cc(3,"div",3),o.cc(4,"form",4),o.kc("ngSubmit",(function(){return c.onSubmit()})),o.cc(5,"div",5),o.cc(6,"div",6),o.cc(7,"div",7),o.cc(8,"label",8),o.Lc(9,"Registration No.\xa0"),o.cc(10,"span",9),o.Lc(11,"*"),o.bc(),o.bc(),o.cc(12,"div",10),o.Xb(13,"input",11),o.Jc(14,h,2,0,"small",12),o.bc(),o.bc(),o.bc(),o.cc(15,"div",13),o.cc(16,"button",14),o.kc("click",(function(){return c.onBack()})),o.Xb(17,"i",15),o.Lc(18," Back"),o.bc(),o.cc(19,"button",16),o.Xb(20,"i",17),o.Lc(21," Save"),o.bc(),o.bc(),o.bc(),o.bc(),o.bc(),o.bc()),2&t&&(o.Kb(1),o.sc("ngIf",!c.isLoading),o.Kb(3),o.sc("formGroup",c.mform),o.Kb(9),o.sc("ngClass",o.vc(4,m,c.invalid("registration_num"))),o.Kb(1),o.sc("ngIf",c.invalid("registration_num")&&c.f.registration_num.hasError("required")))},directives:[u.m,s.t,s.k,s.e,s.a,s.j,s.d,u.k],styles:[""]}),t})()},eUtn:function(t,c,i){"use strict";i.d(c,"a",(function(){return L}));var s=i("d2bA"),e=i("C7yL"),r=i("g/JT"),n=i("fXoL"),o=i("tyNb"),a=i("lSWO"),b=i("DLVw"),d=i("QLLi"),u=i("5eHb"),l=i("LqlI"),h=i("OpGx"),m=i("ofXK"),f=i("C4D8"),g=i("6No5"),p=i("3Pt+");function y(t,c){1&t&&(n.cc(0,"div",20),n.cc(1,"h4"),n.Lc(2,"No records found"),n.bc(),n.bc())}function v(t,c){if(1&t){const t=n.dc();n.cc(0,"tr"),n.cc(1,"td"),n.Lc(2),n.bc(),n.cc(3,"td",25),n.cc(4,"button",26),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onEdit(i)})),n.Xb(5,"i",27),n.bc(),n.cc(6,"button",28),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onDelete(i)})),n.Xb(7,"i",29),n.bc(),n.bc(),n.bc()}if(2&t){const t=c.$implicit;n.Kb(2),n.Mc(t.registration_num)}}function _(t,c){if(1&t){const t=n.dc();n.cc(0,"div",21),n.cc(1,"table",22),n.cc(2,"thead"),n.cc(3,"tr"),n.cc(4,"th"),n.cc(5,"app-sort-column",23),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.Xb(6,"th"),n.bc(),n.bc(),n.cc(7,"tbody"),n.Jc(8,v,8,1,"tr",24),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(5),n.sc("name","Registration No.")("sort","registration_num")("dir",t.sortDir)("current",t.sort),n.Kb(3),n.sc("ngForOf",t.list)}}function S(t,c){if(1&t){const t=n.dc();n.cc(0,"div",30),n.cc(1,"div",31),n.cc(2,"pagination",32),n.kc("ngModelChange",(function(c){return n.Dc(t),n.mc().page=c}))("pageChanged",(function(c){return n.Dc(t),n.mc().pageChanged(c)})),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(2),n.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let L=(()=>{class t{constructor(t,c,i,s,n,o,a){this.route=t,this.router=c,this.truckService=i,this.buyerService=s,this.msService=n,this.toastr=o,this.modalService=a,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=e.a.PAGE_SIZE,this.page=1,this.search="",this.sort="registration_num",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.truck-listing",this.isEmpty=r.a.isEmpty,this.PAGE_SIZE=e.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=e.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){""===this.search?(this.isLoading=!0,this.truckService.list(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.truckService.search(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="registration_num",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate([`/ams/setup/buyer/truck/${this.buyer_id}/${t}`])}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(s.a,{initialState:{title:"Delete Truck",message:`Are you sure to delete this Truck ${t.registration_num} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.truckService.remove(this.buyer_id,t.id).subscribe(t=>{this.toastr.success("Truck successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(n.Wb(o.a),n.Wb(o.g),n.Wb(a.a),n.Wb(b.a),n.Wb(d.a),n.Wb(u.b),n.Wb(l.b))},t.\u0275cmp=n.Qb({type:t,selectors:[["app-truck-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(n.cc(0,"section",0),n.cc(1,"div",1),n.cc(2,"div",2),n.cc(3,"div",3),n.cc(4,"h1",4),n.Lc(5),n.bc(),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(6,"section",5),n.cc(7,"div",1),n.cc(8,"div",6),n.cc(9,"div",7),n.cc(10,"div",8),n.cc(11,"div",9),n.cc(12,"app-search-input",10),n.kc("onSearch",(function(t){return c.onSearch(t)})),n.bc(),n.bc(),n.cc(13,"div",11),n.cc(14,"button",12),n.kc("click",(function(){return c.onBack()})),n.Xb(15,"i",13),n.Lc(16," Back"),n.bc(),n.cc(17,"button",14),n.kc("click",(function(){return c.goto("create")})),n.Xb(18,"i",15),n.Lc(19," Add New"),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(20,"div",16),n.Jc(21,y,3,0,"div",17),n.Jc(22,_,9,5,"div",18),n.bc(),n.Jc(23,S,3,4,"div",19),n.bc(),n.bc(),n.bc()),2&t&&(n.Kb(5),n.Nc("Truck Listing ",c.buyer,""),n.Kb(7),n.sc("search",c.search),n.Kb(9),n.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",c.totalCount))},directives:[h.a,m.m,f.a,m.l,g.a,p.j,p.l],styles:[""]}),t})()},fdx9:function(t,c,i){"use strict";i.d(c,"a",(function(){return L}));var s=i("d2bA"),e=i("C7yL"),r=i("g/JT"),n=i("fXoL"),o=i("tyNb"),a=i("kny6"),b=i("DLVw"),d=i("QLLi"),u=i("5eHb"),l=i("LqlI"),h=i("OpGx"),m=i("ofXK"),f=i("C4D8"),g=i("6No5"),p=i("3Pt+");function y(t,c){1&t&&(n.cc(0,"div",20),n.cc(1,"h4"),n.Lc(2,"No records found"),n.bc(),n.bc())}function v(t,c){if(1&t){const t=n.dc();n.cc(0,"tr"),n.cc(1,"td"),n.Lc(2),n.bc(),n.cc(3,"td"),n.Lc(4),n.bc(),n.cc(5,"td",25),n.cc(6,"button",26),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onEdit(i)})),n.Xb(7,"i",27),n.bc(),n.cc(8,"button",28),n.kc("click",(function(){n.Dc(t);const i=c.$implicit;return n.mc(2).onDelete(i)})),n.Xb(9,"i",29),n.bc(),n.bc(),n.bc()}if(2&t){const t=c.$implicit;n.Kb(2),n.Mc(t.name),n.Kb(2),n.Mc(t.id_num)}}function _(t,c){if(1&t){const t=n.dc();n.cc(0,"div",21),n.cc(1,"table",22),n.cc(2,"thead"),n.cc(3,"tr"),n.cc(4,"th"),n.cc(5,"app-sort-column",23),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.cc(6,"th"),n.cc(7,"app-sort-column",23),n.kc("onSortBy",(function(c){return n.Dc(t),n.mc().onSortBy(c)})),n.bc(),n.bc(),n.Xb(8,"th"),n.bc(),n.bc(),n.cc(9,"tbody"),n.Jc(10,v,10,2,"tr",24),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(5),n.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),n.Kb(2),n.sc("name","ID Number")("sort","id_num")("dir",t.sortDir)("current",t.sort),n.Kb(3),n.sc("ngForOf",t.list)}}function S(t,c){if(1&t){const t=n.dc();n.cc(0,"div",30),n.cc(1,"div",31),n.cc(2,"pagination",32),n.kc("ngModelChange",(function(c){return n.Dc(t),n.mc().page=c}))("pageChanged",(function(c){return n.Dc(t),n.mc().pageChanged(c)})),n.bc(),n.bc(),n.bc()}if(2&t){const t=n.mc();n.Kb(2),n.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let L=(()=>{class t{constructor(t,c,i,s,n,o,a){this.route=t,this.router=c,this.driverService=i,this.buyerService=s,this.msService=n,this.toastr=o,this.modalService=a,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=e.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.driver-listing",this.isEmpty=r.a.isEmpty,this.PAGE_SIZE=e.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=e.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){""===this.search?(this.isLoading=!0,this.driverService.list(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.driverService.search(this.buyer_id,this.page,e.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(e.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate([`/ams/setup/buyer/driver/${this.buyer_id}/${t}`])}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(s.a,{initialState:{title:"Delete Driver",message:`Are you sure to delete this Driver ${t.id_num} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.driverService.remove(this.buyer_id,t.id).subscribe(t=>{this.toastr.success("Driver successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(n.Wb(o.a),n.Wb(o.g),n.Wb(a.a),n.Wb(b.a),n.Wb(d.a),n.Wb(u.b),n.Wb(l.b))},t.\u0275cmp=n.Qb({type:t,selectors:[["app-driver-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(n.cc(0,"section",0),n.cc(1,"div",1),n.cc(2,"div",2),n.cc(3,"div",3),n.cc(4,"h1",4),n.Lc(5),n.bc(),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(6,"section",5),n.cc(7,"div",1),n.cc(8,"div",6),n.cc(9,"div",7),n.cc(10,"div",8),n.cc(11,"div",9),n.cc(12,"app-search-input",10),n.kc("onSearch",(function(t){return c.onSearch(t)})),n.bc(),n.bc(),n.cc(13,"div",11),n.cc(14,"button",12),n.kc("click",(function(){return c.onBack()})),n.Xb(15,"i",13),n.Lc(16," Back"),n.bc(),n.cc(17,"button",14),n.kc("click",(function(){return c.goto("create")})),n.Xb(18,"i",15),n.Lc(19," Add New"),n.bc(),n.bc(),n.bc(),n.bc(),n.cc(20,"div",16),n.Jc(21,y,3,0,"div",17),n.Jc(22,_,11,9,"div",18),n.bc(),n.Jc(23,S,3,4,"div",19),n.bc(),n.bc(),n.bc()),2&t&&(n.Kb(5),n.Nc("Driver Listing ",c.buyer,""),n.Kb(7),n.sc("search",c.search),n.Kb(9),n.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),n.Kb(1),n.sc("ngIf",c.totalCount))},directives:[h.a,m.m,f.a,m.l,g.a,p.j,p.l],styles:[""]}),t})()},pr82:function(t,c,i){"use strict";i.d(c,"a",(function(){return n}));var s=i("tk/3"),e=i("AytR"),r=i("fXoL");let n=(()=>{class t{constructor(t){this.http=t,this.baseUrl=e.a.baseUrl}listPending(t,c,i,e){let r=(new s.f).set("_page",t).set("_limit",c);return""!==i&&(""===e&&(e="asc"),r=r.append("sort",`${i}:${e}`)),this.http.get(this.baseUrl+"/api/assign/buyers",{params:r,observe:"response"})}searchPending(t,c,i,e,r){let n=(new s.f).set("_page",t).set("_limit",c);return""!==i&&(""===e&&(e="asc"),n=n.append("sort",`${i}:${e}`)),this.http.post(this.baseUrl+"/api/assign/buyers",{keyword:r},{params:n,observe:"response"})}listActive(t,c,i,e,r){let n=(new s.f).set("_page",c).set("_limit",i);return""!==e&&(""===r&&(r="asc"),n=n.append("sort",`${e}:${r}`)),this.http.get(`${this.baseUrl}/api/assigned/buyers/${t}`,{params:n,observe:"response"})}searchActive(t,c,i,e,r,n){let o=(new s.f).set("_page",c).set("_limit",i);return""!==e&&(""===r&&(r="asc"),o=o.append("sort",`${e}:${r}`)),this.http.post(`${this.baseUrl}/api/assigned/buyers/${t}`,{keyword:n},{params:o,observe:"response"})}assign(t){return this.http.post(this.baseUrl+"/api/assigned/buyer",t)}remove(t){return this.http.post(this.baseUrl+"/api/assigned/buyer/delete",t)}}return t.\u0275fac=function(c){return new(c||t)(r.gc(s.b))},t.\u0275prov=r.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},wWB1:function(t,c,i){"use strict";i.d(c,"a",(function(){return g}));var s=i("3Pt+"),e=i("LvDl"),r=i.n(e),n=i("fwOm"),o=i("fXoL"),a=i("tyNb"),b=i("kny6"),d=i("5eHb"),u=i("ofXK");function l(t,c){1&t&&(o.cc(0,"small",22),o.Lc(1," Name is required "),o.bc())}function h(t,c){1&t&&(o.cc(0,"small",22),o.Lc(1," ID No. is required "),o.bc())}const m=function(t){return{"is-invalid":t}};function f(t,c){if(1&t){const t=o.dc();o.cc(0,"div",1),o.cc(1,"form",7),o.kc("ngSubmit",(function(){return o.Dc(t),o.mc().onSubmit()})),o.cc(2,"div",8),o.cc(3,"div",9),o.cc(4,"div",10),o.cc(5,"label",11),o.Lc(6,"Name\xa0"),o.cc(7,"span",12),o.Lc(8,"*"),o.bc(),o.bc(),o.cc(9,"div",13),o.Xb(10,"input",14),o.Jc(11,l,2,0,"small",15),o.bc(),o.bc(),o.cc(12,"div",10),o.cc(13,"label",11),o.Lc(14,"ID No.\xa0"),o.cc(15,"span",12),o.Lc(16,"*"),o.bc(),o.bc(),o.cc(17,"div",13),o.Xb(18,"input",16),o.Jc(19,h,2,0,"small",15),o.bc(),o.bc(),o.bc(),o.cc(20,"div",17),o.cc(21,"button",18),o.kc("click",(function(){return o.Dc(t),o.mc().onBack()})),o.Xb(22,"i",19),o.Lc(23," Back"),o.bc(),o.cc(24,"button",20),o.Xb(25,"i",21),o.Lc(26," Save"),o.bc(),o.bc(),o.bc(),o.bc(),o.bc()}if(2&t){const t=o.mc();o.Kb(1),o.sc("formGroup",t.mform),o.Kb(9),o.sc("ngClass",o.vc(5,m,t.invalid("name"))),o.Kb(1),o.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),o.Kb(7),o.sc("ngClass",o.vc(7,m,t.invalid("id_num"))),o.Kb(1),o.sc("ngIf",t.invalid("id_num")&&t.f.id_num.hasError("required"))}}let g=(()=>{class t extends n.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.driverService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),this.buyer_id=t.get("buyer_id"),r.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[s.r.required]],id_num:["",[s.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,id_num:t.id_num})}load(){r.a.isNull(this.id)||r.a.isUndefined(this.id)||(this.isLoading=!0,this.driverService.edit(this.buyer_id,this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate([`/ams/setup/buyer/driver/${this.buyer_id}/list`])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,id_num:t.id_num,buyer_id:this.buyer_id};this.isEdit?this.driverService.update(this.buyer_id,this.data.id,c).subscribe(t=>{this.toastr.success("Driver successfully updated")}):this.driverService.create(this.buyer_id,c).subscribe(t=>{this.toastr.success("New Driver successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(o.Wb(s.c),o.Wb(a.a),o.Wb(a.g),o.Wb(b.a),o.Wb(d.b))},t.\u0275cmp=o.Qb({type:t,selectors:[["app-driver-create"]],features:[o.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","ID No.","name","id_num","formControlName","id_num",1,"form-control",3,"ngClass"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(o.cc(0,"section",0),o.cc(1,"div",1),o.cc(2,"div",2),o.cc(3,"div",3),o.cc(4,"h1",4),o.Lc(5,"Add / Edit Driver"),o.bc(),o.bc(),o.bc(),o.bc(),o.bc(),o.cc(6,"section",5),o.Jc(7,f,27,9,"div",6),o.bc()),2&t&&(o.Kb(7),o.sc("ngIf",!c.isLoading))},directives:[u.m,s.t,s.k,s.e,s.a,s.j,s.d,u.k],styles:[""]}),t})()}}]);