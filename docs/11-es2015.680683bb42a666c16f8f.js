(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"4gke":function(c,t,e){"use strict";e.r(t),e.d(t,"MiningCompanyModule",(function(){return nt}));var i=e("ofXK"),r=e("3Pt+"),s=e("ZOsW"),n=e("LqlI"),a=e("ienR"),o=e("6No5"),d=e("fXoL");const l=new d.w("WindowToken","undefined"!=typeof window&&window.document?{providedIn:"root",factory:()=>window}:void 0);var b=e("XNiG");let u=(()=>{let c=class{constructor(c,t){this.document=c,this.window=t,this.copySubject=new b.a,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(c){this.config=c}copy(c){if(!this.isSupported||!c)return this.pushCopyResponse({isSuccess:!1,content:c});const t=this.copyFromContent(c);return this.pushCopyResponse(t?{content:c,isSuccess:t}:{isSuccess:!1,content:c})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(c){if(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement){if(c.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(c,t=!0){try{this.selectTarget(c);const e=this.copyText();return this.clearSelection(t?c:void 0,this.window),e&&this.isCopySuccessInIE11()}catch(e){return!1}}isCopySuccessInIE11(){const c=this.window.clipboardData;return!(c&&c.getData&&!c.getData("Text"))}copyFromContent(c,t=this.document.body){if(this.tempTextArea&&!t.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{t.appendChild(this.tempTextArea)}catch(i){throw new Error("Container should be a Dom element")}}this.tempTextArea.value=c;const e=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),e}destroy(c=this.document.body){this.tempTextArea&&(c.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(c){return c.select(),c.setSelectionRange(0,c.value.length),c.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(c,t){var e;c&&c.focus(),null===(e=t.getSelection())||void 0===e||e.removeAllRanges()}createTempTextArea(c,t){const e="rtl"===c.documentElement.getAttribute("dir");let i;return i=c.createElement("textarea"),i.style.fontSize="12pt",i.style.border="0",i.style.padding="0",i.style.margin="0",i.style.position="absolute",i.style[e?"right":"left"]="-9999px",i.style.top=(t.pageYOffset||c.documentElement.scrollTop)+"px",i.setAttribute("readonly",""),i}pushCopyResponse(c){this.copySubject.next(c)}pushCopyReponse(c){this.pushCopyResponse(c)}};return c.\u0275fac=function(t){return new(t||c)(d.gc(i.d),d.gc(l,8))},c.\u0275prov=Object(d.Sb)({factory:function(){return new c(Object(d.gc)(i.d),Object(d.gc)(l,8))},token:c,providedIn:"root"}),c})(),m=(()=>{let c=class{constructor(c){this.clipboardSrv=c,this.cbOnSuccess=new d.q,this.cbOnError=new d.q}ngOnInit(){}ngOnDestroy(){this.clipboardSrv.destroy(this.container)}onClick(c){this.clipboardSrv.isSupported?this.targetElm&&this.clipboardSrv.isTargetValid(this.targetElm)?this.handleResult(this.clipboardSrv.copyFromInputElement(this.targetElm),this.targetElm.value,c):this.cbContent&&this.handleResult(this.clipboardSrv.copyFromContent(this.cbContent,this.container),this.cbContent,c):this.handleResult(!1,void 0,c)}handleResult(c,t,e){let i={isSuccess:c,event:e};c?(i=Object.assign(i,{content:t,successMessage:this.cbSuccessMsg}),this.cbOnSuccess.emit(i)):this.cbOnError.emit(i),this.clipboardSrv.pushCopyResponse(i)}};return c.\u0275fac=function(t){return new(t||c)(d.Wb(u))},c.\u0275dir=d.Rb({type:c,selectors:[["","ngxClipboard",""]],hostBindings:function(c,t){1&c&&d.kc("click",(function(c){return t.onClick(c.target)}))},inputs:{targetElm:["ngxClipboard","targetElm"],container:"container",cbContent:"cbContent",cbSuccessMsg:"cbSuccessMsg"},outputs:{cbOnSuccess:"cbOnSuccess",cbOnError:"cbOnError"}}),c})(),h=(()=>{let c=class{};return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},imports:[[i.c]]}),c})();var p=e("tyNb"),_=e("LvDl"),g=e.n(_),v=e("g/JT"),f=e("fwOm"),y=e("wgH9"),L=e("IYfF"),S=e("a+IK"),C=e("5eHb");function k(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Name is required "),d.bc())}function K(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Business Registration No. is required "),d.bc())}function E(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Mining License No. is required "),d.bc())}function I(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Contact No. is required "),d.bc())}function D(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Address 1 is required "),d.bc())}function N(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Postcode is required "),d.bc())}function w(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," City is required "),d.bc())}function M(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," State is required "),d.bc())}function O(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Country is required "),d.bc())}const x=function(c){return{"is-invalid":c}},X=function(){return{containerClass:"theme-blue",dateInputFormat:"YYYY-MM-DD"}};function T(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"form",7),d.kc("ngSubmit",(function(){return d.Dc(c),d.mc().onSubmit()})),d.cc(2,"div",8),d.cc(3,"div",9),d.cc(4,"div",10),d.cc(5,"label",11),d.Lc(6,"Name\xa0"),d.cc(7,"span",12),d.Lc(8,"*"),d.bc(),d.bc(),d.cc(9,"div",13),d.Xb(10,"input",14),d.Jc(11,k,2,0,"small",15),d.bc(),d.bc(),d.cc(12,"div",10),d.cc(13,"label",11),d.Lc(14,"Business Registration No.\xa0"),d.cc(15,"span",12),d.Lc(16,"*"),d.bc(),d.bc(),d.cc(17,"div",13),d.Xb(18,"input",16),d.Jc(19,K,2,0,"small",15),d.bc(),d.bc(),d.cc(20,"div",10),d.cc(21,"label",11),d.Lc(22,"Mining License No.\xa0"),d.cc(23,"span",12),d.Lc(24,"*"),d.bc(),d.bc(),d.cc(25,"div",13),d.Xb(26,"input",17),d.Jc(27,E,2,0,"small",15),d.bc(),d.bc(),d.cc(28,"div",10),d.cc(29,"label",11),d.Lc(30,"License Expiry\xa0"),d.cc(31,"span",12),d.Lc(32,"*"),d.bc(),d.bc(),d.cc(33,"div",18),d.cc(34,"div",19),d.Xb(35,"input",20,21),d.cc(37,"div",22),d.cc(38,"button",23),d.kc("click",(function(){return d.Dc(c),d.Bc(36).show()})),d.Xb(39,"i",24),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(40,"div",10),d.cc(41,"label",11),d.Lc(42,"Contact No.\xa0"),d.cc(43,"span",12),d.Lc(44,"*"),d.bc(),d.bc(),d.cc(45,"div",13),d.Xb(46,"input",25),d.Jc(47,I,2,0,"small",15),d.bc(),d.bc(),d.cc(48,"div",10),d.cc(49,"label",11),d.Lc(50,"Email"),d.bc(),d.cc(51,"div",13),d.Xb(52,"input",26),d.bc(),d.bc(),d.cc(53,"div",10),d.cc(54,"label",11),d.Lc(55,"Fax No."),d.bc(),d.cc(56,"div",13),d.Xb(57,"input",27),d.bc(),d.bc(),d.cc(58,"div",10),d.cc(59,"label",11),d.Lc(60,"Address\xa0"),d.cc(61,"span",12),d.Lc(62,"*"),d.bc(),d.bc(),d.cc(63,"div",13),d.Xb(64,"input",28),d.Jc(65,D,2,0,"small",15),d.bc(),d.bc(),d.cc(66,"div",10),d.cc(67,"div",29),d.Xb(68,"input",30),d.bc(),d.bc(),d.cc(69,"div",10),d.cc(70,"div",29),d.Xb(71,"input",31),d.bc(),d.bc(),d.cc(72,"div",10),d.cc(73,"label",11),d.Lc(74,"Postcode\xa0"),d.cc(75,"span",12),d.Lc(76,"*"),d.bc(),d.bc(),d.cc(77,"div",32),d.Xb(78,"input",33),d.Jc(79,N,2,0,"small",15),d.bc(),d.cc(80,"label",34),d.Lc(81,"City\xa0"),d.cc(82,"span",12),d.Lc(83,"*"),d.bc(),d.bc(),d.cc(84,"div",35),d.Xb(85,"input",36),d.Jc(86,w,2,0,"small",15),d.bc(),d.bc(),d.cc(87,"div",10),d.cc(88,"label",11),d.Lc(89,"State\xa0"),d.cc(90,"span",12),d.Lc(91,"*"),d.bc(),d.bc(),d.cc(92,"div",32),d.Xb(93,"ng-select",37),d.Jc(94,M,2,0,"small",15),d.bc(),d.cc(95,"label",34),d.Lc(96,"Country\xa0"),d.cc(97,"span",12),d.Lc(98,"*"),d.bc(),d.bc(),d.cc(99,"div",35),d.cc(100,"ng-select",38),d.kc("change",(function(t){return d.Dc(c),d.mc().onChangeCountry(t)})),d.bc(),d.Jc(101,O,2,0,"small",15),d.bc(),d.bc(),d.bc(),d.cc(102,"div",39),d.cc(103,"button",40),d.Xb(104,"i",41),d.Lc(105," Save"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.Bc(36),t=d.mc();d.Kb(1),d.sc("formGroup",t.mform),d.Kb(9),d.sc("ngClass",d.vc(23,x,t.invalid("name"))),d.Kb(1),d.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(25,x,t.invalid("registration_num"))),d.Kb(1),d.sc("ngIf",t.invalid("registration_num")&&t.f.registration_num.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(27,x,t.invalid("registration_num"))),d.Kb(1),d.sc("ngIf",t.invalid("mining_license_num")&&t.f.mining_license_num.hasError("required")),d.Kb(8),d.sc("bsConfig",d.uc(29,X)),d.Kb(3),d.Lb("aria-expanded",c.isOpen),d.Kb(8),d.sc("ngClass",d.vc(30,x,t.invalid("contact_no"))),d.Kb(1),d.sc("ngIf",t.invalid("contact_no")&&t.f.contact_no.hasError("required")),d.Kb(17),d.sc("ngClass",d.vc(32,x,t.invalid("addr_line_1"))),d.Kb(1),d.sc("ngIf",t.invalid("addr_line_1")&&t.f.addr_line_1.hasError("required")),d.Kb(3),d.sc("ngClass",d.vc(34,x,t.invalid("addr_line_2"))),d.Kb(3),d.sc("ngClass",d.vc(36,x,t.invalid("addr_line_3"))),d.Kb(7),d.sc("ngClass",d.vc(38,x,t.invalid("postcode"))),d.Kb(1),d.sc("ngIf",t.invalid("postcode")&&t.f.postcode.hasError("required")),d.Kb(6),d.sc("ngClass",d.vc(40,x,t.invalid("city"))),d.Kb(1),d.sc("ngIf",t.invalid("city")&&t.f.city.hasError("required")),d.Kb(7),d.sc("items",t.stateList),d.Kb(1),d.sc("ngIf",t.invalid("state_id")&&t.f.state_id.hasError("required")),d.Kb(6),d.sc("items",t.countryList),d.Kb(1),d.sc("ngIf",t.invalid("country_id")&&t.f.country_id.hasError("required"))}}let A=(()=>{class c extends f.a{constructor(c,t,e,i,r){super(),this.fb=c,this.lookupService=t,this.authService=e,this.miningCompanyService=i,this.toastr=r,this.isLoading=!1,this.data={id:""},this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){const c=this.authService.loadUser();this.id=c.mining_company_id,this.load()}createForm(){this.mform=this.fb.group({name:["",[r.r.required]],registration_num:["",[r.r.required]],mining_license_num:["",[r.r.required]],mining_license_expiry_date:[null,[r.r.required]],contact_no:["",[r.r.required]],email:[""],fax_no:[""],addr_line_1:["",[r.r.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[r.r.required]],city:["",[r.r.required]],state_id:[null,[r.r.required]],country_id:[null,[r.r.required]]})}setForm(){const c=this.data;this.mform.patchValue({name:c.name,registration_num:c.registration_num,mining_license_num:c.mining_license_num,mining_license_expiry_date:c.mining_license_expiry_date,contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,country_id:c.country.id}),this.lookupService.listStates(c.country.id).subscribe(t=>{this.stateList=t,this.mform.patchValue({state_id:c.state.id})})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(c=>{this.countryList=c,this.loadDetails()},c=>{this.isLoading=!1})}loadDetails(){g.a.isNull(this.id)||g.a.isUndefined(this.id)?this.isLoading=!1:this.miningCompanyService.edit(this.id).subscribe(c=>{this.data=c,this.setForm()},c=>{},()=>{this.isLoading=!1})}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const c=this.mform.value,t={name:c.name,registration_num:c.registration_num,mining_license_num:c.mining_license_num,mining_license_expiry_date:v.a.toDateStr(c.mining_license_expiry_date),contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,state_id:c.state_id,country_id:c.country_id};this.miningCompanyService.update(this.data.id,t).subscribe(c=>{this.toastr.success("Mining Company successfully updated")})}onChangeCountry(c){this.lookupService.listStates(c.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({state_id:null})})}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(y.a),d.Wb(L.a),d.Wb(S.a),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-company-details"]],features:[d.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Mining License No.","name","mining_license_num","formControlName","mining_license_num",1,"form-control",3,"ngClass"],[1,"col-sm-2","col-12"],[1,"input-group","date"],["type","text","placeholder","License Expiry","name","mining_license_expiry_date","formControlName","mining_license_expiry_date","bsDatepicker","",1,"form-control",3,"bsConfig"],["dp1","bsDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-default",3,"click"],[1,"fas","fa-calendar-alt"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control",3,"ngClass"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control",3,"ngClass"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Company Details"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.Jc(7,T,106,42,"div",6),d.bc()),2&c&&(d.Kb(7),d.sc("ngIf",!t.isLoading))},directives:[i.m,r.t,r.k,r.e,r.a,r.j,r.d,i.k,a.b,a.a,s.a],styles:[""]}),c})();var P=e("C7yL");function F(c,t){1&c&&(d.cc(0,"small",17),d.Lc(1," Actual Weight is required "),d.bc())}function R(c,t){1&c&&(d.cc(0,"small",17),d.Lc(1," Actual Weight is invalid "),d.bc())}const q=function(c){return{"is-invalid":c}};let J=(()=>{class c extends f.a{constructor(c,t){super(),this.fb=c,this.bsModalRef=t,this.createForm()}ngOnInit(){this.onClose=new b.a,this.mform.patchValue({actual_weight:this.actual_weight})}createForm(){this.mform=this.fb.group({actual_weight:["",[r.r.required]]})}onYes(){this.mform.invalid?this.mform.markAllAsTouched():(this.onClose.next({result:!0,actual_weight:this.mform.value.actual_weight}),this.bsModalRef.hide())}onHide(){this.onClose.next({result:!1}),this.bsModalRef.hide()}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(n.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-checkout-modal"]],features:[d.Hb],decls:25,vars:7,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-horizontal",3,"formGroup"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"text-danger"],[1,"col-sm-7"],["type","text","placeholder","Actual Weight (kg)","name","actual_weight","formControlName","actual_weight",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],[1,"col-sm-1","col-form-label"],[1,"modal-footer"],["type","button",1,"btn","btn-success","mr-2","pl-4","pr-4",3,"click"],["type","button",1,"btn","btn-default","pl-4","pr-4",3,"click"],[1,"badge","badge-danger"]],template:function(c,t){1&c&&(d.cc(0,"div",0),d.cc(1,"div",1),d.cc(2,"h4",2),d.Lc(3),d.bc(),d.cc(4,"button",3),d.kc("click",(function(){return t.bsModalRef.hide()})),d.cc(5,"span",4),d.Lc(6,"\xd7"),d.bc(),d.bc(),d.bc(),d.cc(7,"div",5),d.cc(8,"form",6),d.cc(9,"div",7),d.cc(10,"label",8),d.Lc(11,"Actual Weight\xa0"),d.cc(12,"span",9),d.Lc(13,"*"),d.bc(),d.bc(),d.cc(14,"div",10),d.Xb(15,"input",11),d.Jc(16,F,2,0,"small",12),d.Jc(17,R,2,0,"small",12),d.bc(),d.cc(18,"label",13),d.Lc(19,"kg"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(20,"div",14),d.cc(21,"button",15),d.kc("click",(function(){return t.onYes()})),d.Lc(22,"Check Out"),d.bc(),d.cc(23,"button",16),d.kc("click",(function(){return t.onHide()})),d.Lc(24,"Cancel"),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(3),d.Mc(t.title),d.Kb(5),d.sc("formGroup",t.mform),d.Kb(7),d.sc("ngClass",d.vc(5,q,t.invalid("actual_weight"))),d.Kb(1),d.sc("ngIf",t.invalid("actual_weight")&&t.f.actual_weight.hasError("required")),d.Kb(1),d.sc("ngIf",t.invalid("actual_weight")&&t.f.actual_weight.hasError("pattern")))},directives:[r.t,r.k,r.e,r.a,r.j,r.d,i.k,i.m],styles:[""]}),c})();var B=e("tk/3"),W=e("AytR");let $=(()=>{class c{constructor(c){this.http=c,this.baseUrl=W.a.baseUrl}list(c,t,e,i,r){let s=(new B.f).set("_page",t).set("_limit",e).set("status",c);return""!==i&&(""===r&&(r="asc"),s=s.append("sort",`${i}:${r}`)),this.http.get(this.baseUrl+"/api/delivery-orders",{params:s,observe:"response"})}search(c,t,e,i,r,s){let n=(new B.f).set("_page",t).set("_limit",e).set("status",c);return""!==i&&(""===r&&(r="asc"),n=n.append("sort",`${i}:${r}`)),this.http.post(this.baseUrl+"/api/delivery-orders",{keyword:s},{params:n,observe:"response"})}updateTime(c){return this.http.post(`${this.baseUrl}/api/delivery-order/${c.id}/timestamp`,c)}receive(c){return this.http.post(`${this.baseUrl}/api/delivery-order/${c}/received`,{})}}return c.\u0275fac=function(t){return new(t||c)(d.gc(B.b))},c.\u0275prov=d.Sb({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();var G=e("QLLi"),U=e("OpGx"),V=e("C4D8");function Z(c,t){1&c&&(d.cc(0,"div",22),d.cc(1,"h4"),d.Lc(2,"No records found"),d.bc(),d.bc())}function H(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(" ",c.purchase_order_detail.weight," ")}}function j(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(" ",c.actual_weight," ")}}function Q(c,t){if(1&c){const c=d.dc();d.cc(0,"button",31),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onCheckIn(t)})),d.Lc(1,"Check In"),d.bc()}}function z(c,t){if(1&c){const c=d.dc();d.cc(0,"button",31),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onCheckOut(t)})),d.Lc(1,"Check Out"),d.bc()}}function Y(c,t){if(1&c){const c=d.dc();d.cc(0,"button",31),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onReceived(t)})),d.Lc(1,"Received"),d.bc()}}function cc(c,t){if(1&c){const c=d.dc();d.cc(0,"button",32),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onPermit(t)})),d.Lc(1,"Permit"),d.bc()}}function tc(c,t){if(1&c&&(d.cc(0,"tr"),d.cc(1,"td"),d.Lc(2),d.bc(),d.cc(3,"td"),d.Lc(4),d.nc(5,"date"),d.bc(),d.cc(6,"td"),d.Lc(7),d.bc(),d.cc(8,"td"),d.Lc(9),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.Lc(13),d.bc(),d.cc(14,"td"),d.Jc(15,H,2,1,"ng-container",27),d.Jc(16,j,2,1,"ng-container",27),d.bc(),d.cc(17,"td"),d.Lc(18),d.bc(),d.cc(19,"td"),d.Lc(20),d.nc(21,"date"),d.bc(),d.cc(22,"td"),d.Lc(23),d.nc(24,"date"),d.bc(),d.cc(25,"td",28),d.Jc(26,Q,2,0,"button",29),d.Jc(27,z,2,0,"button",29),d.Jc(28,Y,2,0,"button",29),d.Jc(29,cc,2,0,"button",30),d.bc(),d.bc()),2&c){const c=t.$implicit,e=d.mc(2);d.Kb(2),d.Mc(c.do_num),d.Kb(2),d.Mc(d.pc(5,15,c.created_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Mc(c.purchase_order_detail.material.name),d.Kb(2),d.Mc(c.purchase_order_detail.truck.registration_num),d.Kb(2),d.Mc(c.purchase_order_detail.driver.name),d.Kb(2),d.Mc(c.purchase_order_detail.driver.id_num),d.Kb(2),d.sc("ngIf",!c.checkout_date),d.Kb(1),d.sc("ngIf",c.checkout_date),d.Kb(2),d.Mc(e.getDOStatus(c)),d.Kb(2),d.Mc(d.pc(21,18,c.checkin_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Mc(d.pc(24,21,c.checkout_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.sc("ngIf",!c.checkin_date),d.Kb(1),d.sc("ngIf",!c.checkout_date&&c.checkin_date),d.Kb(1),d.sc("ngIf",c.status===e.DOStatus.DELIVERING&&e.isRoleMiningHQ),d.Kb(1),d.sc("ngIf",null!==c.permit)}}function ec(c,t){if(1&c){const c=d.dc();d.cc(0,"div",23),d.cc(1,"table",24),d.cc(2,"thead"),d.cc(3,"tr"),d.cc(4,"th"),d.cc(5,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(6,"th"),d.cc(7,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(8,"th"),d.cc(9,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(10,"th"),d.cc(11,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(12,"th"),d.cc(13,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(14,"th"),d.cc(15,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(16,"th"),d.cc(17,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(18,"th"),d.Lc(19,"Status"),d.bc(),d.cc(20,"th"),d.cc(21,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(22,"th"),d.cc(23,"app-sort-column",25),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.Xb(24,"th"),d.bc(),d.bc(),d.cc(25,"tbody"),d.Jc(26,tc,30,24,"tr",26),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(5),d.sc("name","DO No.")("sort","do_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Date")("sort","created_date")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Material")("sort","purchase_order_detail__material__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Truck")("sort","purchase_order_detail__truck__registration_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Driver")("sort","purchase_order_detail__driver__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","I/C No.")("sort","purchase_order_detail__driver__id_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Weight (kg)")("sort","purchase_order_detail__weight")("dir",c.sortDir)("current",c.sort),d.Kb(4),d.sc("name","Check In Time")("sort","checkin_date")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Check Out Time")("sort","checkout_date")("dir",c.sortDir)("current",c.sort),d.Kb(3),d.sc("ngForOf",c.list)}}function ic(c,t){if(1&c){const c=d.dc();d.cc(0,"div",33),d.cc(1,"div",34),d.cc(2,"pagination",35),d.kc("ngModelChange",(function(t){return d.Dc(c),d.mc().page=t}))("pageChanged",(function(t){return d.Dc(c),d.mc().pageChanged(t)})),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.sc("totalItems",c.totalCount)("itemsPerPage",c.pageSize)("maxSize",c.MAX_PAGE_NUMBERS)("ngModel",c.page)}}let rc=(()=>{class c{constructor(c,t,e,i,r,s,n){this.route=c,this.router=t,this.authService=e,this.deliveryOrderService=i,this.msService=r,this.toastr=s,this.modalService=n,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=P.a.PAGE_SIZE,this.page=1,this.search="",this.do_status="0",this.isRoleMiningHQ=!1,this.sort="created_date",this.sortDir="desc",this.sx=0,this.sy=0,this.uiState="mining-company.delivery-order-listing",this.isEmpty=v.a.isEmpty,this.PAGE_SIZE=P.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=P.a.MAX_PAGE_NUMBERS,this.DOStatus=P.a.DOStatus}ngOnInit(){const c=this.authService.loadUser();this.mining_company_id=c.mining_company_id,this.isRoleMiningHQ=this.authService.hasRole(P.a.ROLE.MINING_HQ),this.isLoading=!0,this.subs=this.msService.get().subscribe(c=>{if(c.name===this.uiState){const t=c.data;this.page=t.page,this.sort=t.sort,this.sortDir=t.dir,this.search=t.search,this.do_status=t.do_status,this.sx=t.sx,this.sy=t.sy}}),this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.deliveryOrderService.list(this.do_status,this.page,P.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(P.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(c){this.search=c,this.isLoading=!0,this.deliveryOrderService.search(this.do_status,this.page,P.a.PAGE_SIZE,this.sort,this.sortDir,c).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(P.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})}pageChanged(c){this.page=c.page,this.load()}onSortBy(c){""===c.sort&&"asc"===c.dir?(this.sort="created_date",this.sortDir="desc"):(this.sort=c.sort,this.sortDir=c.dir),this.load()}onDOStatusChange(){this.load()}goto(c){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,do_status:this.do_status,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/mining-company/delivery-order/"+c])}onCheckIn(c){this.isLoading=!0,this.deliveryOrderService.updateTime({id:c.id,checkin:1}).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully checked in`),this.load()},c=>{},()=>{this.isLoading=!1})}onCheckOut(c){this.bsModalRef=this.modalService.show(J,{initialState:{title:"Check Out DO",actual_weight:c.actual_weight}}),this.bsModalRef.content.onClose.subscribe(t=>{!0===t.result&&(this.isLoading=!0,this.deliveryOrderService.updateTime({id:c.id,checkin:0,actual_weight:t.actual_weight}).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully checked out`),this.load()},c=>{},()=>{this.isLoading=!1}))})}onPermit(c){this.router.navigate(["/ams/mining-company/permit/"+c.permit.id])}onReceived(c){this.isLoading=!0,this.deliveryOrderService.receive(c.id).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully received`),this.load()},c=>{},()=>{this.isLoading=!1})}getDOStatus(c){return c.status===P.a.DOStatus.NEW?"NEW":c.status===P.a.DOStatus.IN_PROGRESS?"IN PROGRESS":c.status===P.a.DOStatus.DELIVERING?"DELIVERING":c.status===P.a.DOStatus.DELIVERED?"DELIVERED":"NEW"}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(p.a),d.Wb(p.g),d.Wb(L.a),d.Wb($),d.Wb(G.a),d.Wb(C.b),d.Wb(n.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-delivery-order-listing"]],decls:29,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-2","col-12","p-1"],["name","do_status",1,"form-control",3,"ngModel","ngModelChange","change"],["value","all"],["value","0"],["value","1"],["value","2"],["value","3"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-nowrap"],["class","btn btn-sm btn-primary mr-2",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Delivery Order Listing"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"div",6),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"app-search-input",10),d.kc("onSearch",(function(c){return t.onSearch(c)})),d.bc(),d.bc(),d.cc(13,"div",11),d.cc(14,"select",12),d.kc("ngModelChange",(function(c){return t.do_status=c}))("change",(function(){return t.onDOStatusChange()})),d.cc(15,"option",13),d.Lc(16,"ALL"),d.bc(),d.cc(17,"option",14),d.Lc(18,"NEW"),d.bc(),d.cc(19,"option",15),d.Lc(20,"IN PROGRESS"),d.bc(),d.cc(21,"option",16),d.Lc(22,"DELIVERING"),d.bc(),d.cc(23,"option",17),d.Lc(24,"DELIVERED"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(25,"div",18),d.Jc(26,Z,3,0,"div",19),d.Jc(27,ec,27,37,"div",20),d.bc(),d.Jc(28,ic,3,4,"div",21),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(12),d.sc("search",t.search),d.Kb(2),d.sc("ngModel",t.do_status),d.Kb(12),d.sc("ngIf",t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",!t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",t.totalCount&&!t.isLoading))},directives:[U.a,r.q,r.j,r.l,r.m,r.s,i.m,V.a,i.l,o.a],pipes:[i.e],styles:[""]}),c})();var sc=e("cpHE");function nc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",c.data.purchase_order.issue_to.addr_line_2,"")}}function ac(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(c.data.purchase_order.issue_to.addr_line_3)}}function oc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",c.data.purchase_order_detail.recv_addr_line_2,"")}}function dc(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(c.data.purchase_order_detail.recv_addr_line_3)}}const lc=function(c){return["/permit",c,"print"]};function bc(c,t){if(1&c&&(d.cc(0,"div",1),d.cc(1,"div",7),d.cc(2,"div",8),d.cc(3,"div",9),d.cc(4,"div",7),d.cc(5,"div",8),d.cc(6,"h4"),d.cc(7,"small",10),d.Lc(8),d.nc(9,"date"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(10,"div",11),d.cc(11,"div",12),d.Lc(12," Mining License Holder "),d.cc(13,"address"),d.cc(14,"strong"),d.Lc(15),d.bc(),d.Xb(16,"br"),d.Lc(17),d.Xb(18,"br"),d.Lc(19),d.Xb(20,"br"),d.Lc(21),d.nc(22,"date"),d.Xb(23,"br"),d.Lc(24),d.Jc(25,nc,2,1,"ng-container",13),d.Jc(26,ac,4,1,"ng-container",13),d.Xb(27,"br"),d.Lc(28),d.Xb(29,"br"),d.Lc(30),d.Xb(31,"br"),d.Lc(32),d.Xb(33,"br"),d.Lc(34),d.Xb(35,"br"),d.Lc(36),d.bc(),d.bc(),d.cc(37,"div",12),d.Lc(38," Driver & Truck Details "),d.cc(39,"address"),d.cc(40,"strong"),d.Lc(41),d.bc(),d.Xb(42,"br"),d.Lc(43),d.Xb(44,"br"),d.Lc(45),d.Xb(46,"br"),d.Lc(47),d.Xb(48,"br"),d.Lc(49),d.nc(50,"number"),d.bc(),d.bc(),d.cc(51,"div",12),d.Lc(52," Destination "),d.cc(53,"address"),d.cc(54,"strong"),d.Lc(55),d.bc(),d.Xb(56,"br"),d.Lc(57),d.Jc(58,oc,2,1,"ng-container",13),d.Jc(59,dc,4,1,"ng-container",13),d.Xb(60,"br"),d.Lc(61),d.Xb(62,"br"),d.Lc(63),d.bc(),d.bc(),d.bc(),d.cc(64,"div",14),d.cc(65,"div",8),d.cc(66,"a",15),d.Xb(67,"i",16),d.Lc(68," Print"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()),2&c){const c=d.mc();d.Kb(8),d.Nc("Date: ",d.pc(9,31,c.data.created_date,"d MMM yyyy"),""),d.Kb(7),d.Mc(c.data.purchase_order.issue_to.name),d.Kb(2),d.Nc("",c.data.purchase_order.issue_to.registration_num," "),d.Kb(2),d.Nc("Mineral License No. ",c.data.purchase_order.issue_to.mining_license_num," "),d.Kb(2),d.Nc("License Expiry: ",d.pc(22,34,c.data.purchase_order.issue_to.mining_license_expiry_date,"d MMM yyyy")," "),d.Kb(3),d.Mc(c.data.purchase_order.issue_to.addr_line_1),d.Kb(1),d.sc("ngIf",c.data.purchase_order.issue_to.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.purchase_order.issue_to.addr_line_3),d.Kb(2),d.Oc("",c.data.purchase_order.issue_to.postcode," ",c.data.purchase_order.issue_to.city," "),d.Kb(2),d.Oc("",c.data.purchase_order.issue_to.state.name,", ",c.data.purchase_order.issue_to.country.name," "),d.Kb(2),d.Nc("Phone: ",c.data.purchase_order.issue_to.contact_no," "),d.Kb(2),d.Nc("Email: ",c.data.purchase_order.issue_to.email," "),d.Kb(2),d.Nc("Fax: ",c.data.purchase_order.issue_to.fax_no," "),d.Kb(5),d.Mc(c.data.purchase_order_detail.driver.name),d.Kb(2),d.Nc("I/C No.: ",c.data.purchase_order_detail.driver.id_num," "),d.Kb(2),d.Nc("Truck Reg. No.: ",c.data.purchase_order_detail.truck.registration_num," "),d.Kb(2),d.Pc("Material: ",c.data.purchase_order_detail.material.name," ",c.data.purchase_order_detail.material.material_type," ",c.data.purchase_order_detail.material.grade," "),d.Kb(2),d.Nc("Weight: ",d.oc(50,37,c.data.delivery_order.actual_weight)," kg "),d.Kb(6),d.Mc(c.data.purchase_order_detail.recv_name),d.Kb(2),d.Mc(c.data.purchase_order_detail.recv_addr_line_1),d.Kb(1),d.sc("ngIf",c.data.purchase_order_detail.recv_addr_line_2),d.Kb(1),d.sc("ngIf",c.data.purchase_order_detail.recv_addr_line_3),d.Kb(2),d.Oc("",c.data.purchase_order_detail.recv_postcode," ",c.data.purchase_order_detail.recv_city," "),d.Kb(2),d.Oc("",c.data.purchase_order_detail.recv_state.name,", ",c.data.purchase_order_detail.recv_country.name," "),d.Kb(3),d.sc("routerLink",d.vc(39,lc,c.id))}}let uc=(()=>{class c{constructor(c,t,e){this.route=c,this.router=t,this.permitService=e,this.isLoading=!1,this.data={id:""}}ngOnInit(){this.route.paramMap.subscribe(c=>{this.id=c.get("id"),this.load()})}load(){g.a.isNull(this.id)||g.a.isUndefined(this.id)?this.isLoading=!1:(this.isLoading=!0,this.permitService.detail(this.id).subscribe(c=>{this.data=c},c=>{},()=>{this.isLoading=!1}))}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(p.a),d.Wb(p.g),d.Wb(sc.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-permit-detail"]],decls:9,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-10"],[1,"col-sm-2"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"invoice","p-3","mb-3"],[1,"float-right"],[1,"row","invoice-info"],[1,"col-sm-4","invoice-col"],[4,"ngIf"],[1,"row","no-print"],["target","_blank",1,"btn","btn-default",3,"routerLink"],[1,"fas","fa-print"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1"),d.Lc(5,"Permit"),d.bc(),d.bc(),d.Xb(6,"div",4),d.bc(),d.bc(),d.bc(),d.cc(7,"section",5),d.Jc(8,bc,69,41,"div",6),d.bc()),2&c&&(d.Kb(8),d.sc("ngIf",!t.isLoading))},directives:[i.m,p.h],pipes:[i.e,i.f],styles:[""]}),c})();var mc=e("LNgY"),hc=e("VuLe"),pc=e("eUtn"),_c=e("bOQg"),gc=e("fdx9"),vc=e("wWB1"),fc=e("5Pgx");let yc=(()=>{class c{constructor(c){this.http=c,this.baseUrl=W.a.baseUrl}list(c,t,e,i){let r=(new B.f).set("_page",c).set("_limit",t);return""!==e&&(""===i&&(i="asc"),r=r.append("sort",`${e}:${i}`)),this.http.get(this.baseUrl+"/api/purchase-orders",{params:r,observe:"response"})}search(c,t,e,i,r){let s=(new B.f).set("_page",c).set("_limit",t);return""!==e&&(""===i&&(i="asc"),s=s.append("sort",`${e}:${i}`)),this.http.post(this.baseUrl+"/api/purchase-orders",{keyword:r},{params:s,observe:"response"})}create(c){return this.http.post(this.baseUrl+"/api/purchase-order",c)}detail(c){return this.http.get(`${this.baseUrl}/api/purchase-order/${c}`)}}return c.\u0275fac=function(t){return new(t||c)(d.gc(B.b))},c.\u0275prov=d.Sb({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();function Lc(c,t){1&c&&(d.cc(0,"div",18),d.cc(1,"h4"),d.Lc(2,"No records found"),d.bc(),d.bc())}function Sc(c,t){if(1&c){const c=d.dc();d.cc(0,"tr"),d.cc(1,"td"),d.Lc(2),d.bc(),d.cc(3,"td"),d.Lc(4),d.bc(),d.cc(5,"td"),d.Lc(6),d.bc(),d.cc(7,"td"),d.Lc(8),d.nc(9,"date"),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.cc(13,"button",23),d.kc("click",(function(){d.Dc(c);const e=t.$implicit;return d.mc(2).onView(e)})),d.Xb(14,"i",24),d.bc(),d.bc(),d.bc()}if(2&c){const c=t.$implicit,e=d.mc(2);d.Kb(2),d.Mc(c.po_num),d.Kb(2),d.Mc(c.buyer.name),d.Kb(2),d.Mc(c.issue_to.name),d.Kb(2),d.Mc(d.pc(9,5,c.issued_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Mc(e.getPOStatus(c))}}function Cc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",19),d.cc(1,"table",20),d.cc(2,"thead"),d.cc(3,"tr"),d.cc(4,"th"),d.cc(5,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(6,"th"),d.cc(7,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(8,"th"),d.cc(9,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(10,"th"),d.cc(11,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(12,"th"),d.Lc(13,"Status"),d.bc(),d.Xb(14,"th"),d.bc(),d.bc(),d.cc(15,"tbody"),d.Jc(16,Sc,15,8,"tr",22),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(5),d.sc("name","PO No.")("sort","po_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Buyer")("sort","buyer__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Issue To")("sort","issue_to__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Issued Date")("sort","issued_date")("dir",c.sortDir)("current",c.sort),d.Kb(5),d.sc("ngForOf",c.list)}}function kc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",25),d.cc(1,"div",26),d.cc(2,"pagination",27),d.kc("ngModelChange",(function(t){return d.Dc(c),d.mc().page=t}))("pageChanged",(function(t){return d.Dc(c),d.mc().pageChanged(t)})),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.sc("totalItems",c.totalCount)("itemsPerPage",c.pageSize)("maxSize",c.MAX_PAGE_NUMBERS)("ngModel",c.page)}}let Kc=(()=>{class c{constructor(c,t,e,i){this.route=c,this.router=t,this.purchaseOrderService=e,this.msService=i,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=P.a.PAGE_SIZE,this.page=1,this.search="",this.sort="issued_date",this.sortDir="desc",this.sx=0,this.sy=0,this.uiState="mining-company.purchase-order-listing",this.isEmpty=v.a.isEmpty,this.PAGE_SIZE=P.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=P.a.MAX_PAGE_NUMBERS}ngOnInit(){this.subs=this.msService.get().subscribe(c=>{if(c.name===this.uiState){const t=c.data;this.page=t.page,this.sort=t.sort,this.sortDir=t.dir,this.search=t.search,this.sx=t.sx,this.sy=t.sy}}),this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.purchaseOrderService.list(this.page,P.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(P.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(c){this.search=c,this.isLoading=!0,this.purchaseOrderService.search(this.page,P.a.PAGE_SIZE,this.sort,this.sortDir,c).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(P.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})}pageChanged(c){this.page=c.page,this.load()}onSortBy(c){""===c.sort&&"asc"===c.dir?(this.sort="issued_date",this.sortDir="desc"):(this.sort=c.sort,this.sortDir=c.dir),this.load()}goto(c){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/mining-company/purchase-order/"+c])}onView(c){this.goto("detail/"+c.id)}getPOStatus(c){return c.status===P.a.POStatus.IN_PROGRESS?"IN PROGRESS":c.status===P.a.POStatus.COMPLETED?"COMPLETED":c.status===P.a.POStatus.CANCELLED?"CANCELLED":c.status===P.a.POStatus.REJECTED?"REJECTED":"PENDING"}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(p.a),d.Wb(p.g),d.Wb(yc),d.Wb(G.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary","mr-2",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-eye"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Purchase Order Listing"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"div",6),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"app-search-input",10),d.kc("onSearch",(function(c){return t.onSearch(c)})),d.bc(),d.bc(),d.cc(13,"div",11),d.cc(14,"button",12),d.kc("click",(function(){return t.goto("create")})),d.Xb(15,"i",13),d.Lc(16," Issue PO"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(17,"div",14),d.Jc(18,Lc,3,0,"div",15),d.Jc(19,Cc,17,17,"div",16),d.bc(),d.Jc(20,kc,3,4,"div",17),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(12),d.sc("search",t.search),d.Kb(6),d.sc("ngIf",t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",!t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",t.totalCount&&!t.isLoading))},directives:[U.a,i.m,V.a,i.l,o.a,r.j,r.l],pipes:[i.e],styles:[""]}),c})();var Ec=e("cp0P"),Ic=e("mMBO");function Dc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Buyer is required "),d.bc())}function Nc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Material is required "),d.bc())}function wc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Truck is required "),d.bc())}function Mc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Driver is required "),d.bc())}function Oc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Weight is required "),d.bc())}function xc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Weight is invalid "),d.bc())}function Xc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Name is required "),d.bc())}function Tc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Address is required "),d.bc())}function Ac(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Postcode is required "),d.bc())}function Pc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Postcode is required "),d.bc())}function Fc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," State is required "),d.bc())}function Rc(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Country is required "),d.bc())}const qc=function(c){return{"is-invalid":c}};function Jc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",28),d.cc(1,"div",17),d.cc(2,"h3",18),d.Lc(3),d.bc(),d.cc(4,"div",29),d.cc(5,"button",30),d.kc("click",(function(){d.Dc(c);const e=t.$implicit;return d.mc().onRemoveMaterial(e)})),d.Xb(6,"i",31),d.bc(),d.bc(),d.bc(),d.cc(7,"div",32),d.cc(8,"div",9),d.cc(9,"label",33),d.Lc(10,"Material\xa0"),d.cc(11,"span",11),d.Lc(12,"*"),d.bc(),d.bc(),d.cc(13,"div",34),d.Xb(14,"ng-select",35),d.Jc(15,Nc,2,0,"small",14),d.bc(),d.cc(16,"label",33),d.Lc(17,"Truck\xa0"),d.cc(18,"span",11),d.Lc(19,"*"),d.bc(),d.bc(),d.cc(20,"div",34),d.Xb(21,"ng-select",36),d.Jc(22,wc,2,0,"small",14),d.bc(),d.cc(23,"label",33),d.Lc(24,"Driver\xa0"),d.cc(25,"span",11),d.Lc(26,"*"),d.bc(),d.bc(),d.cc(27,"div",34),d.Xb(28,"ng-select",37),d.Jc(29,Mc,2,0,"small",14),d.bc(),d.bc(),d.cc(30,"div",9),d.cc(31,"label",33),d.Lc(32,"Weight\xa0"),d.cc(33,"span",11),d.Lc(34,"*"),d.bc(),d.bc(),d.cc(35,"div",34),d.Xb(36,"input",38),d.Jc(37,Oc,2,0,"small",14),d.Jc(38,xc,2,0,"small",14),d.bc(),d.cc(39,"label",33),d.Lc(40,"kg"),d.bc(),d.bc(),d.cc(41,"div",15),d.cc(42,"div",16),d.cc(43,"h4",18),d.Lc(44,"Receiver Details"),d.bc(),d.Xb(45,"br"),d.Xb(46,"hr"),d.bc(),d.bc(),d.cc(47,"div",9),d.cc(48,"label",33),d.Lc(49,"Name\xa0"),d.cc(50,"span",11),d.Lc(51,"*"),d.bc(),d.bc(),d.cc(52,"div",39),d.Xb(53,"input",40),d.Jc(54,Xc,2,0,"small",14),d.bc(),d.bc(),d.cc(55,"div",9),d.cc(56,"label",33),d.Lc(57,"Address\xa0"),d.cc(58,"span",11),d.Lc(59,"*"),d.bc(),d.bc(),d.cc(60,"div",39),d.Xb(61,"input",41),d.Jc(62,Tc,2,0,"small",14),d.bc(),d.bc(),d.cc(63,"div",9),d.cc(64,"div",42),d.Xb(65,"input",43),d.bc(),d.bc(),d.cc(66,"div",9),d.cc(67,"div",42),d.Xb(68,"input",44),d.bc(),d.bc(),d.cc(69,"div",9),d.cc(70,"label",33),d.Lc(71,"Postcode\xa0"),d.cc(72,"span",11),d.Lc(73,"*"),d.bc(),d.bc(),d.cc(74,"div",45),d.Xb(75,"input",46),d.Jc(76,Ac,2,0,"small",14),d.bc(),d.cc(77,"label",33),d.Lc(78,"City\xa0"),d.cc(79,"span",11),d.Lc(80,"*"),d.bc(),d.bc(),d.cc(81,"div",47),d.Xb(82,"input",48),d.Jc(83,Pc,2,0,"small",14),d.bc(),d.bc(),d.cc(84,"div",9),d.cc(85,"label",33),d.Lc(86,"State\xa0"),d.cc(87,"span",11),d.Lc(88,"*"),d.bc(),d.bc(),d.cc(89,"div",45),d.Xb(90,"ng-select",49),d.Jc(91,Fc,2,0,"small",14),d.bc(),d.cc(92,"label",33),d.Lc(93,"Country\xa0"),d.cc(94,"span",11),d.Lc(95,"*"),d.bc(),d.bc(),d.cc(96,"div",47),d.cc(97,"ng-select",50),d.kc("change",(function(e){d.Dc(c);const i=t.$implicit;return d.mc().onChangeReceiverCountry(e,i)})),d.bc(),d.Jc(98,Rc,2,0,"small",14),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=t.$implicit,e=t.index,i=d.mc();d.Kb(3),d.Nc("Item #",e+1,""),d.Kb(4),d.sc("formGroupName",e),d.Kb(7),d.sc("items",i.materialList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"truck_id")&&i.hasErrorFg(c,"truck_id","required")),d.Kb(6),d.sc("items",i.truckList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"truck_id")&&i.hasErrorFg(c,"truck_id","required")),d.Kb(6),d.sc("items",i.driverList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"driver_id")&&i.hasErrorFg(c,"driver_id","required")),d.Kb(7),d.sc("ngClass",d.vc(23,qc,i.invalidFg(c,"weight"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"weight")&&i.hasErrorFg(c,"weight","required")),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"weight")&&i.hasErrorFg(c,"weight","pattern")),d.Kb(15),d.sc("ngClass",d.vc(25,qc,i.invalidFg(c,"recv_name"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_name")&&i.hasErrorFg(c,"recv_name","required")),d.Kb(7),d.sc("ngClass",d.vc(27,qc,i.invalidFg(c,"recv_addr_line_1"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_addr_line_1")&&i.hasErrorFg(c,"recv_addr_line_1","required")),d.Kb(13),d.sc("ngClass",d.vc(29,qc,i.invalidFg(c,"recv_postcode"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_postcode")&&i.hasErrorFg(c,"recv_postcode","required")),d.Kb(6),d.sc("ngClass",d.vc(31,qc,i.invalidFg(c,"recv_city"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_city")&&i.hasErrorFg(c,"recv_city","required")),d.Kb(7),d.sc("items",i.getStateList(c)),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_state_id")&&i.hasErrorFg(c,"recv_state_id","required")),d.Kb(6),d.sc("items",i.countryList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_country_id")&&i.hasErrorFg(c,"recv_country_id","required"))}}function Bc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",d.oc(2,1,c.data.buyer.addr_line_2),"")}}function Wc(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.nc(4,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(d.oc(4,1,c.data.buyer.addr_line_3))}}function $c(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",d.oc(2,1,c.data.issue_to.addr_line_2),"")}}function Gc(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.nc(4,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(d.oc(4,1,c.data.issue_to.addr_line_3))}}function Uc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(", ",d.oc(2,1,c.recv_addr_line_2),"")}}function Vc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(", ",d.oc(2,1,c.recv_addr_line_3),"")}}function Zc(c,t){if(1&c&&(d.ac(0),d.cc(1,"tr"),d.cc(2,"td"),d.Lc(3),d.bc(),d.cc(4,"td"),d.Lc(5),d.bc(),d.cc(6,"td"),d.Lc(7),d.bc(),d.cc(8,"td"),d.Lc(9),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.Lc(13),d.bc(),d.cc(14,"td"),d.Lc(15),d.bc(),d.bc(),d.cc(16,"tr"),d.cc(17,"td",24),d.Lc(18),d.Xb(19,"br"),d.Lc(20),d.nc(21,"uppercase"),d.Jc(22,Uc,3,3,"ng-container",13),d.Jc(23,Vc,3,3,"ng-container",13),d.Lc(24),d.nc(25,"uppercase"),d.nc(26,"uppercase"),d.nc(27,"uppercase"),d.bc(),d.bc(),d.Zb()),2&c){const c=t.$implicit,e=t.index;d.Kb(3),d.Mc(e+1),d.Kb(2),d.Pc("",c.material.name," ",c.material.material_type," ",c.material.grade,""),d.Kb(2),d.Mc(c.truck.registration_num),d.Kb(2),d.Mc(c.driver.name),d.Kb(2),d.Mc(c.driver.id_num),d.Kb(2),d.Mc(c.weight),d.Kb(2),d.Mc(c.do_num),d.Kb(3),d.Nc(" Destination: ",c.recv_name,""),d.Kb(2),d.Nc(" ",d.oc(21,17,c.recv_addr_line_1),""),d.Kb(2),d.sc("ngIf",c.recv_addr_line_2),d.Kb(1),d.sc("ngIf",c.recv_addr_line_3),d.Kb(1),d.Qc(" ",c.recv_postcode," ",d.oc(25,19,c.recv_city)," ",d.oc(26,21,c.recv_state.name),", ",d.oc(27,23,c.recv_country.name)," ")}}const Hc=function(c){return["/purchase-order",c,"print"]};function jc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"div",7),d.cc(2,"div",8),d.cc(3,"div",9),d.cc(4,"div",7),d.cc(5,"div",8),d.cc(6,"h4"),d.cc(7,"small",10),d.Lc(8),d.nc(9,"date"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(10,"div",11),d.cc(11,"div",12),d.Lc(12," From "),d.cc(13,"address"),d.cc(14,"strong"),d.Lc(15),d.bc(),d.Xb(16,"br"),d.Lc(17),d.Xb(18,"br"),d.Lc(19),d.nc(20,"uppercase"),d.Jc(21,Bc,3,3,"ng-container",13),d.Jc(22,Wc,5,3,"ng-container",13),d.Xb(23,"br"),d.Lc(24),d.nc(25,"uppercase"),d.Xb(26,"br"),d.Lc(27),d.nc(28,"uppercase"),d.nc(29,"uppercase"),d.Xb(30,"br"),d.Lc(31),d.Xb(32,"br"),d.Lc(33),d.bc(),d.bc(),d.cc(34,"div",12),d.Lc(35," To "),d.cc(36,"address"),d.cc(37,"strong"),d.Lc(38),d.bc(),d.Xb(39,"br"),d.Lc(40),d.Xb(41,"br"),d.Lc(42),d.nc(43,"uppercase"),d.Jc(44,$c,3,3,"ng-container",13),d.Jc(45,Gc,5,3,"ng-container",13),d.Xb(46,"br"),d.Lc(47),d.nc(48,"uppercase"),d.Xb(49,"br"),d.Lc(50),d.nc(51,"uppercase"),d.nc(52,"uppercase"),d.Xb(53,"br"),d.Lc(54),d.Xb(55,"br"),d.Lc(56),d.bc(),d.bc(),d.cc(57,"div",14),d.cc(58,"b"),d.Lc(59),d.bc(),d.Xb(60,"br"),d.bc(),d.bc(),d.cc(61,"div",7),d.cc(62,"div",15),d.cc(63,"table",16),d.cc(64,"thead"),d.cc(65,"tr"),d.cc(66,"th"),d.Lc(67,"#"),d.bc(),d.cc(68,"th"),d.Lc(69,"Material"),d.bc(),d.cc(70,"th"),d.Lc(71,"Truck"),d.bc(),d.cc(72,"th"),d.Lc(73,"Driver"),d.bc(),d.cc(74,"th"),d.Lc(75,"I/C No."),d.bc(),d.cc(76,"th"),d.Lc(77,"Weight (kg)"),d.bc(),d.cc(78,"th"),d.Lc(79,"DO No."),d.bc(),d.bc(),d.bc(),d.cc(80,"tbody"),d.Jc(81,Zc,28,25,"ng-container",17),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(82,"div",18),d.cc(83,"div",8),d.cc(84,"button",19),d.kc("click",(function(){return d.Dc(c),d.mc().onBack()})),d.Xb(85,"i",20),d.Lc(86," Back"),d.bc(),d.cc(87,"button",21),d.kc("cbOnSuccess",(function(t){return d.Dc(c),d.mc().onCopySuccess(t)})),d.Lc(88,"Copy"),d.bc(),d.cc(89,"a",22),d.Xb(90,"i",23),d.Lc(91," Print"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(8),d.Nc("Date: ",d.pc(9,27,c.data.issued_date,"d MMM yyyy"),""),d.Kb(7),d.Mc(c.data.buyer.name),d.Kb(2),d.Nc("",c.data.buyer.registration_num," "),d.Kb(2),d.Mc(d.oc(20,30,c.data.buyer.addr_line_1)),d.Kb(2),d.sc("ngIf",c.data.buyer.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.buyer.addr_line_3),d.Kb(2),d.Oc("",c.data.buyer.postcode," ",d.oc(25,32,c.data.buyer.city)," "),d.Kb(3),d.Oc("",d.oc(28,34,c.data.buyer.state.name),", ",d.oc(29,36,c.data.buyer.country.name)," "),d.Kb(4),d.Nc("Phone: ",c.data.buyer.contact_no," "),d.Kb(2),d.Nc("Email: ",c.data.buyer.email," "),d.Kb(5),d.Mc(c.data.issue_to.name),d.Kb(2),d.Nc("",c.data.issue_to.registration_num," "),d.Kb(2),d.Mc(d.oc(43,38,c.data.issue_to.addr_line_1)),d.Kb(2),d.sc("ngIf",c.data.issue_to.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.issue_to.addr_line_3),d.Kb(2),d.Oc("",c.data.issue_to.postcode," ",d.oc(48,40,c.data.issue_to.city)," "),d.Kb(3),d.Oc("",d.oc(51,42,c.data.issue_to.state.name),", ",d.oc(52,44,c.data.issue_to.country.name)," "),d.Kb(4),d.Nc("Phone: ",c.data.issue_to.contact_no," "),d.Kb(2),d.Nc("Email: ",c.data.issue_to.email," "),d.Kb(3),d.Nc("Purchase Order #",c.data.po_num,""),d.Kb(22),d.sc("ngForOf",c.data.details),d.Kb(6),d.sc("cbContent",c.getPODetails()),d.Kb(2),d.sc("routerLink",d.vc(46,Hc,c.id))}}const Qc=[{path:"company-details",component:A},{path:"delivery-order",children:[{path:"list",component:rc}]},{path:"permit/:id",component:uc},{path:"purchase-order",children:[{path:"list",component:Kc},{path:"create",component:(()=>{class c extends f.a{constructor(c,t,e,i,r,s,n){super(),this.fb=c,this.route=t,this.router=e,this.authService=i,this.lookupService=r,this.purchaseOrderService=s,this.toastr=n,this.isLoading=!1,this.buyerList=[],this.materialList=[],this.truckList=[],this.driverList=[],this.countryList=[],this.createForm()}ngOnInit(){const c=this.authService.loadUser();this.mining_company_id=c.mining_company_id,this.load()}createForm(){this.mform=this.fb.group({buyer_id:[null,[r.r.required]],materialForms:this.fb.array([])})}createMaterialForm(){return this.fb.group({id:[g.a.uniqueId()],material_id:[null],weight:["0",[r.r.required,r.r.pattern(P.a.VALIDATE.AMOUNT)]],truck_id:[null,[r.r.required]],driver_id:[null,[r.r.required]],recv_name:["",[r.r.required]],recv_addr_line_1:["",[r.r.required]],recv_addr_line_2:[""],recv_addr_line_3:[""],recv_postcode:["",[r.r.required]],recv_city:["",[r.r.required]],recv_state_id:[null,[r.r.required]],recv_country_id:[null,[r.r.required]],stateList:[[]]})}load(){this.isLoading=!0;let c=this.lookupService.listBuyer(),t=this.lookupService.listMaterial(),e=this.lookupService.listCountry();Object(Ec.a)([c,t,e]).subscribe(c=>{this.buyerList=c[0],this.materialList=c[1],this.countryList=c[2],this.materialList=c[1].map(c=>(c.label=`${c.name} (${c.material_type}) - ${c.grade}`,c))},c=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/mining-company/purchase-order/list"])}onAddMaterial(){let c=this.materialForms;const t=this.createMaterialForm();t.patchValue({recv_country_id:this.countryList[0].id}),this.onChangeReceiverCountry(this.countryList[0],t),c.insert(0,t)}onRemoveMaterial(c){let t=this.materialForms,e=g.a.reject(t.controls,t=>t.controls.id.value===c.controls.id.value);t.controls=e}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const c=this.materialForms.value.map(c=>({material_id:c.material_id,truck_id:c.truck_id,driver_id:c.driver_id,weight:c.weight,recv_name:c.recv_name,recv_addr_line_1:c.recv_addr_line_1,recv_addr_line_2:c.recv_addr_line_2,recv_addr_line_3:c.recv_addr_line_3,recv_postcode:c.recv_postcode,recv_city:c.recv_city,recv_state_id:c.recv_state_id,recv_country_id:c.recv_country_id}));this.purchaseOrderService.create({buyer_id:this.mform.value.buyer_id,issue_to_id:this.mining_company_id,purchase_order_detail:c}).subscribe(c=>{this.toastr.success("New Purchase Order successfully created"),this.mform.reset()})}onChangeBuyer(c){let t=this.lookupService.listTruck(c.id),e=this.lookupService.listDriver(c.id);Object(Ec.a)([t,e]).subscribe(c=>{this.truckList=c[0],this.driverList=c[1],this.driverList=c[1].map(c=>(c.label=`${c.name} - ${c.id_num}`,c)),g.a.each(this.materialForms.controls,c=>{c.patchValue({truck_id:null,driver_id:null})})})}onChangeReceiverCountry(c,t){this.lookupService.listStates(c.id).subscribe(c=>{t.patchValue({state_id:null,stateList:c})})}get materialForms(){return this.mform.get("materialForms")}getStateList(c){return c.controls.stateList.value}invalidFg(c,t){const e=c.controls[t];return e.invalid&&(e.dirty||e.touched)}hasErrorFg(c,t,e){return c.controls[t].hasError(e)}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(p.a),d.Wb(p.g),d.Wb(L.a),d.Wb(y.a),d.Wb(Ic.a),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-create"]],features:[d.Hb],decls:40,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","buyer_id","name","buyer_id",3,"items","change"],["class","badge badge-danger",4,"ngIf"],[1,"row"],[1,"col-sm-12"],[1,"card-header"],[1,"card-title"],[1,"col-sm-2","col-4"],["type","button",1,"btn","btn-primary",3,"click"],["class","card","formArrayName","materialForms",4,"ngFor","ngForOf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"],["formArrayName","materialForms",1,"card"],[1,"card-tools"],["type","button",1,"btn","btn-tool",3,"click"],[1,"fas","fa-times"],[1,"card-body",3,"formGroupName"],[1,"col-sm-1","col-form-label"],[1,"col-sm-2"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","material_id","name","material_id",3,"items"],["bindLabel","registration_num","bindValue","id","placeholder","Please select","formControlName","truck_id","name","truck_id",3,"items"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","driver_id","name","driver_id",3,"items"],["type","text","placeholder","Weight (kg)","name","weight","formControlName","weight",1,"form-control",3,"ngClass"],[1,"col-sm-11"],["type","text","placeholder","Name","name","recv_name","formControlName","recv_name",1,"form-control",3,"ngClass"],["type","text","placeholder","Address","name","recv_addr_line_1","formControlName","recv_addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-11","offset-sm-1"],["type","text","placeholder","Address 2","name","recv_addr_line_2","formControlName","recv_addr_line_2",1,"form-control"],["type","text","placeholder","Address 3","name","recv_addr_line_3","formControlName","recv_addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","recv_postcode","formControlName","recv_postcode",1,"form-control",3,"ngClass"],[1,"col-sm-7"],["type","text","placeholder","City","name","recv_city","formControlName","recv_city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","recv_state_id","name","recv_state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","name","recv_country_id","formControlName","recv_country_id",3,"items","change"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Issue Purchase Order"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"form",6),d.kc("ngSubmit",(function(){return t.onSubmit()})),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"label",10),d.Lc(13,"Buyer\xa0"),d.cc(14,"span",11),d.Lc(15,"*"),d.bc(),d.bc(),d.cc(16,"div",12),d.cc(17,"ng-select",13),d.kc("change",(function(c){return t.onChangeBuyer(c)})),d.bc(),d.Jc(18,Dc,2,0,"small",14),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(19,"div",15),d.cc(20,"div",16),d.cc(21,"div",7),d.cc(22,"div",17),d.cc(23,"h3",18),d.Lc(24,"Materials"),d.bc(),d.bc(),d.cc(25,"div",8),d.cc(26,"div",9),d.cc(27,"div",19),d.ac(28),d.cc(29,"button",20),d.kc("click",(function(){return t.onAddMaterial()})),d.Lc(30,"Add Material"),d.bc(),d.Zb(),d.bc(),d.bc(),d.Jc(31,Jc,99,33,"div",21),d.bc(),d.cc(32,"div",22),d.cc(33,"div",3),d.cc(34,"button",23),d.kc("click",(function(){return t.onBack()})),d.Xb(35,"i",24),d.Lc(36," Back"),d.bc(),d.cc(37,"button",25),d.Xb(38,"i",26),d.Lc(39," Submit"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(8),d.sc("formGroup",t.mform),d.Kb(9),d.sc("items",t.buyerList),d.Kb(1),d.sc("ngIf",t.invalid("buyer_id")&&t.f.buyer_id.hasError("required")),d.Kb(13),d.sc("ngForOf",t.materialForms.controls))},directives:[r.t,r.k,r.e,s.a,r.j,r.d,i.m,i.l,r.b,r.f,r.a,i.k],styles:[""]}),c})()},{path:"detail/:id",component:(()=>{class c{constructor(c,t,e,i,r){this.route=c,this.router=t,this.authService=e,this.purchaseOrderService=i,this.toastr=r,this.isLoading=!1,this.data={id:""}}ngOnInit(){this.route.paramMap.subscribe(c=>{this.id=c.get("id"),this.load()})}load(){g.a.isNull(this.id)||g.a.isUndefined(this.id)?this.isLoading=!1:(this.isLoading=!0,this.purchaseOrderService.detail(this.id).subscribe(c=>{this.data=c},c=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/mining-company/purchase-order/list"])}onCopySuccess(c){this.toastr.success("DO Details copied")}getPODetails(){let c=[],t="";return g.a.each(this.data.details,t=>{let e=`DO #${t.do_num}\n`;e+=`Material: ${t.material.name}, Type: ${t.material.grade}, Grade: ${t.material.material_type}\n`,e+=`Truck No: ${t.truck.registration_num}\n`,e+=`Driver: ${t.driver.name}, IC No.: ${t.driver.id_num}\n\n`,c.push(e)}),t=c.join("-----------------------------\n\n"),t}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(p.a),d.Wb(p.g),d.Wb(L.a),d.Wb(yc),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-detail"]],decls:9,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-10"],[1,"col-sm-2"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"invoice","p-3","mb-3"],[1,"float-right"],[1,"row","invoice-info"],[1,"col-sm-6","invoice-col"],[4,"ngIf"],[1,"col-sm-4","invoice-col"],[1,"col-12","table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"row","no-print"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["ngxClipboard","",1,"btn","btn-default","mr-2",3,"cbContent","cbOnSuccess"],["target","_blank",1,"btn","btn-default",3,"routerLink"],[1,"fas","fa-print"],["colspan","7"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1"),d.Lc(5,"Purchase Order"),d.bc(),d.bc(),d.Xb(6,"div",4),d.bc(),d.bc(),d.bc(),d.cc(7,"section",5),d.Jc(8,jc,92,48,"div",6),d.bc()),2&c&&(d.Kb(8),d.sc("ngIf",!t.isLoading))},directives:[i.m,i.l,m,p.h],pipes:[i.e,i.s],styles:[""]}),c})()}]},{path:"buyer",children:[{path:"list",component:mc.a},{path:"create",component:hc.a},{path:"edit/:id",component:hc.a},{path:"truck/:buyer_id",children:[{path:"list",component:pc.a},{path:"create",component:_c.a},{path:"edit/:id",component:_c.a}]},{path:"driver/:buyer_id",children:[{path:"list",component:gc.a},{path:"create",component:vc.a},{path:"edit/:id",component:vc.a}]},{path:"user/:buyer_id",children:[{path:"list",component:fc.a}]}]}];let zc=(()=>{class c{}return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},imports:[[p.i.forChild(Qc)],p.i]}),c})();var Yc=e("jgPy"),ct=e("mrcu"),tt=e("Thox"),et=e("DLVw"),it=e("lSWO"),rt=e("kny6"),st=e("WF//");let nt=(()=>{class c{}return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},providers:[ct.a,tt.a,$,sc.a,et.a,it.a,rt.a,st.a,yc],imports:[[i.c,zc,r.g,r.o,Yc.a,s.b,n.c.forRoot(),a.c.forRoot(),o.b.forRoot(),h]]}),c})()}}]);