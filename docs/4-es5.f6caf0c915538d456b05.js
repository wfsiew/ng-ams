function _inherits(t,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(c&&c.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),c&&_setPrototypeOf(t,c)}function _setPrototypeOf(t,c){return(_setPrototypeOf=Object.setPrototypeOf||function(t,c){return t.__proto__=c,t})(t,c)}function _createSuper(t){var c=_isNativeReflectConstruct();return function(){var e,i=_getPrototypeOf(t);if(c){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,c){return!c||"object"!=typeof c&&"function"!=typeof c?_assertThisInitialized(t):c}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,c){if(!(t instanceof c))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,c){for(var e=0;e<c.length;e++){var i=c[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,c,e){return c&&_defineProperties(t.prototype,c),e&&_defineProperties(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"5Pgx":function(t,c,e){"use strict";e.d(c,"a",(function(){return D}));var i=e("d2bA"),r=e("C7yL"),n=e("g/JT"),s=e("fXoL"),a=e("tyNb"),o=e("pr82"),u=e("DLVw"),l=e("QLLi"),d=e("5eHb"),b=e("LqlI"),f=e("OpGx"),h=e("ofXK"),m=e("C4D8"),v=e("6No5"),p=e("3Pt+");function g(t,c){1&t&&(s.cc(0,"div",21),s.cc(1,"h4"),s.Lc(2,"No records found"),s.bc(),s.bc())}function y(t,c){if(1&t){var e=s.dc();s.ac(0),s.cc(1,"button",28),s.kc("click",(function(){s.Dc(e);var t=s.mc().$implicit;return s.mc(2).onAssign(t)})),s.Xb(2,"i",29),s.bc(),s.Zb()}}function _(t,c){if(1&t){var e=s.dc();s.ac(0),s.cc(1,"button",30),s.kc("click",(function(){s.Dc(e);var t=s.mc().$implicit;return s.mc(2).onDelete(t)})),s.Xb(2,"i",31),s.bc(),s.Zb()}}function k(t,c){if(1&t&&(s.cc(0,"tr"),s.cc(1,"td"),s.Lc(2),s.bc(),s.cc(3,"td"),s.Lc(4),s.bc(),s.cc(5,"td"),s.Lc(6),s.bc(),s.cc(7,"td"),s.Lc(8),s.bc(),s.cc(9,"td"),s.Lc(10),s.bc(),s.cc(11,"td",26),s.Jc(12,y,3,0,"ng-container",27),s.Jc(13,_,3,0,"ng-container",27),s.bc(),s.bc()),2&t){var e=c.$implicit,i=s.mc(2);s.Kb(2),s.Mc(e.username),s.Kb(2),s.Mc(e.email),s.Kb(2),s.Mc(e.first_name),s.Kb(2),s.Mc(e.last_name),s.Kb(2),s.Mc(i.getUserRoles(e)),s.Kb(2),s.sc("ngIf",0===i.tab),s.Kb(1),s.sc("ngIf",1===i.tab)}}function L(t,c){if(1&t){var e=s.dc();s.cc(0,"div",22),s.cc(1,"table",23),s.cc(2,"thead"),s.cc(3,"tr"),s.cc(4,"th"),s.cc(5,"app-sort-column",24),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(6,"th"),s.cc(7,"app-sort-column",24),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(8,"th"),s.cc(9,"app-sort-column",24),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(10,"th"),s.cc(11,"app-sort-column",24),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(12,"th"),s.Lc(13,"Role"),s.bc(),s.Xb(14,"th"),s.bc(),s.bc(),s.cc(15,"tbody"),s.Jc(16,k,14,7,"tr",25),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(5),s.sc("name","Username")("sort","username")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Email")("sort","email")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","First name")("sort","first_name")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Last name")("sort","last_name")("dir",i.sortDir)("current",i.sort),s.Kb(5),s.sc("ngForOf",i.list)}}function S(t,c){if(1&t){var e=s.dc();s.cc(0,"div",32),s.cc(1,"div",33),s.cc(2,"pagination",34),s.kc("ngModelChange",(function(t){return s.Dc(e),s.mc().page=t}))("pageChanged",(function(t){return s.Dc(e),s.mc().pageChanged(t)})),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(2),s.sc("totalItems",i.totalCount)("itemsPerPage",i.pageSize)("maxSize",i.MAX_PAGE_NUMBERS)("ngModel",i.page)}}var C=function(t){return{active:t}},D=function(){var t=function(){function t(c,e,i,s,a,o,u){_classCallCheck(this,t),this.route=c,this.router=e,this.userService=i,this.buyerService=s,this.msService=a,this.toastr=o,this.modalService=u,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=r.a.PAGE_SIZE,this.page=1,this.search="",this.sort="username",this.sortDir="asc",this.tab=1,this.sx=0,this.sy=0,this.uiState="setup.buyer.user-listing",this.isEmpty=n.a.isEmpty,this.PAGE_SIZE=r.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=r.a.MAX_PAGE_NUMBERS}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.buyer_id=c.get("buyer_id"),t.isLoading=!0,t.loadBuyer()})),this.subs=this.msService.get().subscribe((function(c){if(c.name===t.uiState){var e=c.data;t.page=e.page,t.sort=e.sort,t.sortDir=e.dir,t.search=e.search,t.sx=e.sx,t.sy=e.sy}}))}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"loadBuyer",value:function(){var t=this;this.buyerService.edit(this.buyer_id).subscribe((function(c){t.buyer=" - "+c.name,t.load()}))}},{key:"load",value:function(){var t=this;if(""===this.search){this.isLoading=!0;(0===this.tab?this.userService.listPending(this.page,r.a.PAGE_SIZE,this.sort,this.sortDir):this.userService.listActive(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir)).subscribe((function(c){t.list=c.body,t.totalCount=Number(c.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),t.isLoading=!1,setTimeout((function(){window.scrollTo(t.sx,t.sy)}),200)}),(function(t){}),(function(){t.isLoading=!1}))}else this.onSearch(this.search)}},{key:"onSearch",value:function(t){var c=this;this.search=t,this.isLoading=!0;(0===this.tab?this.userService.searchPending(this.page,r.a.PAGE_SIZE,this.sort,this.sortDir,t):this.userService.searchActive(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir,t)).subscribe((function(t){c.list=t.body,c.totalCount=Number(t.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),c.isLoading=!1,setTimeout((function(){window.scrollTo(c.sx,c.sy)}),200)}),(function(t){}),(function(){c.isLoading=!1}))}},{key:"pageChanged",value:function(t){this.page=t.page,this.load()}},{key:"onSortBy",value:function(t){""===t.sort&&"asc"===t.dir?(this.sort="username",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}},{key:"onTab",value:function(t){return this.tab!==t&&(this.page=1),this.tab=t,this.load(),!1}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/list"])}},{key:"onAssign",value:function(t){var c=this;this.userService.assign({buyer_id:this.buyer_id,user_id:t.id}).subscribe((function(t){c.toastr.success("User successfully assigned"),c.load()}))}},{key:"onDelete",value:function(t){var c=this;this.bsModalRef=this.modalService.show(i.a,{initialState:{title:"Delete User from "+this._buyer,message:"Are you sure to delete this User ".concat(t.username," from ").concat(this._buyer," ?")}}),this.bsModalRef.content.onClose.subscribe((function(e){!0===e.result&&c.userService.remove({buyer_id:c.buyer_id,user_id:t.id}).subscribe((function(t){c.toastr.success("User successfully deleted"),c.load()}))}))}},{key:"getUserRoles",value:function(t){return t.groups.map((function(t){return t.name})).join(", ")}},{key:"_buyer",get:function(){return this.buyer.replace(" - ","")}}]),t}();return t.\u0275fac=function(c){return new(c||t)(s.Wb(a.a),s.Wb(a.g),s.Wb(o.a),s.Wb(u.a),s.Wb(l.a),s.Wb(d.b),s.Wb(b.b))},t.\u0275cmp=s.Qb({type:t,selectors:[["app-user-listing"]],decls:28,vars:11,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"fas","fa-chevron-circle-left"],[1,"card-body"],["role","tablist",1,"nav","nav-tabs"],[1,"nav-item"],["data-toggle","pill","href","#","role","tab",1,"nav-link",3,"ngClass","click"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],[4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(s.cc(0,"section",0),s.cc(1,"div",1),s.cc(2,"div",2),s.cc(3,"div",3),s.cc(4,"h1",4),s.Lc(5),s.bc(),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(6,"section",5),s.cc(7,"div",1),s.cc(8,"div",6),s.cc(9,"div",7),s.cc(10,"div",8),s.cc(11,"div",9),s.cc(12,"app-search-input",10),s.kc("onSearch",(function(t){return c.onSearch(t)})),s.bc(),s.bc(),s.cc(13,"div",11),s.cc(14,"button",12),s.kc("click",(function(){return c.onBack()})),s.Xb(15,"i",13),s.Lc(16," Back"),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(17,"div",14),s.cc(18,"ul",15),s.cc(19,"li",16),s.cc(20,"a",17),s.kc("click",(function(){return c.onTab(1)})),s.Lc(21,"Active"),s.bc(),s.bc(),s.cc(22,"li",16),s.cc(23,"a",17),s.kc("click",(function(){return c.onTab(0)})),s.Lc(24,"Pending"),s.bc(),s.bc(),s.bc(),s.Jc(25,g,3,0,"div",18),s.Jc(26,L,17,17,"div",19),s.bc(),s.Jc(27,S,3,4,"div",20),s.bc(),s.bc(),s.bc()),2&t&&(s.Kb(5),s.Nc("User Listing ",c.buyer,""),s.Kb(7),s.sc("search",c.search),s.Kb(8),s.sc("ngClass",s.vc(7,C,1===c.tab)),s.Kb(3),s.sc("ngClass",s.vc(9,C,0===c.tab)),s.Kb(2),s.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",c.totalCount))},directives:[f.a,h.k,h.m,m.a,h.l,v.a,p.j,p.l],styles:[""]}),t}()},LNgY:function(t,c,e){"use strict";e.d(c,"a",(function(){return k}));var i=e("d2bA"),r=e("C7yL"),n=e("g/JT"),s=e("fXoL"),a=e("tyNb"),o=e("DLVw"),u=e("QLLi"),l=e("5eHb"),d=e("LqlI"),b=e("OpGx"),f=e("ofXK"),h=e("C4D8"),m=e("6No5"),v=e("3Pt+");function p(t,c){1&t&&(s.cc(0,"div",18),s.cc(1,"h4"),s.Lc(2,"No records found"),s.bc(),s.bc())}function g(t,c){if(1&t){var e=s.dc();s.cc(0,"tr"),s.cc(1,"td"),s.Lc(2),s.bc(),s.cc(3,"td"),s.Lc(4),s.bc(),s.cc(5,"td"),s.Lc(6),s.bc(),s.cc(7,"td"),s.Lc(8),s.bc(),s.cc(9,"td"),s.Lc(10),s.bc(),s.cc(11,"td"),s.Lc(12),s.bc(),s.cc(13,"td"),s.cc(14,"button",23),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onTruck(t)})),s.Xb(15,"i",24),s.bc(),s.bc(),s.cc(16,"td"),s.cc(17,"button",23),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onDriver(t)})),s.Xb(18,"i",25),s.bc(),s.bc(),s.cc(19,"td"),s.cc(20,"button",23),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onUser(t)})),s.Xb(21,"i",26),s.bc(),s.bc(),s.cc(22,"td",27),s.cc(23,"button",28),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onEdit(t)})),s.Xb(24,"i",29),s.bc(),s.cc(25,"button",30),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onDelete(t)})),s.Xb(26,"i",31),s.bc(),s.bc(),s.bc()}if(2&t){var i=c.$implicit,r=s.mc(2);s.Kb(2),s.Mc(i.name),s.Kb(2),s.Mc(i.registration_num),s.Kb(2),s.Mc(i.contact_no),s.Kb(2),s.Mc(r.getAddress(i)),s.Kb(2),s.Mc(i.state.name),s.Kb(2),s.Mc(i.country.name)}}function y(t,c){if(1&t){var e=s.dc();s.cc(0,"div",19),s.cc(1,"table",20),s.cc(2,"thead"),s.cc(3,"tr"),s.cc(4,"th"),s.cc(5,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(6,"th"),s.cc(7,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(8,"th"),s.cc(9,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(10,"th"),s.cc(11,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(12,"th"),s.cc(13,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(14,"th"),s.cc(15,"app-sort-column",21),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(16,"th"),s.Lc(17,"Trucks"),s.bc(),s.cc(18,"th"),s.Lc(19,"Drivers"),s.bc(),s.cc(20,"th"),s.Lc(21,"Users"),s.bc(),s.Xb(22,"th"),s.bc(),s.bc(),s.cc(23,"tbody"),s.Jc(24,g,27,6,"tr",22),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(5),s.sc("name","Name")("sort","name")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Business Reg. No.")("sort","registration_num")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Contact No.")("sort","contact_no")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Address")("sort","addr_line_1")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","State")("sort","state__name")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","Country")("sort","country__name")("dir",i.sortDir)("current",i.sort),s.Kb(9),s.sc("ngForOf",i.list)}}function _(t,c){if(1&t){var e=s.dc();s.cc(0,"div",32),s.cc(1,"div",33),s.cc(2,"pagination",34),s.kc("ngModelChange",(function(t){return s.Dc(e),s.mc().page=t}))("pageChanged",(function(t){return s.Dc(e),s.mc().pageChanged(t)})),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(2),s.sc("totalItems",i.totalCount)("itemsPerPage",i.pageSize)("maxSize",i.MAX_PAGE_NUMBERS)("ngModel",i.page)}}var k=function(){var t=function(){function t(c,e,i,s,a){var o=this;_classCallCheck(this,t),this.router=c,this.buyerService=e,this.msService=i,this.toastr=s,this.modalService=a,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=r.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.buyer-listing",this.isEmpty=n.a.isEmpty,this.PAGE_SIZE=r.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=r.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe((function(t){if(t.name===o.uiState){var c=t.data;o.page=c.page,o.sort=c.sort,o.sortDir=c.dir,o.search=c.search,o.sx=c.sx,o.sy=c.sy}}))}return _createClass(t,[{key:"ngOnInit",value:function(){this.load()}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"load",value:function(){var t=this;""===this.search?(this.isLoading=!0,this.buyerService.list(this.page,r.a.PAGE_SIZE,this.sort,this.sortDir).subscribe((function(c){t.list=c.body,t.totalCount=Number(c.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),t.isLoading=!1,setTimeout((function(){window.scrollTo(t.sx,t.sy)}),200)}),(function(t){}),(function(){t.isLoading=!1}))):this.onSearch(this.search)}},{key:"onSearch",value:function(t){var c=this;this.search=t,this.isLoading=!0,this.buyerService.search(this.page,r.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe((function(t){c.list=t.body,c.totalCount=Number(t.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),c.isLoading=!1,setTimeout((function(){window.scrollTo(c.sx,c.sy)}),200)}),(function(t){}),(function(){c.isLoading=!1}))}},{key:"pageChanged",value:function(t){this.page=t.page,this.load()}},{key:"onSortBy",value:function(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}},{key:"goto",value:function(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/buyer/"+t])}},{key:"onTruck",value:function(t){this.goto("truck/".concat(t.id,"/list"))}},{key:"onDriver",value:function(t){this.goto("driver/".concat(t.id,"/list"))}},{key:"onUser",value:function(t){this.goto("user/".concat(t.id,"/list"))}},{key:"onEdit",value:function(t){this.goto("edit/"+t.id)}},{key:"onDelete",value:function(t){var c=this;this.bsModalRef=this.modalService.show(i.a,{initialState:{title:"Delete Buyer",message:"Are you sure to delete this Buyer ".concat(t.name," ?")}}),this.bsModalRef.content.onClose.subscribe((function(e){!0===e.result&&c.buyerService.remove(t.id).subscribe((function(t){c.toastr.success("Buyer successfully deleted"),c.load()}))}))}},{key:"getAddress",value:function(t){var c="",e=[t.addr_line_1];return t.addr_line_2&&e.push(t.addr_line_2),t.addr_line_3&&e.push(t.addr_line_3),c=e.join(", "),c=" ".concat(c," ").concat(t.postcode," ").concat(t.city)}}]),t}();return t.\u0275fac=function(c){return new(c||t)(s.Wb(a.g),s.Wb(o.a),s.Wb(u.a),s.Wb(l.b),s.Wb(d.b))},t.\u0275cmp=s.Qb({type:t,selectors:[["app-buyer-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-truck"],[1,"fas","fa-id-card"],[1,"fas","fa-user"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(s.cc(0,"section",0),s.cc(1,"div",1),s.cc(2,"div",2),s.cc(3,"div",3),s.cc(4,"h1",4),s.Lc(5,"Buyer Listing"),s.bc(),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(6,"section",5),s.cc(7,"div",1),s.cc(8,"div",6),s.cc(9,"div",7),s.cc(10,"div",8),s.cc(11,"div",9),s.cc(12,"app-search-input",10),s.kc("onSearch",(function(t){return c.onSearch(t)})),s.bc(),s.bc(),s.cc(13,"div",11),s.cc(14,"button",12),s.kc("click",(function(){return c.goto("create")})),s.Xb(15,"i",13),s.Lc(16," Add New"),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(17,"div",14),s.Jc(18,p,3,0,"div",15),s.Jc(19,y,25,25,"div",16),s.bc(),s.Jc(20,_,3,4,"div",17),s.bc(),s.bc(),s.bc()),2&t&&(s.Kb(12),s.sc("search",c.search),s.Kb(6),s.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",c.totalCount&&!c.isLoading))},directives:[b.a,f.m,h.a,f.l,m.a,v.j,v.l],styles:[""]}),t}()},VuLe:function(t,c,e){"use strict";e.d(c,"a",(function(){return C}));var i=e("3Pt+"),r=e("LvDl"),n=e.n(r),s=e("fwOm"),a=e("fXoL"),o=e("tyNb"),u=e("wgH9"),l=e("DLVw"),d=e("5eHb"),b=e("ofXK"),f=e("ZOsW");function h(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Name is required "),a.bc())}function m(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Business Registration No. is required "),a.bc())}function v(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Contact No. is required "),a.bc())}function p(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Address 1 is required "),a.bc())}function g(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Postcode is required "),a.bc())}function y(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," City is required "),a.bc())}function _(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," State is required "),a.bc())}function k(t,c){1&t&&(a.cc(0,"small",36),a.Lc(1," Country is required "),a.bc())}var L=function(t){return{"is-invalid":t}};function S(t,c){if(1&t){var e=a.dc();a.cc(0,"div",1),a.cc(1,"form",7),a.kc("ngSubmit",(function(){return a.Dc(e),a.mc().onSubmit()})),a.cc(2,"div",8),a.cc(3,"div",9),a.cc(4,"div",10),a.cc(5,"label",11),a.Lc(6,"Name\xa0"),a.cc(7,"span",12),a.Lc(8,"*"),a.bc(),a.bc(),a.cc(9,"div",13),a.Xb(10,"input",14),a.Jc(11,h,2,0,"small",15),a.bc(),a.bc(),a.cc(12,"div",10),a.cc(13,"label",11),a.Lc(14,"Business Registration No.\xa0"),a.cc(15,"span",12),a.Lc(16,"*"),a.bc(),a.bc(),a.cc(17,"div",13),a.Xb(18,"input",16),a.Jc(19,m,2,0,"small",15),a.bc(),a.bc(),a.cc(20,"div",10),a.cc(21,"label",11),a.Lc(22,"Contact No.\xa0"),a.cc(23,"span",12),a.Lc(24,"*"),a.bc(),a.bc(),a.cc(25,"div",13),a.Xb(26,"input",17),a.Jc(27,v,2,0,"small",15),a.bc(),a.bc(),a.cc(28,"div",10),a.cc(29,"label",11),a.Lc(30,"Email"),a.bc(),a.cc(31,"div",13),a.Xb(32,"input",18),a.bc(),a.bc(),a.cc(33,"div",10),a.cc(34,"label",11),a.Lc(35,"Fax No."),a.bc(),a.cc(36,"div",13),a.Xb(37,"input",19),a.bc(),a.bc(),a.cc(38,"div",10),a.cc(39,"label",11),a.Lc(40,"Address\xa0"),a.cc(41,"span",12),a.Lc(42,"*"),a.bc(),a.bc(),a.cc(43,"div",13),a.Xb(44,"input",20),a.Jc(45,p,2,0,"small",15),a.bc(),a.bc(),a.cc(46,"div",10),a.cc(47,"div",21),a.Xb(48,"input",22),a.bc(),a.bc(),a.cc(49,"div",10),a.cc(50,"div",21),a.Xb(51,"input",23),a.bc(),a.bc(),a.cc(52,"div",10),a.cc(53,"label",11),a.Lc(54,"Postcode\xa0"),a.cc(55,"span",12),a.Lc(56,"*"),a.bc(),a.bc(),a.cc(57,"div",24),a.Xb(58,"input",25),a.Jc(59,g,2,0,"small",15),a.bc(),a.cc(60,"label",26),a.Lc(61,"City\xa0"),a.cc(62,"span",12),a.Lc(63,"*"),a.bc(),a.bc(),a.cc(64,"div",27),a.Xb(65,"input",28),a.Jc(66,y,2,0,"small",15),a.bc(),a.bc(),a.cc(67,"div",10),a.cc(68,"label",11),a.Lc(69,"State\xa0"),a.cc(70,"span",12),a.Lc(71,"*"),a.bc(),a.bc(),a.cc(72,"div",24),a.Xb(73,"ng-select",29),a.Jc(74,_,2,0,"small",15),a.bc(),a.cc(75,"label",26),a.Lc(76,"Country\xa0"),a.cc(77,"span",12),a.Lc(78,"*"),a.bc(),a.bc(),a.cc(79,"div",27),a.cc(80,"ng-select",30),a.kc("change",(function(t){return a.Dc(e),a.mc().onChangeCountry(t)})),a.bc(),a.Jc(81,k,2,0,"small",15),a.bc(),a.bc(),a.bc(),a.cc(82,"div",31),a.cc(83,"button",32),a.kc("click",(function(){return a.Dc(e),a.mc().onBack()})),a.Xb(84,"i",33),a.Lc(85," Back"),a.bc(),a.cc(86,"button",34),a.Xb(87,"i",35),a.Lc(88," Save"),a.bc(),a.bc(),a.bc(),a.bc(),a.bc()}if(2&t){var i=a.mc();a.Kb(1),a.sc("formGroup",i.mform),a.Kb(9),a.sc("ngClass",a.vc(17,L,i.invalid("name"))),a.Kb(1),a.sc("ngIf",i.invalid("name")&&i.f.name.hasError("required")),a.Kb(7),a.sc("ngClass",a.vc(19,L,i.invalid("registration_num"))),a.Kb(1),a.sc("ngIf",i.invalid("registration_num")&&i.f.registration_num.hasError("required")),a.Kb(7),a.sc("ngClass",a.vc(21,L,i.invalid("contact_no"))),a.Kb(1),a.sc("ngIf",i.invalid("contact_no")&&i.f.contact_no.hasError("required")),a.Kb(17),a.sc("ngClass",a.vc(23,L,i.invalid("addr_line_1"))),a.Kb(1),a.sc("ngIf",i.invalid("addr_line_1")&&i.f.addr_line_1.hasError("required")),a.Kb(13),a.sc("ngClass",a.vc(25,L,i.invalid("postcode"))),a.Kb(1),a.sc("ngIf",i.invalid("postcode")&&i.f.postcode.hasError("required")),a.Kb(6),a.sc("ngClass",a.vc(27,L,i.invalid("city"))),a.Kb(1),a.sc("ngIf",i.invalid("city")&&i.f.city.hasError("required")),a.Kb(7),a.sc("items",i.stateList),a.Kb(1),a.sc("ngIf",i.invalid("state_id")&&i.f.state_id.hasError("required")),a.Kb(6),a.sc("items",i.countryList),a.Kb(1),a.sc("ngIf",i.invalid("country_id")&&i.f.country_id.hasError("required"))}}var C=function(){var t=function(t){_inherits(e,t);var c=_createSuper(e);function e(t,i,r,n,s,a){var o;return _classCallCheck(this,e),(o=c.call(this)).fb=t,o.route=i,o.router=r,o.lookupService=n,o.buyerService=s,o.toastr=a,o.isLoading=!1,o.data={id:""},o.isEdit=!1,o.countryList=[],o.stateList=[],o.createForm(),o}return _createClass(e,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.id=c.get("id"),n.a.isNull(t.id)||(t.isEdit=!0),t.load()}))}},{key:"createForm",value:function(){this.mform=this.fb.group({name:["",[i.p.required]],registration_num:["",[i.p.required]],contact_no:["",[i.p.required]],email:[""],fax_no:[""],addr_line_1:["",[i.p.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[i.p.required]],city:["",[i.p.required]],state_id:[null,[i.p.required]],country_id:[null,[i.p.required]]})}},{key:"setForm",value:function(){var t=this,c=this.data;this.mform.patchValue({name:c.name,registration_num:c.registration_num,contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,country_id:c.country.id}),this.lookupService.listStates(c.country.id).subscribe((function(e){t.stateList=e,t.mform.patchValue({state_id:c.state.id})}))}},{key:"load",value:function(){var t=this;this.isLoading=!0,this.lookupService.listCountry().subscribe((function(c){t.countryList=c,t.mform.patchValue({country_id:t.countryList[0].id}),t.onChangeCountry(t.countryList[0]),t.loadDetails()}),(function(c){t.isLoading=!1}))}},{key:"loadDetails",value:function(){var t=this;n.a.isNull(this.id)||n.a.isUndefined(this.id)?this.isLoading=!1:this.buyerService.edit(this.id).subscribe((function(c){t.data=c,t.setForm()}),(function(t){}),(function(){t.isLoading=!1}))}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/list"])}},{key:"onSubmit",value:function(){var t=this;if(this.mform.invalid)this.mform.markAllAsTouched();else{var c=this.mform.value,e={name:c.name,registration_num:c.registration_num,contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,state_id:c.state_id,country_id:c.country_id};this.isEdit?this.buyerService.update(this.data.id,e).subscribe((function(c){t.toastr.success("Buyer successfully updated")})):this.buyerService.create(e).subscribe((function(c){t.toastr.success("New Buyer successfully created"),t.mform.reset()}))}}},{key:"onChangeCountry",value:function(t){var c=this;this.lookupService.listStates(t.id).subscribe((function(t){c.stateList=t,c.mform.patchValue({state_id:null})}))}}]),e}(s.a);return t.\u0275fac=function(c){return new(c||t)(a.Wb(i.c),a.Wb(o.a),a.Wb(o.g),a.Wb(u.a),a.Wb(l.a),a.Wb(d.b))},t.\u0275cmp=a.Qb({type:t,selectors:[["app-buyer-create"]],features:[a.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(a.cc(0,"section",0),a.cc(1,"div",1),a.cc(2,"div",2),a.cc(3,"div",3),a.cc(4,"h1",4),a.Lc(5,"Add / Edit Buyer"),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(6,"section",5),a.Jc(7,S,89,29,"div",6),a.bc()),2&t&&(a.Kb(7),a.sc("ngIf",!c.isLoading))},directives:[b.m,i.q,i.k,i.e,i.a,i.j,i.d,b.k,f.a],styles:[""]}),t}()},"a+IK":function(t,c,e){"use strict";e.d(c,"a",(function(){return s}));var i=e("tk/3"),r=e("AytR"),n=e("fXoL"),s=function(){var t=function(){function t(c){_classCallCheck(this,t),this.http=c,this.baseUrl=r.a.baseUrl}return _createClass(t,[{key:"list",value:function(t,c,e,r){var n=(new i.f).set("_page",t).set("_limit",c);return""!==e&&(""===r&&(r="asc"),n=n.append("sort","".concat(e,":").concat(r))),this.http.get(this.baseUrl+"/api/mining-companies",{params:n,observe:"response"})}},{key:"search",value:function(t,c,e,r,n){var s=(new i.f).set("_page",t).set("_limit",c);return""!==e&&(""===r&&(r="asc"),s=s.append("sort","".concat(e,":").concat(r))),this.http.post(this.baseUrl+"/api/mining-companies",{keyword:n},{params:s,observe:"response"})}},{key:"create",value:function(t){return this.http.post(this.baseUrl+"/api/mining-company",t)}},{key:"edit",value:function(t){return this.http.get("".concat(this.baseUrl,"/api/mining-company/").concat(t))}},{key:"update",value:function(t,c){return this.http.put("".concat(this.baseUrl,"/api/mining-company/").concat(t),c)}},{key:"remove",value:function(t){return this.http.delete("".concat(this.baseUrl,"/api/mining-company/").concat(t))}}]),t}();return t.\u0275fac=function(c){return new(c||t)(n.gc(i.b))},t.\u0275prov=n.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},bOQg:function(t,c,e){"use strict";e.d(c,"a",(function(){return p}));var i=e("3Pt+"),r=e("LvDl"),n=e.n(r),s=e("fwOm"),a=e("fXoL"),o=e("tyNb"),u=e("lSWO"),l=e("5eHb"),d=e("ofXK"),b=["uploader"];function f(t,c){1&t&&(a.cc(0,"div",3),a.cc(1,"div",25),a.cc(2,"div",26),a.cc(3,"h1",27),a.Lc(4,"Add / Edit Truck"),a.bc(),a.bc(),a.bc(),a.bc())}function h(t,c){1&t&&(a.cc(0,"small",28),a.Lc(1," Registration No. is required "),a.bc())}function m(t,c){if(1&t){var e=a.dc();a.cc(0,"div",7),a.cc(1,"div",13),a.cc(2,"div",5),a.cc(3,"div",29),a.cc(4,"div",30),a.cc(5,"button",31),a.kc("click",(function(){a.Dc(e);var t=a.mc(),c=a.Bc(31);return t.onRemoveFile(c)})),a.Xb(6,"i",32),a.bc(),a.bc(),a.bc(),a.cc(7,"div",6),a.Xb(8,"img",33),a.bc(),a.bc(),a.bc(),a.bc()}if(2&t){var i=a.mc();a.Kb(8),a.sc("src",i.imgURL,a.Fc)}}var v=function(t){return{"is-invalid":t}},p=function(){var t=function(t){_inherits(e,t);var c=_createSuper(e);function e(t,i,r,n,s){var a;return _classCallCheck(this,e),(a=c.call(this)).fb=t,a.route=i,a.router=r,a.truckService=n,a.toastr=s,a.isLoading=!1,a.data={id:""},a.imgId=0,a.isEdit=!1,a.createForm(),a}return _createClass(e,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.id=c.get("id"),t.buyer_id=c.get("buyer_id"),n.a.isNull(t.id)||(t.isEdit=!0),t.load()}))}},{key:"createForm",value:function(){this.mform=this.fb.group({registration_num:["",[i.p.required]]})}},{key:"setForm",value:function(){this.mform.patchValue({registration_num:this.data.registration_num})}},{key:"setImage",value:function(){var t=this.data;t.img&&(this.imgId=t.img.id,this.imgURL=t.img.img)}},{key:"load",value:function(){var t=this;n.a.isNull(this.id)||n.a.isUndefined(this.id)||(this.isLoading=!0,this.truckService.edit(this.buyer_id,this.id).subscribe((function(c){t.data=c,t.setForm(),t.setImage()}),(function(t){}),(function(){t.isLoading=!1})))}},{key:"uploadFile",value:function(t){var c=this;if(0!==t.length)if(null!=t[0].type.match(/image\/*/)){this.file=t[0];var e=new FileReader;e.readAsDataURL(t[0]),e.onload=function(t){c.imgURL=e.result}}else this.toastr.error("Only images are supported")}},{key:"onRemoveFile",value:function(t){this.imgURL=null,this.file=null,t.value=""}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/truck/".concat(this.buyer_id,"/list")])}},{key:"onSubmit",value:function(){var t=this;if(this.mform.invalid)this.mform.markAllAsTouched();else if(this.file||this.isEdit)if(this.file||0!==this.imgId||!this.isEdit){var c=this.mform.value,e=new FormData;this.file&&e.append("file",this.file),e.append("registration_num",c.registration_num),e.append("buyer_id",this.buyer_id),this.isEdit?this.truckService.update(this.buyer_id,this.data.id,e).subscribe((function(c){t.toastr.success("Truck successfully updated")})):this.truckService.create(this.buyer_id,e).subscribe((function(c){t.toastr.success("New Truck successfully created"),t.mform.reset(),t.onRemoveFile(t.uploader.nativeElement)}))}else this.toastr.error("Please upload truck photo");else this.toastr.error("Please upload truck photo")}}]),e}(s.a);return t.\u0275fac=function(c){return new(c||t)(a.Wb(i.c),a.Wb(o.a),a.Wb(o.g),a.Wb(u.a),a.Wb(l.b))},t.\u0275cmp=a.Qb({type:t,selectors:[["app-truck-create"]],viewQuery:function(t,c){var e;1&t&&a.Sc(b,!0),2&t&&a.Ac(e=a.lc())&&(c.uploader=e.first)},features:[a.Hb],decls:32,vars:7,consts:[[1,"content-header"],["class","container-fluid",4,"ngIf"],[1,"content"],[1,"container-fluid"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],[1,"col-sm-4","offset-sm-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-file"],[1,"badge","badge-info","ml-2"],["class","form-group row",4,"ngIf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],["hidden","","type","file","accept","image/*",3,"change"],["uploader",""],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"badge","badge-danger"],[1,"card-header","border-bottom-0"],[1,"card-tools"],["type","button",1,"btn","btn-tool",3,"click"],[1,"fas","fa-times"],[1,"img-fluid","mx-auto","d-block",3,"src"]],template:function(t,c){if(1&t){var e=a.dc();a.cc(0,"section",0),a.Jc(1,f,5,0,"div",1),a.bc(),a.cc(2,"section",2),a.cc(3,"div",3),a.cc(4,"form",4),a.kc("ngSubmit",(function(){return c.onSubmit()})),a.cc(5,"div",5),a.cc(6,"div",6),a.cc(7,"div",7),a.cc(8,"label",8),a.Lc(9,"Registration No.\xa0"),a.cc(10,"span",9),a.Lc(11,"*"),a.bc(),a.bc(),a.cc(12,"div",10),a.Xb(13,"input",11),a.Jc(14,h,2,0,"small",12),a.bc(),a.bc(),a.cc(15,"div",7),a.cc(16,"div",13),a.cc(17,"button",14),a.kc("click",(function(){return a.Dc(e),a.Bc(31).click()})),a.Xb(18,"i",15),a.Lc(19," Add Photo"),a.bc(),a.cc(20,"span",16),a.Lc(21,"Max file size is 5 MB"),a.bc(),a.bc(),a.bc(),a.Jc(22,m,9,1,"div",17),a.bc(),a.cc(23,"div",18),a.cc(24,"button",19),a.kc("click",(function(){return c.onBack()})),a.Xb(25,"i",20),a.Lc(26," Back"),a.bc(),a.cc(27,"button",21),a.Xb(28,"i",22),a.Lc(29," Save"),a.bc(),a.bc(),a.bc(),a.cc(30,"input",23,24),a.kc("change",(function(){a.Dc(e);var t=a.Bc(31);return c.uploadFile(t.files)})),a.bc(),a.bc(),a.bc(),a.bc()}2&t&&(a.Kb(1),a.sc("ngIf",!c.isLoading),a.Kb(3),a.sc("formGroup",c.mform),a.Kb(9),a.sc("ngClass",a.vc(5,v,c.invalid("registration_num"))),a.Kb(1),a.sc("ngIf",c.invalid("registration_num")&&c.f.registration_num.hasError("required")),a.Kb(8),a.sc("ngIf",c.imgURL))},directives:[d.m,i.q,i.k,i.e,i.a,i.j,i.d,d.k],styles:[""]}),t}()},eUtn:function(t,c,e){"use strict";e.d(c,"a",(function(){return L}));var i=e("d2bA"),r=e("C7yL"),n=e("g/JT"),s=e("fXoL"),a=e("tyNb"),o=e("lSWO"),u=e("DLVw"),l=e("QLLi"),d=e("5eHb"),b=e("LqlI"),f=e("OpGx"),h=e("ofXK"),m=e("C4D8"),v=e("6No5"),p=e("3Pt+");function g(t,c){1&t&&(s.cc(0,"div",20),s.cc(1,"h4"),s.Lc(2,"No records found"),s.bc(),s.bc())}function y(t,c){if(1&t){var e=s.dc();s.cc(0,"tr"),s.cc(1,"td"),s.Lc(2),s.bc(),s.cc(3,"td",25),s.cc(4,"button",26),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onEdit(t)})),s.Xb(5,"i",27),s.bc(),s.cc(6,"button",28),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onDelete(t)})),s.Xb(7,"i",29),s.bc(),s.bc(),s.bc()}if(2&t){var i=c.$implicit;s.Kb(2),s.Mc(i.registration_num)}}function _(t,c){if(1&t){var e=s.dc();s.cc(0,"div",21),s.cc(1,"table",22),s.cc(2,"thead"),s.cc(3,"tr"),s.cc(4,"th"),s.cc(5,"app-sort-column",23),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.Xb(6,"th"),s.bc(),s.bc(),s.cc(7,"tbody"),s.Jc(8,y,8,1,"tr",24),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(5),s.sc("name","Registration No.")("sort","registration_num")("dir",i.sortDir)("current",i.sort),s.Kb(3),s.sc("ngForOf",i.list)}}function k(t,c){if(1&t){var e=s.dc();s.cc(0,"div",30),s.cc(1,"div",31),s.cc(2,"pagination",32),s.kc("ngModelChange",(function(t){return s.Dc(e),s.mc().page=t}))("pageChanged",(function(t){return s.Dc(e),s.mc().pageChanged(t)})),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(2),s.sc("totalItems",i.totalCount)("itemsPerPage",i.pageSize)("maxSize",i.MAX_PAGE_NUMBERS)("ngModel",i.page)}}var L=function(){var t=function(){function t(c,e,i,s,a,o,u){_classCallCheck(this,t),this.route=c,this.router=e,this.truckService=i,this.buyerService=s,this.msService=a,this.toastr=o,this.modalService=u,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=r.a.PAGE_SIZE,this.page=1,this.search="",this.sort="registration_num",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.truck-listing",this.isEmpty=n.a.isEmpty,this.PAGE_SIZE=r.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=r.a.MAX_PAGE_NUMBERS}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.buyer_id=c.get("buyer_id"),t.isLoading=!0,t.loadBuyer()})),this.subs=this.msService.get().subscribe((function(c){if(c.name===t.uiState){var e=c.data;t.page=e.page,t.sort=e.sort,t.sortDir=e.dir,t.search=e.search,t.sx=e.sx,t.sy=e.sy}}))}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"loadBuyer",value:function(){var t=this;this.buyerService.edit(this.buyer_id).subscribe((function(c){t.buyer=" - "+c.name,t.load()}))}},{key:"load",value:function(){var t=this;""===this.search?(this.isLoading=!0,this.truckService.list(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir).subscribe((function(c){t.list=c.body,t.totalCount=Number(c.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),t.isLoading=!1,setTimeout((function(){window.scrollTo(t.sx,t.sy)}),200)}),(function(t){}),(function(){t.isLoading=!1}))):this.onSearch(this.search)}},{key:"onSearch",value:function(t){var c=this;this.search=t,this.isLoading=!0,this.truckService.search(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe((function(t){c.list=t.body,c.totalCount=Number(t.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),c.isLoading=!1,setTimeout((function(){window.scrollTo(c.sx,c.sy)}),200)}),(function(t){}),(function(){c.isLoading=!1}))}},{key:"pageChanged",value:function(t){this.page=t.page,this.load()}},{key:"onSortBy",value:function(t){""===t.sort&&"asc"===t.dir?(this.sort="registration_num",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}},{key:"goto",value:function(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/buyer/truck/".concat(this.buyer_id,"/").concat(t)])}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/list"])}},{key:"onEdit",value:function(t){this.goto("edit/"+t.id)}},{key:"onDelete",value:function(t){var c=this;this.bsModalRef=this.modalService.show(i.a,{initialState:{title:"Delete Truck",message:"Are you sure to delete this Truck ".concat(t.registration_num," ?")}}),this.bsModalRef.content.onClose.subscribe((function(e){!0===e.result&&c.truckService.remove(c.buyer_id,t.id).subscribe((function(t){c.toastr.success("Truck successfully deleted"),c.load()}))}))}}]),t}();return t.\u0275fac=function(c){return new(c||t)(s.Wb(a.a),s.Wb(a.g),s.Wb(o.a),s.Wb(u.a),s.Wb(l.a),s.Wb(d.b),s.Wb(b.b))},t.\u0275cmp=s.Qb({type:t,selectors:[["app-truck-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(s.cc(0,"section",0),s.cc(1,"div",1),s.cc(2,"div",2),s.cc(3,"div",3),s.cc(4,"h1",4),s.Lc(5),s.bc(),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(6,"section",5),s.cc(7,"div",1),s.cc(8,"div",6),s.cc(9,"div",7),s.cc(10,"div",8),s.cc(11,"div",9),s.cc(12,"app-search-input",10),s.kc("onSearch",(function(t){return c.onSearch(t)})),s.bc(),s.bc(),s.cc(13,"div",11),s.cc(14,"button",12),s.kc("click",(function(){return c.onBack()})),s.Xb(15,"i",13),s.Lc(16," Back"),s.bc(),s.cc(17,"button",14),s.kc("click",(function(){return c.goto("create")})),s.Xb(18,"i",15),s.Lc(19," Add New"),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(20,"div",16),s.Jc(21,g,3,0,"div",17),s.Jc(22,_,9,5,"div",18),s.bc(),s.Jc(23,k,3,4,"div",19),s.bc(),s.bc(),s.bc()),2&t&&(s.Kb(5),s.Nc("Truck Listing ",c.buyer,""),s.Kb(7),s.sc("search",c.search),s.Kb(9),s.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",c.totalCount&&!c.isLoading))},directives:[f.a,h.m,m.a,h.l,v.a,p.j,p.l],styles:[""]}),t}()},fdx9:function(t,c,e){"use strict";e.d(c,"a",(function(){return L}));var i=e("d2bA"),r=e("C7yL"),n=e("g/JT"),s=e("fXoL"),a=e("tyNb"),o=e("kny6"),u=e("DLVw"),l=e("QLLi"),d=e("5eHb"),b=e("LqlI"),f=e("OpGx"),h=e("ofXK"),m=e("C4D8"),v=e("6No5"),p=e("3Pt+");function g(t,c){1&t&&(s.cc(0,"div",20),s.cc(1,"h4"),s.Lc(2,"No records found"),s.bc(),s.bc())}function y(t,c){if(1&t){var e=s.dc();s.cc(0,"tr"),s.cc(1,"td"),s.Lc(2),s.bc(),s.cc(3,"td"),s.Lc(4),s.bc(),s.cc(5,"td",25),s.cc(6,"button",26),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onEdit(t)})),s.Xb(7,"i",27),s.bc(),s.cc(8,"button",28),s.kc("click",(function(){s.Dc(e);var t=c.$implicit;return s.mc(2).onDelete(t)})),s.Xb(9,"i",29),s.bc(),s.bc(),s.bc()}if(2&t){var i=c.$implicit;s.Kb(2),s.Mc(i.name),s.Kb(2),s.Mc(i.id_num)}}function _(t,c){if(1&t){var e=s.dc();s.cc(0,"div",21),s.cc(1,"table",22),s.cc(2,"thead"),s.cc(3,"tr"),s.cc(4,"th"),s.cc(5,"app-sort-column",23),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.cc(6,"th"),s.cc(7,"app-sort-column",23),s.kc("onSortBy",(function(t){return s.Dc(e),s.mc().onSortBy(t)})),s.bc(),s.bc(),s.Xb(8,"th"),s.bc(),s.bc(),s.cc(9,"tbody"),s.Jc(10,y,10,2,"tr",24),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(5),s.sc("name","Name")("sort","name")("dir",i.sortDir)("current",i.sort),s.Kb(2),s.sc("name","ID Number")("sort","id_num")("dir",i.sortDir)("current",i.sort),s.Kb(3),s.sc("ngForOf",i.list)}}function k(t,c){if(1&t){var e=s.dc();s.cc(0,"div",30),s.cc(1,"div",31),s.cc(2,"pagination",32),s.kc("ngModelChange",(function(t){return s.Dc(e),s.mc().page=t}))("pageChanged",(function(t){return s.Dc(e),s.mc().pageChanged(t)})),s.bc(),s.bc(),s.bc()}if(2&t){var i=s.mc();s.Kb(2),s.sc("totalItems",i.totalCount)("itemsPerPage",i.pageSize)("maxSize",i.MAX_PAGE_NUMBERS)("ngModel",i.page)}}var L=function(){var t=function(){function t(c,e,i,s,a,o,u){_classCallCheck(this,t),this.route=c,this.router=e,this.driverService=i,this.buyerService=s,this.msService=a,this.toastr=o,this.modalService=u,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=r.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.driver-listing",this.isEmpty=n.a.isEmpty,this.PAGE_SIZE=r.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=r.a.MAX_PAGE_NUMBERS}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.buyer_id=c.get("buyer_id"),t.isLoading=!0,t.loadBuyer()})),this.subs=this.msService.get().subscribe((function(c){if(c.name===t.uiState){var e=c.data;t.page=e.page,t.sort=e.sort,t.sortDir=e.dir,t.search=e.search,t.sx=e.sx,t.sy=e.sy}}))}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"loadBuyer",value:function(){var t=this;this.buyerService.edit(this.buyer_id).subscribe((function(c){t.buyer=" - "+c.name,t.load()}))}},{key:"load",value:function(){var t=this;""===this.search?(this.isLoading=!0,this.driverService.list(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir).subscribe((function(c){t.list=c.body,t.totalCount=Number(c.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),t.isLoading=!1,setTimeout((function(){window.scrollTo(t.sx,t.sy)}),200)}),(function(t){}),(function(){t.isLoading=!1}))):this.onSearch(this.search)}},{key:"onSearch",value:function(t){var c=this;this.search=t,this.isLoading=!0,this.driverService.search(this.buyer_id,this.page,r.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe((function(t){c.list=t.body,c.totalCount=Number(t.headers.get(r.a.HTTP_HEADER.X_TOTAL_COUNT)),c.isLoading=!1,setTimeout((function(){window.scrollTo(c.sx,c.sy)}),200)}),(function(t){}),(function(){c.isLoading=!1}))}},{key:"pageChanged",value:function(t){this.page=t.page,this.load()}},{key:"onSortBy",value:function(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}},{key:"goto",value:function(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/buyer/driver/".concat(this.buyer_id,"/").concat(t)])}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/list"])}},{key:"onEdit",value:function(t){this.goto("edit/"+t.id)}},{key:"onDelete",value:function(t){var c=this;this.bsModalRef=this.modalService.show(i.a,{initialState:{title:"Delete Driver",message:"Are you sure to delete this Driver ".concat(t.id_num," ?")}}),this.bsModalRef.content.onClose.subscribe((function(e){!0===e.result&&c.driverService.remove(c.buyer_id,t.id).subscribe((function(t){c.toastr.success("Driver successfully deleted"),c.load()}))}))}}]),t}();return t.\u0275fac=function(c){return new(c||t)(s.Wb(a.a),s.Wb(a.g),s.Wb(o.a),s.Wb(u.a),s.Wb(l.a),s.Wb(d.b),s.Wb(b.b))},t.\u0275cmp=s.Qb({type:t,selectors:[["app-driver-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(s.cc(0,"section",0),s.cc(1,"div",1),s.cc(2,"div",2),s.cc(3,"div",3),s.cc(4,"h1",4),s.Lc(5),s.bc(),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(6,"section",5),s.cc(7,"div",1),s.cc(8,"div",6),s.cc(9,"div",7),s.cc(10,"div",8),s.cc(11,"div",9),s.cc(12,"app-search-input",10),s.kc("onSearch",(function(t){return c.onSearch(t)})),s.bc(),s.bc(),s.cc(13,"div",11),s.cc(14,"button",12),s.kc("click",(function(){return c.onBack()})),s.Xb(15,"i",13),s.Lc(16," Back"),s.bc(),s.cc(17,"button",14),s.kc("click",(function(){return c.goto("create")})),s.Xb(18,"i",15),s.Lc(19," Add New"),s.bc(),s.bc(),s.bc(),s.bc(),s.cc(20,"div",16),s.Jc(21,g,3,0,"div",17),s.Jc(22,_,11,9,"div",18),s.bc(),s.Jc(23,k,3,4,"div",19),s.bc(),s.bc(),s.bc()),2&t&&(s.Kb(5),s.Nc("Driver Listing ",c.buyer,""),s.Kb(7),s.sc("search",c.search),s.Kb(9),s.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),s.Kb(1),s.sc("ngIf",c.totalCount&&!c.isLoading))},directives:[f.a,h.m,m.a,h.l,v.a,p.j,p.l],styles:[""]}),t}()},pr82:function(t,c,e){"use strict";e.d(c,"a",(function(){return s}));var i=e("tk/3"),r=e("AytR"),n=e("fXoL"),s=function(){var t=function(){function t(c){_classCallCheck(this,t),this.http=c,this.baseUrl=r.a.baseUrl}return _createClass(t,[{key:"listPending",value:function(t,c,e,r){var n=(new i.f).set("_page",t).set("_limit",c);return""!==e&&(""===r&&(r="asc"),n=n.append("sort","".concat(e,":").concat(r))),this.http.get(this.baseUrl+"/api/assign/buyers",{params:n,observe:"response"})}},{key:"searchPending",value:function(t,c,e,r,n){var s=(new i.f).set("_page",t).set("_limit",c);return""!==e&&(""===r&&(r="asc"),s=s.append("sort","".concat(e,":").concat(r))),this.http.post(this.baseUrl+"/api/assign/buyers",{keyword:n},{params:s,observe:"response"})}},{key:"listActive",value:function(t,c,e,r,n){var s=(new i.f).set("_page",c).set("_limit",e);return""!==r&&(""===n&&(n="asc"),s=s.append("sort","".concat(r,":").concat(n))),this.http.get("".concat(this.baseUrl,"/api/assigned/buyers/").concat(t),{params:s,observe:"response"})}},{key:"searchActive",value:function(t,c,e,r,n,s){var a=(new i.f).set("_page",c).set("_limit",e);return""!==r&&(""===n&&(n="asc"),a=a.append("sort","".concat(r,":").concat(n))),this.http.post("".concat(this.baseUrl,"/api/assigned/buyers/").concat(t),{keyword:s},{params:a,observe:"response"})}},{key:"assign",value:function(t){return this.http.post(this.baseUrl+"/api/assigned/buyer",t)}},{key:"remove",value:function(t){return this.http.post(this.baseUrl+"/api/assigned/buyer/delete",t)}}]),t}();return t.\u0275fac=function(c){return new(c||t)(n.gc(i.b))},t.\u0275prov=n.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},wWB1:function(t,c,e){"use strict";e.d(c,"a",(function(){return g}));var i=e("3Pt+"),r=e("LvDl"),n=e.n(r),s=e("fwOm"),a=e("fXoL"),o=e("tyNb"),u=e("kny6"),l=e("5eHb"),d=e("ofXK"),b=["uploader"];function f(t,c){1&t&&(a.cc(0,"small",29),a.Lc(1," Name is required "),a.bc())}function h(t,c){1&t&&(a.cc(0,"small",29),a.Lc(1," ID No. is required "),a.bc())}function m(t,c){if(1&t){var e=a.dc();a.cc(0,"div",10),a.cc(1,"div",17),a.cc(2,"div",8),a.cc(3,"div",30),a.cc(4,"div",31),a.cc(5,"button",32),a.kc("click",(function(){a.Dc(e),a.mc();var t=a.Bc(36);return a.mc().onRemoveFile(t)})),a.Xb(6,"i",33),a.bc(),a.bc(),a.bc(),a.cc(7,"div",9),a.Xb(8,"img",34),a.bc(),a.bc(),a.bc(),a.bc()}if(2&t){var i=a.mc(2);a.Kb(8),a.sc("src",i.imgURL,a.Fc)}}var v=function(t){return{"is-invalid":t}};function p(t,c){if(1&t){var e=a.dc();a.cc(0,"div",1),a.cc(1,"form",7),a.kc("ngSubmit",(function(){return a.Dc(e),a.mc().onSubmit()})),a.cc(2,"div",8),a.cc(3,"div",9),a.cc(4,"div",10),a.cc(5,"label",11),a.Lc(6,"Name\xa0"),a.cc(7,"span",12),a.Lc(8,"*"),a.bc(),a.bc(),a.cc(9,"div",13),a.Xb(10,"input",14),a.Jc(11,f,2,0,"small",15),a.bc(),a.bc(),a.cc(12,"div",10),a.cc(13,"label",11),a.Lc(14,"ID No.\xa0"),a.cc(15,"span",12),a.Lc(16,"*"),a.bc(),a.bc(),a.cc(17,"div",13),a.Xb(18,"input",16),a.Jc(19,h,2,0,"small",15),a.bc(),a.bc(),a.cc(20,"div",10),a.cc(21,"div",17),a.cc(22,"button",18),a.kc("click",(function(){return a.Dc(e),a.Bc(36).click()})),a.Xb(23,"i",19),a.Lc(24," Add License"),a.bc(),a.cc(25,"span",20),a.Lc(26,"Max file size is 5 MB"),a.bc(),a.bc(),a.bc(),a.Jc(27,m,9,1,"div",21),a.bc(),a.cc(28,"div",22),a.cc(29,"button",23),a.kc("click",(function(){return a.Dc(e),a.mc().onBack()})),a.Xb(30,"i",24),a.Lc(31," Back"),a.bc(),a.cc(32,"button",25),a.Xb(33,"i",26),a.Lc(34," Save"),a.bc(),a.bc(),a.bc(),a.cc(35,"input",27,28),a.kc("change",(function(){a.Dc(e);var t=a.Bc(36);return a.mc().uploadFile(t.files)})),a.bc(),a.bc(),a.bc()}if(2&t){var i=a.mc();a.Kb(1),a.sc("formGroup",i.mform),a.Kb(9),a.sc("ngClass",a.vc(6,v,i.invalid("name"))),a.Kb(1),a.sc("ngIf",i.invalid("name")&&i.f.name.hasError("required")),a.Kb(7),a.sc("ngClass",a.vc(8,v,i.invalid("id_num"))),a.Kb(1),a.sc("ngIf",i.invalid("id_num")&&i.f.id_num.hasError("required")),a.Kb(8),a.sc("ngIf",i.imgURL)}}var g=function(){var t=function(t){_inherits(e,t);var c=_createSuper(e);function e(t,i,r,n,s){var a;return _classCallCheck(this,e),(a=c.call(this)).fb=t,a.route=i,a.router=r,a.driverService=n,a.toastr=s,a.isLoading=!1,a.data={id:""},a.imgId=0,a.isEdit=!1,a.createForm(),a}return _createClass(e,[{key:"ngOnInit",value:function(){var t=this;this.route.paramMap.subscribe((function(c){t.id=c.get("id"),t.buyer_id=c.get("buyer_id"),n.a.isNull(t.id)||(t.isEdit=!0),t.load()}))}},{key:"createForm",value:function(){this.mform=this.fb.group({name:["",[i.p.required]],id_num:["",[i.p.required]]})}},{key:"setForm",value:function(){var t=this.data;this.mform.patchValue({name:t.name,id_num:t.id_num})}},{key:"setLicense",value:function(){var t=this.data;t.license&&(this.imgId=t.license.id,this.imgURL=t.license.img)}},{key:"load",value:function(){var t=this;n.a.isNull(this.id)||n.a.isUndefined(this.id)||(this.isLoading=!0,this.driverService.edit(this.buyer_id,this.id).subscribe((function(c){t.data=c,t.setForm(),t.setLicense()}),(function(t){}),(function(){t.isLoading=!1})))}},{key:"uploadFile",value:function(t){var c=this;if(0!==t.length)if(null!=t[0].type.match(/image\/*/)){this.file=t[0];var e=new FileReader;e.readAsDataURL(t[0]),e.onload=function(t){c.imgURL=e.result}}else this.toastr.error("Only images are supported")}},{key:"onRemoveFile",value:function(t){this.imgURL=null,this.file=null,t.value=""}},{key:"onBack",value:function(){this.router.navigate(["/ams/setup/buyer/driver/".concat(this.buyer_id,"/list")])}},{key:"onSubmit",value:function(){var t=this;if(this.mform.invalid)this.mform.markAllAsTouched();else if(this.file||this.isEdit)if(this.file||0!==this.imgId||!this.isEdit){var c=this.mform.value,e=new FormData;this.file&&e.append("file",this.file),e.append("name",c.name),e.append("id_num",c.id_num),e.append("buyer_id",this.buyer_id),this.isEdit?this.driverService.update(this.buyer_id,this.data.id,e).subscribe((function(c){t.toastr.success("Driver successfully updated")})):this.driverService.create(this.buyer_id,e).subscribe((function(c){t.toastr.success("New Driver successfully created"),t.mform.reset(),t.onRemoveFile(t.uploader.nativeElement)}))}else this.toastr.error("Please upload driving license");else this.toastr.error("Please upload driving license")}}]),e}(s.a);return t.\u0275fac=function(c){return new(c||t)(a.Wb(i.c),a.Wb(o.a),a.Wb(o.g),a.Wb(u.a),a.Wb(l.b))},t.\u0275cmp=a.Qb({type:t,selectors:[["app-driver-create"]],viewQuery:function(t,c){var e;1&t&&a.Sc(b,!0),2&t&&a.Ac(e=a.lc())&&(c.uploader=e.first)},features:[a.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","ID No.","name","id_num","formControlName","id_num",1,"form-control",3,"ngClass"],[1,"col-sm-4","offset-sm-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-file"],[1,"badge","badge-info","ml-2"],["class","form-group row",4,"ngIf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],["hidden","","type","file","accept","image/*",3,"change"],["uploader",""],[1,"badge","badge-danger"],[1,"card-header","border-bottom-0"],[1,"card-tools"],["type","button",1,"btn","btn-tool",3,"click"],[1,"fas","fa-times"],[1,"img-fluid","mx-auto","d-block",3,"src"]],template:function(t,c){1&t&&(a.cc(0,"section",0),a.cc(1,"div",1),a.cc(2,"div",2),a.cc(3,"div",3),a.cc(4,"h1",4),a.Lc(5,"Add / Edit Driver"),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(6,"section",5),a.Jc(7,p,37,10,"div",6),a.bc()),2&t&&(a.Kb(7),a.sc("ngIf",!c.isLoading))},directives:[d.m,i.q,i.k,i.e,i.a,i.j,i.d,d.k],styles:[""]}),t}()}}]);