(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"4gke":function(c,t,e){"use strict";e.r(t),e.d(t,"MiningCompanyModule",(function(){return xt}));var i=e("ofXK"),r=e("3Pt+"),s=e("ZOsW"),n=e("LqlI"),a=e("ienR"),o=e("6No5"),d=e("fXoL");const l=new d.w("WindowToken","undefined"!=typeof window&&window.document?{providedIn:"root",factory:()=>window}:void 0);var b=e("XNiG");let u=(()=>{let c=class{constructor(c,t){this.document=c,this.window=t,this.copySubject=new b.a,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(c){this.config=c}copy(c){if(!this.isSupported||!c)return this.pushCopyResponse({isSuccess:!1,content:c});const t=this.copyFromContent(c);return this.pushCopyResponse(t?{content:c,isSuccess:t}:{isSuccess:!1,content:c})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(c){if(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement){if(c.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(c,t=!0){try{this.selectTarget(c);const e=this.copyText();return this.clearSelection(t?c:void 0,this.window),e&&this.isCopySuccessInIE11()}catch(e){return!1}}isCopySuccessInIE11(){const c=this.window.clipboardData;return!(c&&c.getData&&!c.getData("Text"))}copyFromContent(c,t=this.document.body){if(this.tempTextArea&&!t.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{t.appendChild(this.tempTextArea)}catch(i){throw new Error("Container should be a Dom element")}}this.tempTextArea.value=c;const e=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),e}destroy(c=this.document.body){this.tempTextArea&&(c.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(c){return c.select(),c.setSelectionRange(0,c.value.length),c.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(c,t){var e;c&&c.focus(),null===(e=t.getSelection())||void 0===e||e.removeAllRanges()}createTempTextArea(c,t){const e="rtl"===c.documentElement.getAttribute("dir");let i;return i=c.createElement("textarea"),i.style.fontSize="12pt",i.style.border="0",i.style.padding="0",i.style.margin="0",i.style.position="absolute",i.style[e?"right":"left"]="-9999px",i.style.top=(t.pageYOffset||c.documentElement.scrollTop)+"px",i.setAttribute("readonly",""),i}pushCopyResponse(c){this.copySubject.next(c)}pushCopyReponse(c){this.pushCopyResponse(c)}};return c.\u0275fac=function(t){return new(t||c)(d.gc(i.d),d.gc(l,8))},c.\u0275prov=Object(d.Sb)({factory:function(){return new c(Object(d.gc)(i.d),Object(d.gc)(l,8))},token:c,providedIn:"root"}),c})(),m=(()=>{let c=class{constructor(c){this.clipboardSrv=c,this.cbOnSuccess=new d.q,this.cbOnError=new d.q}ngOnInit(){}ngOnDestroy(){this.clipboardSrv.destroy(this.container)}onClick(c){this.clipboardSrv.isSupported?this.targetElm&&this.clipboardSrv.isTargetValid(this.targetElm)?this.handleResult(this.clipboardSrv.copyFromInputElement(this.targetElm),this.targetElm.value,c):this.cbContent&&this.handleResult(this.clipboardSrv.copyFromContent(this.cbContent,this.container),this.cbContent,c):this.handleResult(!1,void 0,c)}handleResult(c,t,e){let i={isSuccess:c,event:e};c?(i=Object.assign(i,{content:t,successMessage:this.cbSuccessMsg}),this.cbOnSuccess.emit(i)):this.cbOnError.emit(i),this.clipboardSrv.pushCopyResponse(i)}};return c.\u0275fac=function(t){return new(t||c)(d.Wb(u))},c.\u0275dir=d.Rb({type:c,selectors:[["","ngxClipboard",""]],hostBindings:function(c,t){1&c&&d.kc("click",(function(c){return t.onClick(c.target)}))},inputs:{targetElm:["ngxClipboard","targetElm"],container:"container",cbContent:"cbContent",cbSuccessMsg:"cbSuccessMsg"},outputs:{cbOnSuccess:"cbOnSuccess",cbOnError:"cbOnError"}}),c})(),p=(()=>{let c=class{};return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},imports:[[i.c]]}),c})();var h=e("tyNb"),_=e("LvDl"),v=e.n(_),f=e("g/JT"),g=e("fwOm"),y=e("wgH9"),L=e("IYfF"),k=e("a+IK"),C=e("5eHb");function S(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Name is required "),d.bc())}function K(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Business Registration No. is required "),d.bc())}function N(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Mining License No. is required "),d.bc())}function E(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Contact No. is required "),d.bc())}function I(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Address 1 is required "),d.bc())}function M(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Postcode is required "),d.bc())}function A(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," City is required "),d.bc())}function w(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," State is required "),d.bc())}function D(c,t){1&c&&(d.cc(0,"small",42),d.Lc(1," Country is required "),d.bc())}const O=function(c){return{"is-invalid":c}},x=function(){return{containerClass:"theme-blue",dateInputFormat:"YYYY-MM-DD"}};function P(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"form",7),d.kc("ngSubmit",(function(){return d.Dc(c),d.mc().onSubmit()})),d.cc(2,"div",8),d.cc(3,"div",9),d.cc(4,"div",10),d.cc(5,"label",11),d.Lc(6,"Name\xa0"),d.cc(7,"span",12),d.Lc(8,"*"),d.bc(),d.bc(),d.cc(9,"div",13),d.Xb(10,"input",14),d.Jc(11,S,2,0,"small",15),d.bc(),d.bc(),d.cc(12,"div",10),d.cc(13,"label",11),d.Lc(14,"Business Registration No.\xa0"),d.cc(15,"span",12),d.Lc(16,"*"),d.bc(),d.bc(),d.cc(17,"div",13),d.Xb(18,"input",16),d.Jc(19,K,2,0,"small",15),d.bc(),d.bc(),d.cc(20,"div",10),d.cc(21,"label",11),d.Lc(22,"Mining License No.\xa0"),d.cc(23,"span",12),d.Lc(24,"*"),d.bc(),d.bc(),d.cc(25,"div",13),d.Xb(26,"input",17),d.Jc(27,N,2,0,"small",15),d.bc(),d.bc(),d.cc(28,"div",10),d.cc(29,"label",11),d.Lc(30,"License Expiry\xa0"),d.cc(31,"span",12),d.Lc(32,"*"),d.bc(),d.bc(),d.cc(33,"div",18),d.cc(34,"div",19),d.Xb(35,"input",20,21),d.cc(37,"div",22),d.cc(38,"button",23),d.kc("click",(function(){return d.Dc(c),d.Bc(36).show()})),d.Xb(39,"i",24),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(40,"div",10),d.cc(41,"label",11),d.Lc(42,"Contact No.\xa0"),d.cc(43,"span",12),d.Lc(44,"*"),d.bc(),d.bc(),d.cc(45,"div",13),d.Xb(46,"input",25),d.Jc(47,E,2,0,"small",15),d.bc(),d.bc(),d.cc(48,"div",10),d.cc(49,"label",11),d.Lc(50,"Email"),d.bc(),d.cc(51,"div",13),d.Xb(52,"input",26),d.bc(),d.bc(),d.cc(53,"div",10),d.cc(54,"label",11),d.Lc(55,"Fax No."),d.bc(),d.cc(56,"div",13),d.Xb(57,"input",27),d.bc(),d.bc(),d.cc(58,"div",10),d.cc(59,"label",11),d.Lc(60,"Address\xa0"),d.cc(61,"span",12),d.Lc(62,"*"),d.bc(),d.bc(),d.cc(63,"div",13),d.Xb(64,"input",28),d.Jc(65,I,2,0,"small",15),d.bc(),d.bc(),d.cc(66,"div",10),d.cc(67,"div",29),d.Xb(68,"input",30),d.bc(),d.bc(),d.cc(69,"div",10),d.cc(70,"div",29),d.Xb(71,"input",31),d.bc(),d.bc(),d.cc(72,"div",10),d.cc(73,"label",11),d.Lc(74,"Postcode\xa0"),d.cc(75,"span",12),d.Lc(76,"*"),d.bc(),d.bc(),d.cc(77,"div",32),d.Xb(78,"input",33),d.Jc(79,M,2,0,"small",15),d.bc(),d.cc(80,"label",34),d.Lc(81,"City\xa0"),d.cc(82,"span",12),d.Lc(83,"*"),d.bc(),d.bc(),d.cc(84,"div",35),d.Xb(85,"input",36),d.Jc(86,A,2,0,"small",15),d.bc(),d.bc(),d.cc(87,"div",10),d.cc(88,"label",11),d.Lc(89,"State\xa0"),d.cc(90,"span",12),d.Lc(91,"*"),d.bc(),d.bc(),d.cc(92,"div",32),d.Xb(93,"ng-select",37),d.Jc(94,w,2,0,"small",15),d.bc(),d.cc(95,"label",34),d.Lc(96,"Country\xa0"),d.cc(97,"span",12),d.Lc(98,"*"),d.bc(),d.bc(),d.cc(99,"div",35),d.cc(100,"ng-select",38),d.kc("change",(function(t){return d.Dc(c),d.mc().onChangeCountry(t)})),d.bc(),d.Jc(101,D,2,0,"small",15),d.bc(),d.bc(),d.bc(),d.cc(102,"div",39),d.cc(103,"button",40),d.Xb(104,"i",41),d.Lc(105," Save"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.Bc(36),t=d.mc();d.Kb(1),d.sc("formGroup",t.mform),d.Kb(9),d.sc("ngClass",d.vc(23,O,t.invalid("name"))),d.Kb(1),d.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(25,O,t.invalid("registration_num"))),d.Kb(1),d.sc("ngIf",t.invalid("registration_num")&&t.f.registration_num.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(27,O,t.invalid("registration_num"))),d.Kb(1),d.sc("ngIf",t.invalid("mining_license_num")&&t.f.mining_license_num.hasError("required")),d.Kb(8),d.sc("bsConfig",d.uc(29,x)),d.Kb(3),d.Lb("aria-expanded",c.isOpen),d.Kb(8),d.sc("ngClass",d.vc(30,O,t.invalid("contact_no"))),d.Kb(1),d.sc("ngIf",t.invalid("contact_no")&&t.f.contact_no.hasError("required")),d.Kb(17),d.sc("ngClass",d.vc(32,O,t.invalid("addr_line_1"))),d.Kb(1),d.sc("ngIf",t.invalid("addr_line_1")&&t.f.addr_line_1.hasError("required")),d.Kb(3),d.sc("ngClass",d.vc(34,O,t.invalid("addr_line_2"))),d.Kb(3),d.sc("ngClass",d.vc(36,O,t.invalid("addr_line_3"))),d.Kb(7),d.sc("ngClass",d.vc(38,O,t.invalid("postcode"))),d.Kb(1),d.sc("ngIf",t.invalid("postcode")&&t.f.postcode.hasError("required")),d.Kb(6),d.sc("ngClass",d.vc(40,O,t.invalid("city"))),d.Kb(1),d.sc("ngIf",t.invalid("city")&&t.f.city.hasError("required")),d.Kb(7),d.sc("items",t.stateList),d.Kb(1),d.sc("ngIf",t.invalid("state_id")&&t.f.state_id.hasError("required")),d.Kb(6),d.sc("items",t.countryList),d.Kb(1),d.sc("ngIf",t.invalid("country_id")&&t.f.country_id.hasError("required"))}}let T=(()=>{class c extends g.a{constructor(c,t,e,i,r){super(),this.fb=c,this.lookupService=t,this.authService=e,this.miningCompanyService=i,this.toastr=r,this.isLoading=!1,this.data={id:""},this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){const c=this.authService.loadUser();this.id=c.mining_company_id,this.load()}createForm(){this.mform=this.fb.group({name:["",[r.p.required]],registration_num:["",[r.p.required]],mining_license_num:["",[r.p.required]],mining_license_expiry_date:[null,[r.p.required]],contact_no:["",[r.p.required]],email:[""],fax_no:[""],addr_line_1:["",[r.p.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[r.p.required]],city:["",[r.p.required]],state_id:[null,[r.p.required]],country_id:[null,[r.p.required]]})}setForm(){const c=this.data;this.mform.patchValue({name:c.name,registration_num:c.registration_num,mining_license_num:c.mining_license_num,mining_license_expiry_date:c.mining_license_expiry_date,contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,country_id:c.country.id}),this.lookupService.listStates(c.country.id).subscribe(t=>{this.stateList=t,this.mform.patchValue({state_id:c.state.id})})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(c=>{this.countryList=c,this.loadDetails()},c=>{this.isLoading=!1})}loadDetails(){v.a.isNull(this.id)||v.a.isUndefined(this.id)?this.isLoading=!1:this.miningCompanyService.edit(this.id).subscribe(c=>{this.data=c,this.setForm()},c=>{},()=>{this.isLoading=!1})}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const c=this.mform.value,t={name:c.name,registration_num:c.registration_num,mining_license_num:c.mining_license_num,mining_license_expiry_date:f.a.toDateStr(c.mining_license_expiry_date),contact_no:c.contact_no,email:c.email,fax_no:c.fax_no,addr_line_1:c.addr_line_1,addr_line_2:c.addr_line_2,addr_line_3:c.addr_line_3,postcode:c.postcode,city:c.city,state_id:c.state_id,country_id:c.country_id};this.miningCompanyService.update(this.data.id,t).subscribe(c=>{this.toastr.success("Mining Company successfully updated")})}onChangeCountry(c){this.lookupService.listStates(c.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({state_id:null})})}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(y.a),d.Wb(L.a),d.Wb(k.a),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-company-details"]],features:[d.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Mining License No.","name","mining_license_num","formControlName","mining_license_num",1,"form-control",3,"ngClass"],[1,"col-sm-2","col-12"],[1,"input-group","date"],["type","text","placeholder","License Expiry","name","mining_license_expiry_date","formControlName","mining_license_expiry_date","bsDatepicker","",1,"form-control",3,"bsConfig"],["dp1","bsDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-default",3,"click"],[1,"fas","fa-calendar-alt"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control",3,"ngClass"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control",3,"ngClass"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Company Details"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.Jc(7,P,106,42,"div",6),d.bc()),2&c&&(d.Kb(7),d.sc("ngIf",!t.isLoading))},directives:[i.m,r.q,r.k,r.e,r.a,r.j,r.d,i.k,a.b,a.a,s.a],styles:[""]}),c})();var q=e("C7yL");function R(c,t){1&c&&(d.cc(0,"small",17),d.Lc(1," Weight is required "),d.bc())}function X(c,t){1&c&&(d.cc(0,"small",17),d.Lc(1," Weight is invalid "),d.bc())}const F=function(c){return{"is-invalid":c}};let J=(()=>{class c extends g.a{constructor(c,t){super(),this.fb=c,this.bsModalRef=t,this.createForm()}ngOnInit(){this.onClose=new b.a,this.mform.patchValue({weight:this.weight})}createForm(){this.mform=this.fb.group({weight:["",[r.p.required]]})}onYes(){this.mform.invalid?this.mform.markAllAsTouched():(this.onClose.next({result:!0,weight:this.mform.value.weight}),this.bsModalRef.hide())}onHide(){this.onClose.next({result:!1}),this.bsModalRef.hide()}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(n.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-checkout-modal"]],features:[d.Hb],decls:25,vars:8,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-horizontal",3,"formGroup"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"text-danger"],[1,"col-sm-7"],["type","text","placeholder","Actual Weight (tons)","name","weight","formControlName","weight",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],[1,"col-sm-1","col-form-label"],[1,"modal-footer"],["type","button",1,"btn","btn-success","mr-2","pl-4","pr-4",3,"click"],["type","button",1,"btn","btn-default","pl-4","pr-4",3,"click"],[1,"badge","badge-danger"]],template:function(c,t){1&c&&(d.cc(0,"div",0),d.cc(1,"div",1),d.cc(2,"h4",2),d.Lc(3),d.bc(),d.cc(4,"button",3),d.kc("click",(function(){return t.bsModalRef.hide()})),d.cc(5,"span",4),d.Lc(6,"\xd7"),d.bc(),d.bc(),d.bc(),d.cc(7,"div",5),d.cc(8,"form",6),d.cc(9,"div",7),d.cc(10,"label",8),d.Lc(11,"Weight\xa0"),d.cc(12,"span",9),d.Lc(13,"*"),d.bc(),d.bc(),d.cc(14,"div",10),d.Xb(15,"input",11),d.Jc(16,R,2,0,"small",12),d.Jc(17,X,2,0,"small",12),d.bc(),d.cc(18,"label",13),d.Lc(19,"tons"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(20,"div",14),d.cc(21,"button",15),d.kc("click",(function(){return t.onYes()})),d.Lc(22),d.bc(),d.cc(23,"button",16),d.kc("click",(function(){return t.onHide()})),d.Lc(24,"Cancel"),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(3),d.Mc(t.title),d.Kb(5),d.sc("formGroup",t.mform),d.Kb(7),d.sc("ngClass",d.vc(6,F,t.invalid("weight"))),d.Kb(1),d.sc("ngIf",t.invalid("weight")&&t.f.weight.hasError("required")),d.Kb(1),d.sc("ngIf",t.invalid("weight")&&t.f.weight.hasError("pattern")),d.Kb(5),d.Mc(t.btnYesText))},directives:[r.q,r.k,r.e,r.a,r.j,r.d,i.k,i.m],styles:[""]}),c})();var B=e("vVtw"),W=e("QLLi"),U=e("OpGx"),$=e("C4D8");function V(c,t){1&c&&(d.cc(0,"div",21),d.cc(1,"h4"),d.Lc(2,"No records found"),d.bc(),d.bc())}function G(c,t){if(1&c){const c=d.dc();d.cc(0,"button",29),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onEdit(t)})),d.Xb(1,"i",30),d.bc()}}function j(c,t){if(1&c){const c=d.dc();d.cc(0,"button",29),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onView(t)})),d.Xb(1,"i",31),d.bc()}}function H(c,t){if(1&c){const c=d.dc();d.cc(0,"button",29),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onCheckIn(t)})),d.Lc(1,"Check In"),d.bc()}}function Z(c,t){if(1&c){const c=d.dc();d.cc(0,"button",29),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onCheckOut(t)})),d.Lc(1,"Check Out"),d.bc()}}function Q(c,t){if(1&c){const c=d.dc();d.cc(0,"button",32),d.kc("click",(function(){d.Dc(c);const t=d.mc().$implicit;return d.mc(2).onPermit(t)})),d.Lc(1,"Permit"),d.bc()}}function Y(c,t){if(1&c&&(d.cc(0,"tr"),d.cc(1,"td"),d.Lc(2),d.bc(),d.cc(3,"td"),d.Lc(4),d.nc(5,"date"),d.bc(),d.cc(6,"td"),d.Lc(7),d.bc(),d.cc(8,"td"),d.Lc(9),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.Lc(13),d.bc(),d.cc(14,"td"),d.Lc(15),d.bc(),d.cc(16,"td"),d.Lc(17),d.nc(18,"date"),d.bc(),d.cc(19,"td"),d.Lc(20),d.nc(21,"date"),d.bc(),d.cc(22,"td",26),d.Jc(23,G,2,0,"button",27),d.Jc(24,j,2,0,"button",27),d.Jc(25,H,2,0,"button",27),d.Jc(26,Z,2,0,"button",27),d.Jc(27,Q,2,0,"button",28),d.bc(),d.bc()),2&c){const c=t.$implicit,e=d.mc(2);d.Kb(2),d.Mc(c.do_num),d.Kb(2),d.Mc(d.pc(5,16,c.created_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Pc("",c.material.name," (",c.material.material_type,") - ",c.material.grade,""),d.Kb(2),d.Mc(c.truck.registration_num),d.Kb(2),d.Mc(c.driver.name),d.Kb(2),d.Mc(c.driver.id_num),d.Kb(2),d.Mc(e.getDOStatus(c)),d.Kb(2),d.Mc(d.pc(18,19,c.checkin_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Mc(d.pc(21,22,c.checkout_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.sc("ngIf",c.status===e.DOStatus.NEW),d.Kb(1),d.sc("ngIf",c.status!==e.DOStatus.NEW),d.Kb(1),d.sc("ngIf",!c.checkin_date),d.Kb(1),d.sc("ngIf",!c.checkout_date&&c.checkin_date),d.Kb(1),d.sc("ngIf",null!==c.permit)}}function z(c,t){if(1&c){const c=d.dc();d.cc(0,"div",22),d.cc(1,"table",23),d.cc(2,"thead"),d.cc(3,"tr"),d.cc(4,"th"),d.cc(5,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(6,"th"),d.cc(7,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(8,"th"),d.cc(9,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(10,"th"),d.cc(11,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(12,"th"),d.cc(13,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(14,"th"),d.cc(15,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(16,"th"),d.Lc(17,"Status"),d.bc(),d.cc(18,"th"),d.cc(19,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(20,"th"),d.cc(21,"app-sort-column",24),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.Xb(22,"th"),d.bc(),d.bc(),d.cc(23,"tbody"),d.Jc(24,Y,28,25,"tr",25),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(5),d.sc("name","DO No.")("sort","do_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","DO Created Date")("sort","created_date")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Material")("sort","material__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Truck")("sort","truck__registration_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Driver")("sort","driver__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","I/C No.")("sort","driver__id_num")("dir",c.sortDir)("current",c.sort),d.Kb(4),d.sc("name","Check In Time")("sort","checkin_date")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Check Out Time")("sort","checkout_date")("dir",c.sortDir)("current",c.sort),d.Kb(3),d.sc("ngForOf",c.list)}}function cc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",33),d.cc(1,"div",34),d.cc(2,"pagination",35),d.kc("ngModelChange",(function(t){return d.Dc(c),d.mc().page=t}))("pageChanged",(function(t){return d.Dc(c),d.mc().pageChanged(t)})),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.sc("totalItems",c.totalCount)("itemsPerPage",c.pageSize)("maxSize",c.MAX_PAGE_NUMBERS)("ngModel",c.page)}}let tc=(()=>{class c{constructor(c,t,e,i,r,s,n){this.route=c,this.router=t,this.authService=e,this.deliveryOrderService=i,this.msService=r,this.toastr=s,this.modalService=n,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=q.a.PAGE_SIZE,this.page=1,this.search="",this.do_status=["all"],this.isRoleMiningHQ=!1,this.sort="created_date",this.sortDir="desc",this.sx=0,this.sy=0,this.doStatusList=[{id:"all",name:"ALL"},{id:"0",name:"NEW"},{id:"1",name:"IN PROGRESS"},{id:"2",name:"DISPATCHING"},{id:"3",name:"RECEIVED"}],this.uiState="mining-company.delivery-order-listing",this.isEmpty=f.a.isEmpty,this.PAGE_SIZE=q.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=q.a.MAX_PAGE_NUMBERS,this.DOStatus=q.a.DOStatus}ngOnInit(){const c=this.authService.loadUser();this.mining_company_id=c.mining_company_id,this.isRoleMiningHQ=this.authService.hasRole(q.a.ROLE.MINING_HQ),this.isLoading=!0,this.subs=this.msService.get().subscribe(c=>{if(c.name===this.uiState){const t=c.data;this.page=t.page,this.sort=t.sort,this.sortDir=t.dir,this.search=t.search,this.do_status=t.do_status,this.sx=t.sx,this.sy=t.sy}}),this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.deliveryOrderService.list(this.do_status,this.page,q.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(q.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(c){this.search=c,this.isLoading=!0,this.deliveryOrderService.search(this.do_status,this.page,q.a.PAGE_SIZE,this.sort,this.sortDir,c).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(q.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})}pageChanged(c){this.page=c.page,this.load()}onSortBy(c){""===c.sort&&"asc"===c.dir?(this.sort="created_date",this.sortDir="desc"):(this.sort=c.sort,this.sortDir=c.dir),this.load()}onApplyFilter(){this.load()}goto(c){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,do_status:this.do_status,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/mining-company/delivery-order/"+c])}onEdit(c){this.goto("edit/"+c.id)}onView(c){this.goto("detail/"+c.id)}onCheckIn(c){this.bsModalRef=this.modalService.show(J,{initialState:{title:"Check In DO",weight:c.checkin_weight,btnYesText:"Check In"}}),this.bsModalRef.content.onClose.subscribe(t=>{!0===t.result&&(this.isLoading=!0,this.deliveryOrderService.updateTime({id:c.id,checkin:1,weight:t.weight}).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully checked in`),this.load()},c=>{},()=>{this.isLoading=!1}))})}onCheckOut(c){this.bsModalRef=this.modalService.show(J,{initialState:{title:"Check Out DO",weight:c.checkout_weight,btnYesText:"Check Out"}}),this.bsModalRef.content.onClose.subscribe(t=>{!0===t.result&&(this.isLoading=!0,this.deliveryOrderService.updateTime({id:c.id,checkin:0,weight:t.weight}).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully checked out`),this.load()},c=>{},()=>{this.isLoading=!1}))})}onPermit(c){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,do_status:this.do_status,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/mining-company/permit/"+c.permit.id])}onReceived(c){this.isLoading=!0,this.deliveryOrderService.receive(c.id).subscribe(t=>{this.toastr.success(`DO #${c.do_num} successfully received`),this.load()},c=>{},()=>{this.isLoading=!1})}getDOStatus(c){return c.status===q.a.DOStatus.NEW?"NEW":c.status===q.a.DOStatus.IN_PROGRESS?"IN PROGRESS":c.status===q.a.DOStatus.DELIVERING?"DISPATCHING":c.status===q.a.DOStatus.DELIVERED?"RECEIVED":"NEW"}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(h.a),d.Wb(h.g),d.Wb(L.a),d.Wb(B.a),d.Wb(W.a),d.Wb(C.b),d.Wb(n.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-delivery-order-listing"]],decls:25,vars:7,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-4","col-12","p-1"],["bindLabel","name","bindValue","id","placeholder","Please select","name","do_status",3,"ngModel","items","multiple","ngModelChange"],[1,"col-sm-2","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary","mr-2",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button","class","btn btn-sm btn-primary mr-2",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"fas","fa-eye"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Delivery Order Listing"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"div",6),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"app-search-input",10),d.kc("onSearch",(function(c){return t.onSearch(c)})),d.bc(),d.bc(),d.cc(13,"div",11),d.cc(14,"ng-select",12),d.kc("ngModelChange",(function(c){return t.do_status=c})),d.bc(),d.bc(),d.cc(15,"div",13),d.cc(16,"button",14),d.kc("click",(function(){return t.onApplyFilter()})),d.Lc(17,"Apply"),d.bc(),d.cc(18,"button",15),d.kc("click",(function(){return t.goto("create")})),d.Xb(19,"i",16),d.Lc(20," Issue DO"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(21,"div",17),d.Jc(22,V,3,0,"div",18),d.Jc(23,z,25,33,"div",19),d.bc(),d.Jc(24,cc,3,4,"div",20),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(12),d.sc("search",t.search),d.Kb(2),d.sc("ngModel",t.do_status)("items",t.doStatusList)("multiple",!0),d.Kb(8),d.sc("ngIf",t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",!t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",t.totalCount&&!t.isLoading))},directives:[U.a,s.a,r.j,r.l,i.m,$.a,i.l,o.a],pipes:[i.e],styles:[""]}),c})();var ec=e("cp0P"),ic=e("lSWO"),rc=e("kny6");function sc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Buyer is required "),d.bc())}function nc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," PO No. is required "),d.bc())}function ac(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Material is required "),d.bc())}function oc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",54),d.cc(1,"a",55),d.kc("click",(function(){d.Dc(c);const t=d.mc(2),e=d.Bc(9);return t.onViewTruck(e)})),d.Lc(2,"View"),d.bc(),d.bc()}}function dc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Truck is required "),d.bc())}function lc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",54),d.cc(1,"a",55),d.kc("click",(function(){d.Dc(c);const t=d.mc(2),e=d.Bc(11);return t.onViewDriver(e)})),d.Lc(2,"View"),d.bc(),d.bc()}}function bc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Name is required "),d.bc())}function uc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Address is required "),d.bc())}function mc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Postcode is required "),d.bc())}function pc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," City is required "),d.bc())}function hc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," State is required "),d.bc())}function _c(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Country is required "),d.bc())}function vc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Name is required "),d.bc())}function fc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Address is required "),d.bc())}function gc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Postcode is required "),d.bc())}function yc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," City is required "),d.bc())}function Lc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," State is required "),d.bc())}function kc(c,t){1&c&&(d.cc(0,"small",53),d.Lc(1," Country is required "),d.bc())}const Cc=function(c){return{"is-invalid":c}};function Sc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"form",9),d.kc("ngSubmit",(function(){return d.Dc(c),d.mc().onSubmit()})),d.cc(2,"div",10),d.cc(3,"div",11),d.cc(4,"div",12),d.cc(5,"label",13),d.Lc(6,"Buyer\xa0"),d.cc(7,"span",14),d.Lc(8,"*"),d.bc(),d.bc(),d.cc(9,"div",15),d.cc(10,"ng-select",16),d.kc("change",(function(t){return d.Dc(c),d.mc().onChangeBuyer(t)})),d.bc(),d.Jc(11,sc,2,0,"small",17),d.bc(),d.bc(),d.cc(12,"div",12),d.cc(13,"label",13),d.Lc(14,"PO No.\xa0"),d.cc(15,"span",14),d.Lc(16,"*"),d.bc(),d.bc(),d.cc(17,"div",15),d.Xb(18,"input",18),d.Jc(19,nc,2,0,"small",17),d.bc(),d.bc(),d.cc(20,"div",12),d.cc(21,"label",13),d.Lc(22,"Contract No."),d.bc(),d.cc(23,"div",15),d.Xb(24,"input",19),d.bc(),d.bc(),d.cc(25,"div",12),d.cc(26,"label",13),d.Lc(27,"Remarks"),d.bc(),d.cc(28,"div",15),d.Xb(29,"textarea",20),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(30,"div",10),d.cc(31,"div",11),d.cc(32,"div",21),d.cc(33,"div",22),d.cc(34,"div",23),d.cc(35,"label"),d.Lc(36,"Material\xa0"),d.cc(37,"span",14),d.Lc(38,"*"),d.bc(),d.bc(),d.Xb(39,"ng-select",24),d.Jc(40,ac,2,0,"small",17),d.bc(),d.bc(),d.cc(41,"div",22),d.cc(42,"div",23),d.cc(43,"label"),d.Lc(44,"Truck\xa0"),d.cc(45,"span",14),d.Lc(46,"*"),d.bc(),d.bc(),d.Jc(47,oc,3,0,"div",25),d.Xb(48,"ng-select",26),d.Jc(49,dc,2,0,"small",17),d.bc(),d.bc(),d.cc(50,"div",22),d.cc(51,"div",23),d.cc(52,"label"),d.Lc(53,"Driver"),d.bc(),d.Jc(54,lc,3,0,"div",25),d.Xb(55,"ng-select",27),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(56,"div",21),d.cc(57,"div",28),d.cc(58,"div",10),d.cc(59,"div",11),d.cc(60,"fieldset"),d.cc(61,"legend"),d.Lc(62,"Pickup Location"),d.bc(),d.cc(63,"div",12),d.cc(64,"label",13),d.Lc(65,"Name\xa0"),d.cc(66,"span",14),d.Lc(67,"*"),d.bc(),d.bc(),d.cc(68,"div",15),d.Xb(69,"input",29),d.Jc(70,bc,2,0,"small",17),d.bc(),d.bc(),d.cc(71,"div",12),d.cc(72,"label",13),d.Lc(73,"Address\xa0"),d.cc(74,"span",14),d.Lc(75,"*"),d.bc(),d.bc(),d.cc(76,"div",15),d.Xb(77,"input",30),d.Jc(78,uc,2,0,"small",17),d.bc(),d.bc(),d.cc(79,"div",12),d.cc(80,"div",31),d.Xb(81,"input",32),d.bc(),d.bc(),d.cc(82,"div",12),d.cc(83,"div",31),d.Xb(84,"input",33),d.bc(),d.bc(),d.cc(85,"div",12),d.cc(86,"label",13),d.Lc(87,"Postcode\xa0"),d.cc(88,"span",14),d.Lc(89,"*"),d.bc(),d.bc(),d.cc(90,"div",34),d.Xb(91,"input",35),d.Jc(92,mc,2,0,"small",17),d.bc(),d.cc(93,"label",13),d.Lc(94,"City\xa0"),d.cc(95,"span",14),d.Lc(96,"*"),d.bc(),d.bc(),d.cc(97,"div",36),d.Xb(98,"input",37),d.Jc(99,pc,2,0,"small",17),d.bc(),d.bc(),d.cc(100,"div",12),d.cc(101,"label",13),d.Lc(102,"State\xa0"),d.cc(103,"span",14),d.Lc(104,"*"),d.bc(),d.bc(),d.cc(105,"div",34),d.Xb(106,"ng-select",38),d.Jc(107,hc,2,0,"small",17),d.bc(),d.cc(108,"label",13),d.Lc(109,"Country\xa0"),d.cc(110,"span",14),d.Lc(111,"*"),d.bc(),d.bc(),d.cc(112,"div",36),d.cc(113,"ng-select",39),d.kc("change",(function(t){return d.Dc(c),d.mc().onChangePickupCountry(t)})),d.bc(),d.Jc(114,_c,2,0,"small",17),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(115,"div",28),d.cc(116,"div",10),d.cc(117,"div",11),d.cc(118,"fieldset"),d.cc(119,"legend"),d.Lc(120,"Receiver Details"),d.bc(),d.cc(121,"div",12),d.cc(122,"label",13),d.Lc(123,"Name\xa0"),d.cc(124,"span",14),d.Lc(125,"*"),d.bc(),d.bc(),d.cc(126,"div",15),d.Xb(127,"input",40),d.Jc(128,vc,2,0,"small",17),d.bc(),d.bc(),d.cc(129,"div",12),d.cc(130,"label",13),d.Lc(131,"Address\xa0"),d.cc(132,"span",14),d.Lc(133,"*"),d.bc(),d.bc(),d.cc(134,"div",15),d.Xb(135,"input",41),d.Jc(136,fc,2,0,"small",17),d.bc(),d.bc(),d.cc(137,"div",12),d.cc(138,"div",31),d.Xb(139,"input",42),d.bc(),d.bc(),d.cc(140,"div",12),d.cc(141,"div",31),d.Xb(142,"input",43),d.bc(),d.bc(),d.cc(143,"div",12),d.cc(144,"label",13),d.Lc(145,"Postcode\xa0"),d.cc(146,"span",14),d.Lc(147,"*"),d.bc(),d.bc(),d.cc(148,"div",34),d.Xb(149,"input",44),d.Jc(150,gc,2,0,"small",17),d.bc(),d.cc(151,"label",13),d.Lc(152,"City\xa0"),d.cc(153,"span",14),d.Lc(154,"*"),d.bc(),d.bc(),d.cc(155,"div",36),d.Xb(156,"input",45),d.Jc(157,yc,2,0,"small",17),d.bc(),d.bc(),d.cc(158,"div",12),d.cc(159,"label",13),d.Lc(160,"State\xa0"),d.cc(161,"span",14),d.Lc(162,"*"),d.bc(),d.bc(),d.cc(163,"div",34),d.Xb(164,"ng-select",46),d.Jc(165,Lc,2,0,"small",17),d.bc(),d.cc(166,"label",13),d.Lc(167,"Country\xa0"),d.cc(168,"span",14),d.Lc(169,"*"),d.bc(),d.bc(),d.cc(170,"div",36),d.cc(171,"ng-select",47),d.kc("change",(function(t){return d.Dc(c),d.mc().onChangeReceiverCountry(t)})),d.bc(),d.Jc(172,kc,2,0,"small",17),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(173,"div",48),d.cc(174,"div",3),d.cc(175,"button",49),d.kc("click",(function(){return d.Dc(c),d.mc().onBack()})),d.Xb(176,"i",50),d.Lc(177," Back"),d.bc(),d.cc(178,"button",51),d.Xb(179,"i",52),d.Lc(180," Submit"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(1),d.sc("formGroup",c.mform),d.Kb(9),d.sc("items",c.buyerList),d.Kb(1),d.sc("ngIf",c.invalid("buyer_id")&&c.f.buyer_id.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(36,Cc,c.invalid("po_num"))),d.Kb(1),d.sc("ngIf",c.invalid("po_num")&&c.f.po_num.hasError("required")),d.Kb(20),d.sc("items",c.materialList),d.Kb(1),d.sc("ngIf",c.invalid("material_id")&&c.f.material_id.hasError("required")),d.Kb(7),d.sc("ngIf",null!==c.f.truck_id.value),d.Kb(1),d.sc("items",c.truckList),d.Kb(1),d.sc("ngIf",c.invalid("truck_id")&&c.f.truck_id.hasError("required")),d.Kb(5),d.sc("ngIf",null!==c.f.driver_id.value),d.Kb(1),d.sc("items",c.driverList),d.Kb(14),d.sc("ngClass",d.vc(38,Cc,c.invalid("pickup_name"))),d.Kb(1),d.sc("ngIf",c.invalid("pickup_name")&&c.f.pickup_name.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(40,Cc,c.invalid("pickup_addr_line_1"))),d.Kb(1),d.sc("ngIf",c.invalid("pickup_addr_line_1")&&c.f.pickup_addr_line_1.hasError("required")),d.Kb(13),d.sc("ngClass",d.vc(42,Cc,c.invalid("pickup_postcode"))),d.Kb(1),d.sc("ngIf",c.invalid("pickup_postcode")&&c.f.pickup_postcode.hasError("required")),d.Kb(6),d.sc("ngClass",d.vc(44,Cc,c.invalid("pickup_city"))),d.Kb(1),d.sc("ngIf",c.invalid("pickup_city")&&c.f.pickup_city.hasError("required")),d.Kb(7),d.sc("items",c.stateList),d.Kb(1),d.sc("ngIf",c.invalid("pickup_state_id")&&c.f.pickup_state_id.hasError("required")),d.Kb(6),d.sc("items",c.countryList),d.Kb(1),d.sc("ngIf",c.invalid("pickup_country_id")&&c.f.pickup_country_id.hasError("required")),d.Kb(13),d.sc("ngClass",d.vc(46,Cc,c.invalid("recv_name"))),d.Kb(1),d.sc("ngIf",c.invalid("recv_name")&&c.f.recv_name.hasError("required")),d.Kb(7),d.sc("ngClass",d.vc(48,Cc,c.invalid("recv_addr_line_1"))),d.Kb(1),d.sc("ngIf",c.invalid("recv_addr_line_1")&&c.f.recv_addr_line_1.hasError("required")),d.Kb(13),d.sc("ngClass",d.vc(50,Cc,c.invalid("recv_postcode"))),d.Kb(1),d.sc("ngIf",c.invalid("recv_postcode")&&c.f.recv_postcode.hasError("required")),d.Kb(6),d.sc("ngClass",d.vc(52,Cc,c.invalid("recv_city"))),d.Kb(1),d.sc("ngIf",c.invalid("recv_city")&&c.f.recv_city.hasError("required")),d.Kb(7),d.sc("items",c.stateList),d.Kb(1),d.sc("ngIf",c.invalid("recv_state_id")&&c.f.recv_state_id.hasError("required")),d.Kb(6),d.sc("items",c.countryList),d.Kb(1),d.sc("ngIf",c.invalid("recv_country_id")&&c.f.recv_country_id.hasError("required"))}}function Kc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",56),d.cc(1,"h4",57),d.Lc(2),d.bc(),d.cc(3,"button",58),d.kc("click",(function(){return d.Dc(c),d.mc().bsModalRef.hide()})),d.cc(4,"span",59),d.Lc(5,"\xd7"),d.bc(),d.bc(),d.bc(),d.cc(6,"div",60),d.cc(7,"div",61),d.Xb(8,"img",62),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.Nc("Truck ",c.truckReg,""),d.Kb(6),d.sc("src",c.truckImg,d.Fc)}}function Nc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",56),d.cc(1,"h4",57),d.Lc(2),d.bc(),d.cc(3,"button",58),d.kc("click",(function(){return d.Dc(c),d.mc().bsModalRef.hide()})),d.cc(4,"span",59),d.Lc(5,"\xd7"),d.bc(),d.bc(),d.bc(),d.cc(6,"div",60),d.cc(7,"div",61),d.Xb(8,"img",62),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.Nc("Driver ",c.driverId,""),d.Kb(6),d.sc("src",c.driverImg,d.Fc)}}let Ec=(()=>{class c extends g.a{constructor(c,t,e,i,r,s,n,a,o,d){super(),this.fb=c,this.route=t,this.router=e,this.authService=i,this.lookupService=r,this.deliveryOrderService=s,this.truckService=n,this.driverService=a,this.toastr=o,this.modalService=d,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.truckImg=null,this.truckReg="",this.driverImg=null,this.driverId="",this.buyerList=[],this.materialList=[],this.truckList=[],this.driverList=[],this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){const c=this.authService.loadUser();this.mining_company_id=c.mining_company_id,this.route.paramMap.subscribe(c=>{this.id=c.get("id"),v.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({po_num:["",[r.p.required]],contract_num:[""],remarks:[""],buyer_id:[null,[r.p.required]],material_id:[null,[r.p.required]],truck_id:[null,[r.p.required]],driver_id:[null],pickup_name:["",[r.p.required]],pickup_addr_line_1:["",[r.p.required]],pickup_addr_line_2:[""],pickup_addr_line_3:[""],pickup_postcode:["",[r.p.required]],pickup_city:["",[r.p.required]],pickup_state_id:[null,[r.p.required]],pickup_country_id:[null,[r.p.required]],recv_name:["",[r.p.required]],recv_addr_line_1:["",[r.p.required]],recv_addr_line_2:[""],recv_addr_line_3:[""],recv_postcode:["",[r.p.required]],recv_city:["",[r.p.required]],recv_state_id:[null,[r.p.required]],recv_country_id:[null,[r.p.required]]})}setForm(){const c=this.data;this.mform.patchValue({po_num:c.po_num,contract_num:c.contract_num,remarks:c.remarks,buyer_id:c.buyer.id,material_id:c.material.id,truck_id:c.truck.id,driver_id:c.driver.id,pickup_name:c.pickup_name,pickup_addr_line_1:c.pickup_addr_line_1,pickup_addr_line_2:c.pickup_addr_line_2,pickup_addr_line_3:c.pickup_addr_line_3,pickup_postcode:c.pickup_postcode,pickup_city:c.pickup_city,pickup_country_id:c.pickup_country.id,recv_name:c.recv_name,recv_addr_line_1:c.recv_addr_line_1,recv_addr_line_2:c.recv_addr_line_2,recv_addr_line_3:c.recv_addr_line_3,recv_postcode:c.recv_postcode,recv_city:c.recv_city,recv_country_id:c.recv_country.id});let t=this.lookupService.listTruck(c.buyer.id),e=this.lookupService.listDriver(c.buyer.id),i=this.lookupService.listStates(c.recv_country.id);Object(ec.a)([t,e,i]).subscribe(t=>{this.truckList=t[0],this.driverList=t[1],this.stateList=t[2],this.driverList=t[1].map(c=>(c.label=`${c.name} - ${c.id_num}`,c)),this.mform.patchValue({truck_id:c.truck.id,driver_id:c.driver.id,pickup_state_id:c.pickup_state.id,recv_state_id:c.recv_state.id})},c=>{},()=>{this.isLoading=!1})}load(){this.isLoading=!0;let c=this.lookupService.listBuyer(),t=this.lookupService.listMaterial(this.mining_company_id),e=this.lookupService.listCountry();Object(ec.a)([c,t,e]).subscribe(c=>{this.buyerList=c[0],this.materialList=c[1],this.countryList=c[2],this.materialList=c[1].map(c=>(c.label=`${c.name} (${c.material_type}) - ${c.grade}`,c)),this.mform.patchValue({pickup_country_id:this.countryList[0].id,recv_country_id:this.countryList[0].id}),this.onChangePickupCountry(this.countryList[0]),this.onChangeReceiverCountry(this.countryList[0]),this.loadDetails()},c=>{this.isLoading=!1})}loadDetails(){v.a.isNull(this.id)||v.a.isUndefined(this.id)?this.isLoading=!1:this.deliveryOrderService.edit(this.id).subscribe(c=>{this.data=c,this.setForm()},c=>{this.isLoading=!1})}onViewTruck(c){const t=this.mform.value;return this.isLoading=!0,this.truckService.edit(t.buyer_id,t.truck_id).subscribe(t=>{t.img?(this.truckReg=t.registration_num,this.truckImg=t.img.img,this.bsModalRef=this.modalService.show(c,{class:"modal-lg"})):this.toastr.info("No image found for this truck")},c=>{},()=>{this.isLoading=!1}),!1}onViewDriver(c){const t=this.mform.value;return this.isLoading=!0,this.driverService.edit(t.buyer_id,t.driver_id).subscribe(t=>{t.license?(this.driverId=t.id_num,this.driverImg=t.license.img,this.bsModalRef=this.modalService.show(c,{class:"modal-lg"})):this.toastr.info("No image found for this driver")},c=>{},()=>{this.isLoading=!1}),!1}onBack(){this.router.navigate(["/ams/mining-company/delivery-order/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const c=this.mform.value,t={po_num:c.po_num,contract_num:c.contract_num,remarks:c.remarks,buyer_id:c.buyer_id,issue_from_id:this.mining_company_id,material_id:c.material_id,truck_id:c.truck_id,driver_id:c.driver_id,pickup_name:c.pickup_name,pickup_addr_line_1:c.pickup_addr_line_1,pickup_addr_line_2:c.pickup_addr_line_2,pickup_addr_line_3:c.pickup_addr_line_3,pickup_postcode:c.pickup_postcode,pickup_city:c.pickup_city,pickup_state_id:c.pickup_state_id,pickup_country_id:c.pickup_country_id,recv_name:c.recv_name,recv_addr_line_1:c.recv_addr_line_1,recv_addr_line_2:c.recv_addr_line_2,recv_addr_line_3:c.recv_addr_line_3,recv_postcode:c.recv_postcode,recv_city:c.recv_city,recv_state_id:c.recv_state_id,recv_country_id:c.recv_country_id};this.isEdit?this.deliveryOrderService.update(this.data.id,t).subscribe(c=>{this.toastr.success("Delivery Order successfully updated")}):this.deliveryOrderService.create(t).subscribe(c=>{this.toastr.success("New Delivery Order successfully created"),this.mform.reset()})}onChangeBuyer(c){let t=this.lookupService.listTruck(c.id),e=this.lookupService.listDriver(c.id);Object(ec.a)([t,e]).subscribe(c=>{this.truckList=c[0],this.driverList=c[1],this.driverList=c[1].map(c=>(c.label=`${c.name} - ${c.id_num}`,c)),this.mform.patchValue({truck_id:null,driver_id:null})})}onChangePickupCountry(c){this.lookupService.listStates(c.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({pickup_state_id:null})})}onChangeReceiverCountry(c){this.lookupService.listStates(c.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({recv_state_id:null})})}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(h.a),d.Wb(h.g),d.Wb(L.a),d.Wb(y.a),d.Wb(B.a),d.Wb(ic.a),d.Wb(rc.a),d.Wb(C.b),d.Wb(n.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-delivery-order-create"]],features:[d.Hb],decls:12,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],["truckIm",""],["driverIm",""],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","buyer_id","name","buyer_id",3,"items","change"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","PO No.","name","po_num","formControlName","po_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Contract No.","name","contract_num","formControlName","contract_num",1,"form-control"],["placeholder","Remarks","name","remarks","formControlName","remarks","rows","3","cols","20",1,"form-control"],[1,"row"],[1,"col-sm-4"],[1,"form-group"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","material_id","name","material_id",3,"items"],["class","d-inline float-right",4,"ngIf"],["bindLabel","registration_num","bindValue","id","placeholder","Please select","formControlName","truck_id","name","truck_id",3,"items"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","driver_id","name","driver_id",3,"items"],[1,"col-sm-6","col-12"],["type","text","placeholder","Name","name","recv_name","formControlName","pickup_name",1,"form-control",3,"ngClass"],["type","text","placeholder","Address","name","pickup_addr_line_1","formControlName","pickup_addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Address 2","name","pickup_addr_line_2","formControlName","pickup_addr_line_2",1,"form-control"],["type","text","placeholder","Address 3","name","pickup_addr_line_3","formControlName","pickup_addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","pickup_postcode","formControlName","pickup_postcode",1,"form-control",3,"ngClass"],[1,"col-sm-5"],["type","text","placeholder","City","name","pickup_city","formControlName","pickup_city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","pickup_state_id","name","recv_state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","name","pickup_country_id","formControlName","pickup_country_id",3,"items","change"],["type","text","placeholder","Name","name","recv_name","formControlName","recv_name",1,"form-control",3,"ngClass"],["type","text","placeholder","Address","name","recv_addr_line_1","formControlName","recv_addr_line_1",1,"form-control",3,"ngClass"],["type","text","placeholder","Address 2","name","recv_addr_line_2","formControlName","recv_addr_line_2",1,"form-control"],["type","text","placeholder","Address 3","name","recv_addr_line_3","formControlName","recv_addr_line_3",1,"form-control"],["type","text","placeholder","Postcode","name","recv_postcode","formControlName","recv_postcode",1,"form-control",3,"ngClass"],["type","text","placeholder","City","name","recv_city","formControlName","recv_city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","recv_state_id","name","recv_state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","name","recv_country_id","formControlName","recv_country_id",3,"items","change"],[1,"row","mb-3"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"],[1,"d-inline","float-right"],["href","#",3,"click"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"text-center"],[1,"img-fluid","rounded",3,"src"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Issue DO"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.Jc(7,Sc,181,54,"div",6),d.bc(),d.Jc(8,Kc,9,2,"ng-template",null,7,d.Kc),d.Jc(10,Nc,9,2,"ng-template",null,8,d.Kc)),2&c&&(d.Kb(7),d.sc("ngIf",!t.isLoading))},directives:[i.m,r.q,r.k,r.e,s.a,r.j,r.d,r.a,i.k],styles:[""]}),c})();var Ic=e("cpHE");const Mc=function(c){return["/permit",c,"print"]};function Ac(c,t){if(1&c){const c=d.dc();d.cc(0,"div",2),d.cc(1,"div",3),d.cc(2,"div",4),d.cc(3,"div"),d.Lc(4,"SALINAN JMG"),d.bc(),d.Xb(5,"img",5),d.bc(),d.cc(6,"div",6),d.cc(7,"div",7),d.Lc(8,"JABATAN MINERAL DAN GEOSAINS MALAYSIA"),d.bc(),d.cc(9,"div",7),d.Lc(10,"AKTA PEMBANGUNAN MINERAL 1994"),d.bc(),d.cc(11,"div",7),d.Lc(12,"PERATURAN-PERATURAN PEMBANGUNAN MINERAL (PELESENAN) 2016"),d.bc(),d.cc(13,"div",8),d.Lc(14,"(SUBPERATURAN 8(2))"),d.bc(),d.bc(),d.cc(15,"div",9),d.cc(16,"div",10),d.cc(17,"span",11),d.Lc(18,"NO. SIRI: "),d.bc(),d.cc(19,"span",12),d.Lc(20),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(21,"div",13),d.cc(22,"div",14),d.Xb(23,"div",15),d.bc(),d.bc(),d.cc(24,"div",3),d.cc(25,"div",14),d.cc(26,"div",16),d.cc(27,"u"),d.Lc(28,"BUTIR-BUTIR PEMEGANG LESEN"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(29,"div",3),d.cc(30,"div",14),d.cc(31,"table",17),d.cc(32,"tbody"),d.cc(33,"tr"),d.cc(34,"td",18),d.Lc(35,"NAMA:"),d.bc(),d.cc(36,"td"),d.cc(37,"div",19),d.Lc(38),d.nc(39,"uppercase"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(40,"div",3),d.cc(41,"div",14),d.cc(42,"table",17),d.cc(43,"tbody"),d.cc(44,"tr"),d.cc(45,"td",18),d.Lc(46,"ALAMAT PREMIS:"),d.bc(),d.cc(47,"td"),d.cc(48,"div",19),d.Lc(49),d.nc(50,"uppercase"),d.bc(),d.bc(),d.bc(),d.cc(51,"tr"),d.cc(52,"td",20),d.cc(53,"div",19),d.Lc(54),d.nc(55,"uppercase"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(56,"div",3),d.cc(57,"div",14),d.cc(58,"table",17),d.cc(59,"tbody"),d.cc(60,"tr"),d.cc(61,"td",18),d.Lc(62,"NO. LESEN MINERAL/MEMPROSES:"),d.bc(),d.cc(63,"td",21),d.cc(64,"div",19),d.Lc(65),d.bc(),d.bc(),d.cc(66,"td",18),d.Lc(67,"TARIKH LUPUT LESEN:"),d.bc(),d.cc(68,"td"),d.cc(69,"div",19),d.Lc(70),d.nc(71,"uppercase"),d.nc(72,"date"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(73,"div",13),d.cc(74,"div",14),d.Xb(75,"div",15),d.bc(),d.bc(),d.cc(76,"div",3),d.cc(77,"div",14),d.cc(78,"div",16),d.cc(79,"u"),d.Lc(80,"BUTIR-BUTIR PENGANGKUTAN MINERAL"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(81,"div",3),d.cc(82,"div",14),d.cc(83,"table",17),d.cc(84,"tbody"),d.cc(85,"tr"),d.cc(86,"td",18),d.Lc(87,"NAMA PEMANDU:"),d.bc(),d.cc(88,"td"),d.cc(89,"div",19),d.Lc(90),d.nc(91,"uppercase"),d.bc(),d.bc(),d.cc(92,"td",18),d.Lc(93,"NO. K.P.:"),d.bc(),d.cc(94,"td"),d.cc(95,"div",19),d.Lc(96),d.nc(97,"uppercase"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(98,"div",3),d.cc(99,"div",14),d.cc(100,"table",17),d.cc(101,"tbody"),d.cc(102,"tr"),d.cc(103,"td",18),d.Lc(104,"NO. KENDERAAN:"),d.bc(),d.cc(105,"td",22),d.cc(106,"div",19),d.Lc(107),d.bc(),d.bc(),d.cc(108,"td",18),d.Lc(109,"DESTINASI:"),d.bc(),d.cc(110,"td"),d.cc(111,"div",19),d.Lc(112),d.nc(113,"uppercase"),d.nc(114,"uppercase"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(115,"div",3),d.cc(116,"div",14),d.cc(117,"table",17),d.cc(118,"tbody"),d.cc(119,"tr"),d.cc(120,"td",18),d.Lc(121,"JENIS MINERAL:"),d.bc(),d.cc(122,"td"),d.cc(123,"div",19),d.Lc(124),d.nc(125,"uppercase"),d.nc(126,"uppercase"),d.nc(127,"uppercase"),d.bc(),d.bc(),d.cc(128,"td",18),d.Lc(129,"BERAT:"),d.bc(),d.cc(130,"td"),d.cc(131,"div",19),d.Lc(132),d.nc(133,"number"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(134,"div",13),d.cc(135,"div",14),d.Xb(136,"div",15),d.bc(),d.bc(),d.cc(137,"div",3),d.cc(138,"div",14),d.cc(139,"div",16),d.cc(140,"u"),d.Lc(141,"AKUAN PENERIMAAN"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(142,"div",3),d.cc(143,"div",14),d.cc(144,"table",17),d.cc(145,"tr"),d.cc(146,"td",18),d.Lc(147,"NAMA DAN ALAMAT PENERIMA:"),d.bc(),d.cc(148,"td"),d.cc(149,"div",19),d.Lc(150),d.nc(151,"uppercase"),d.bc(),d.bc(),d.bc(),d.cc(152,"tr"),d.cc(153,"td",20),d.cc(154,"div",19),d.Lc(155),d.nc(156,"uppercase"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(157,"div",3),d.cc(158,"div",14),d.cc(159,"table",17),d.cc(160,"tr"),d.cc(161,"td",18),d.Lc(162,"TARIKH TERIMA:"),d.bc(),d.cc(163,"td"),d.cc(164,"div",19),d.Lc(165,"\xa0"),d.bc(),d.bc(),d.cc(166,"td",18),d.Lc(167,"TANDATANGAN:"),d.bc(),d.cc(168,"td"),d.cc(169,"div",19),d.Lc(170,"\xa0"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(171,"div",3),d.cc(172,"div",14),d.cc(173,"div",23),d.cc(174,"table",17),d.cc(175,"tbody"),d.cc(176,"tr"),d.cc(177,"td",24),d.cc(178,"div",11),d.Lc(179,"UNTUK KEGUNAAN PEJABAT:"),d.bc(),d.bc(),d.bc(),d.cc(180,"tr"),d.cc(181,"td",18),d.Lc(182,"TARIKH LUPUT:"),d.bc(),d.cc(183,"td"),d.cc(184,"div",19),d.Lc(185,"\xa0"),d.bc(),d.bc(),d.cc(186,"td",22),d.cc(187,"div",19),d.Lc(188,"\xa0"),d.bc(),d.bc(),d.cc(189,"td",18),d.Lc(190,"TARIKH LUPUT:"),d.bc(),d.cc(191,"td"),d.cc(192,"div",19),d.Lc(193,"\xa0"),d.bc(),d.bc(),d.bc(),d.cc(194,"tr"),d.Xb(195,"td",20),d.cc(196,"td",18),d.Lc(197,"PEN. PENGARAH GALIAN"),d.bc(),d.Xb(198,"td",20),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(199,"div",25),d.cc(200,"div",26),d.cc(201,"button",27),d.kc("click",(function(){return d.Dc(c),d.mc().onBack()})),d.Xb(202,"i",28),d.Lc(203," Back"),d.bc(),d.cc(204,"a",29),d.Xb(205,"i",30),d.Lc(206," Print"),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(20),d.Mc(c.data.permit_num),d.Kb(18),d.Mc(d.oc(39,18,c.data.do_master.issue_from.name)),d.Kb(11),d.Mc(d.oc(50,20,c.issueFromAddress1)),d.Kb(5),d.Mc(d.oc(55,22,c.issueFromAddress2)),d.Kb(11),d.Mc(c.data.do_master.issue_from.mining_license_num),d.Kb(5),d.Mc(d.oc(71,24,d.pc(72,26,c.data.do_master.issue_from.mining_license_expiry_date,"d MMM yyyy"))),d.Kb(20),d.Mc(d.oc(91,29,c.data.do_master.driver.name)),d.Kb(6),d.Mc(d.oc(97,31,c.data.do_master.driver.id_num)),d.Kb(11),d.Mc(c.data.do_master.truck.registration_num),d.Kb(5),d.Oc("",d.oc(113,33,c.data.do_master.recv_city)," - ",d.oc(114,35,c.data.do_master.recv_state.name),""),d.Kb(12),d.Pc("",d.oc(125,37,c.data.do_master.material.name),", ",d.oc(126,39,c.data.do_master.material.material_type),", ",d.oc(127,41,c.data.do_master.material.grade),""),d.Kb(8),d.Nc("",d.oc(133,43,c.data.do_master.actual_weight)," tons"),d.Kb(18),d.Mc(d.oc(151,45,c.data.do_master.recv_name)),d.Kb(5),d.Mc(d.oc(156,47,c.destinationAddress)),d.Kb(49),d.sc("routerLink",d.vc(49,Mc,c.id))}}let wc=(()=>{class c{constructor(c,t,e){this.route=c,this.router=t,this.permitService=e,this.isLoading=!1,this.data={id:""}}ngOnInit(){this.route.paramMap.subscribe(c=>{this.id=c.get("id"),this.load()})}load(){v.a.isNull(this.id)||v.a.isUndefined(this.id)?this.isLoading=!1:(this.isLoading=!0,this.permitService.detail(this.id).subscribe(c=>{this.data=c},c=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/mining-company/delivery-order/list"])}get issueFromAddress1(){let c="";if(this.data.do_master&&this.data.do_master.issue_from){const t=this.data.do_master.issue_from;let e=[t.addr_line_1];t.addr_line_2&&e.push(t.addr_line_2),t.addr_line_3&&e.push(t.addr_line_3),c=e.join(", ")}return c}get issueFromAddress2(){let c="";if(this.data.do_master&&this.data.do_master.issue_from){const t=this.data.do_master.issue_from;c=` ${t.postcode} ${t.city} ${t.state.name} ${t.country.name}`}return c}get destinationAddress(){let c="";if(this.data.do_master){const t=this.data.do_master;let e=[t.recv_addr_line_1];t.recv_addr_line_2&&e.push(t.recv_addr_line_2),t.recv_addr_line_3&&e.push(t.recv_addr_line_3),c=e.join(", "),c+=` ${t.recv_postcode} ${t.recv_city} ${t.recv_state.name} ${t.recv_country.name}`}return c}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(h.a),d.Wb(h.g),d.Wb(Ic.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-permit-detail"]],decls:2,vars:1,consts:[[1,"content"],["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-sm-2"],["src","assets/img/jmg.png",1,"img-jmg"],[1,"col-sm-7"],[1,"text-center","text-bold"],[1,"text-center","text-sm"],[1,"col-sm-3"],[1,"float-right","d-inline"],[1,"text-bold"],[1,"text-danger","text-xl"],[1,"row","mb-2"],[1,"col-sm-12"],[1,"border-top","border-dark","header-line"],[1,"text-bold","text-left"],[1,"table","table-sm","table-borderless"],[1,"w-min"],[1,"border-bottom","border-dark"],["colspan","2"],[2,"width","200px"],[2,"width","180px"],[1,"border","border-dark"],["colspan","5"],[1,"row","mt-2","mb-2","no-print"],[1,"col-12"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["target","_blank",1,"btn","btn-default",3,"routerLink"],[1,"fas","fa-print"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.Jc(1,Ac,207,51,"div",1),d.bc()),2&c&&(d.Kb(1),d.sc("ngIf",!t.isLoading))},directives:[i.m,h.h],pipes:[i.s,i.e,i.f],styles:[".img-jmg[_ngcontent-%COMP%]{width:100px;height:100px;-o-object-fit:contain;object-fit:contain}.header-line[_ngcontent-%COMP%]{border-top:2px solid #000!important}td.w-min[_ngcontent-%COMP%]{width:1%;white-space:nowrap}"]}),c})();var Dc=e("LNgY"),Oc=e("VuLe"),xc=e("eUtn"),Pc=e("bOQg"),Tc=e("fdx9"),qc=e("wWB1");function Rc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(",\xa0",d.oc(2,1,c.data.recv_addr_line_2),",")}}function Xc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc("",d.oc(2,1,c.data.recv_addr_line_3),"\xa0")}}function Fc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(",\xa0",d.oc(2,1,c.data.pickup_addr_line_2),",")}}function Jc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc("",d.oc(2,1,c.data.pickup_addr_line_3),"\xa0")}}function Bc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc("\xa0",c.data.issue_from.addr_line_2,",")}}function Wc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc("\xa0",c.data.issue_from.addr_line_3,",")}}function Uc(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc("+",c.data.issue_from.fax_no,"")}}const $c=function(c){return["/delivery-order",c,"print"]};function Vc(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"div",6),d.cc(2,"div",7),d.cc(3,"div"),d.Lc(4,"Date:"),d.bc(),d.bc(),d.cc(5,"div",8),d.cc(6,"div",9),d.Lc(7),d.nc(8,"date"),d.bc(),d.bc(),d.bc(),d.cc(9,"div",10),d.cc(10,"div",7),d.cc(11,"div"),d.Lc(12,"DO no.:"),d.bc(),d.bc(),d.cc(13,"div",8),d.cc(14,"div",9),d.Lc(15),d.bc(),d.bc(),d.bc(),d.cc(16,"div",10),d.cc(17,"div",7),d.cc(18,"div"),d.Lc(19,"Delivery to:"),d.bc(),d.bc(),d.cc(20,"div",8),d.cc(21,"div",9),d.Lc(22),d.bc(),d.bc(),d.bc(),d.cc(23,"div",10),d.cc(24,"div",11),d.cc(25,"div",9),d.Lc(26),d.nc(27,"uppercase"),d.Jc(28,Rc,3,3,"ng-container",12),d.bc(),d.bc(),d.bc(),d.cc(29,"div",10),d.cc(30,"div",11),d.cc(31,"div",9),d.Jc(32,Xc,3,3,"ng-container",12),d.Lc(33),d.nc(34,"uppercase"),d.nc(35,"uppercase"),d.nc(36,"uppercase"),d.bc(),d.bc(),d.bc(),d.cc(37,"div",10),d.cc(38,"div",11),d.cc(39,"div",9),d.Lc(40,"\xa0"),d.bc(),d.bc(),d.bc(),d.cc(41,"div",10),d.cc(42,"div",7),d.cc(43,"div"),d.Lc(44,"Contract no.:"),d.bc(),d.bc(),d.cc(45,"div",8),d.cc(46,"div",9),d.Lc(47),d.bc(),d.bc(),d.bc(),d.cc(48,"div",6),d.cc(49,"div",7),d.cc(50,"div"),d.Lc(51,"PO no:"),d.bc(),d.bc(),d.cc(52,"div",8),d.cc(53,"div",9),d.Lc(54),d.bc(),d.bc(),d.bc(),d.cc(55,"div",10),d.cc(56,"div",7),d.cc(57,"div"),d.Lc(58,"Pick up location:"),d.bc(),d.bc(),d.cc(59,"div",8),d.cc(60,"div",9),d.Lc(61),d.bc(),d.bc(),d.bc(),d.cc(62,"div",10),d.cc(63,"div",11),d.cc(64,"div",9),d.Lc(65),d.nc(66,"uppercase"),d.Jc(67,Fc,3,3,"ng-container",12),d.bc(),d.bc(),d.bc(),d.cc(68,"div",10),d.cc(69,"div",11),d.cc(70,"div",9),d.Jc(71,Jc,3,3,"ng-container",12),d.Lc(72),d.nc(73,"uppercase"),d.nc(74,"uppercase"),d.nc(75,"uppercase"),d.bc(),d.bc(),d.bc(),d.cc(76,"div",10),d.cc(77,"div",11),d.cc(78,"div",9),d.Lc(79,"\xa0"),d.bc(),d.bc(),d.bc(),d.cc(80,"div",13),d.cc(81,"div",11),d.cc(82,"div",9),d.Lc(83,"\xa0"),d.bc(),d.bc(),d.bc(),d.cc(84,"div",14),d.cc(85,"div",15),d.cc(86,"table",16),d.cc(87,"thead"),d.cc(88,"tr"),d.cc(89,"th"),d.Lc(90,"No."),d.bc(),d.cc(91,"th"),d.Lc(92,"Vehicle No."),d.bc(),d.cc(93,"th"),d.Lc(94,"Driver"),d.bc(),d.cc(95,"th"),d.Lc(96,"I/C no."),d.bc(),d.cc(97,"th"),d.Lc(98,"Remarks"),d.bc(),d.cc(99,"th"),d.Lc(100,"Tonnage (MT)"),d.bc(),d.bc(),d.bc(),d.cc(101,"tbody"),d.cc(102,"td"),d.Lc(103,"1"),d.bc(),d.cc(104,"td"),d.Lc(105),d.bc(),d.cc(106,"td"),d.Lc(107),d.bc(),d.cc(108,"td"),d.Lc(109),d.bc(),d.cc(110,"td"),d.Lc(111),d.bc(),d.cc(112,"td"),d.Lc(113),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(114,"div",10),d.cc(115,"div",17),d.cc(116,"div",18),d.Lc(117,"\xa0"),d.bc(),d.bc(),d.Xb(118,"div",19),d.cc(119,"div",20),d.cc(120,"div",18),d.Lc(121,"\xa0"),d.bc(),d.bc(),d.bc(),d.cc(122,"div",6),d.cc(123,"div",17),d.cc(124,"div",21),d.Lc(125,"Prepared by:"),d.bc(),d.bc(),d.Xb(126,"div",19),d.cc(127,"div",20),d.cc(128,"div",21),d.Lc(129,"Received By:"),d.bc(),d.bc(),d.bc(),d.cc(130,"div",6),d.cc(131,"div",3),d.cc(132,"div",22),d.Lc(133),d.bc(),d.cc(134,"div",23),d.Lc(135),d.Jc(136,Bc,2,1,"ng-container",12),d.Jc(137,Wc,2,1,"ng-container",12),d.Lc(138),d.Xb(139,"br"),d.Lc(140),d.bc(),d.cc(141,"div",23),d.cc(142,"b"),d.Lc(143,"T"),d.bc(),d.Lc(144),d.cc(145,"b"),d.Lc(146,"F"),d.bc(),d.Jc(147,Uc,2,1,"ng-container",12),d.bc(),d.bc(),d.bc(),d.cc(148,"div",24),d.cc(149,"div",3),d.cc(150,"button",25),d.kc("click",(function(){return d.Dc(c),d.mc().onBack()})),d.Xb(151,"i",26),d.Lc(152," Back"),d.bc(),d.cc(153,"a",27),d.Xb(154,"i",28),d.Lc(155," Print"),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(7),d.Mc(d.pc(8,37,c.data.issued_date,"d MMM yyyy")),d.Kb(8),d.Mc(c.data.do_num),d.Kb(7),d.Mc(c.data.recv_name),d.Kb(4),d.Nc(" ",d.oc(27,40,c.data.recv_addr_line_1),""),d.Kb(2),d.sc("ngIf",c.data.recv_addr_line_2),d.Kb(4),d.sc("ngIf",c.data.recv_addr_line_3),d.Kb(1),d.Qc(" ",c.data.recv_postcode,"\xa0",d.oc(34,42,c.data.recv_city),"\xa0 ",d.oc(35,44,c.data.recv_state.name),"\xa0",d.oc(36,46,c.data.recv_country.name)," "),d.Kb(14),d.Nc("",c.data.contract_num,"\xa0"),d.Kb(7),d.Mc(c.data.po_num),d.Kb(7),d.Mc(c.data.pickup_name),d.Kb(4),d.Nc(" ",d.oc(66,48,c.data.pickup_addr_line_1),""),d.Kb(2),d.sc("ngIf",c.data.pickup_addr_line_2),d.Kb(4),d.sc("ngIf",c.data.pickup_addr_line_3),d.Kb(1),d.Qc(" ",c.data.pickup_postcode,"\xa0",d.oc(73,50,c.data.pickup_city),"\xa0 ",d.oc(74,52,c.data.pickup_state.name),"\xa0",d.oc(75,54,c.data.pickup_country.name)," "),d.Kb(33),d.Mc(c.data.truck.registration_num),d.Kb(2),d.Mc(c.data.driver.name),d.Kb(2),d.Mc(c.data.driver.id_num),d.Kb(2),d.Mc(c.data.remarks),d.Kb(2),d.Mc(c.data.actual_weight),d.Kb(20),d.Oc("",c.data.issue_from.name," ",c.data.issue_from.registration_num,""),d.Kb(2),d.Nc(" ",c.data.issue_from.addr_line_1,", "),d.Kb(1),d.sc("ngIf",c.data.issue_from.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.issue_from.addr_line_3),d.Kb(1),d.Oc(" \xa0",c.data.issue_from.postcode,"\xa0",c.data.issue_from.city,""),d.Kb(2),d.Oc(" ",c.data.issue_from.state.name,"\xa0",c.data.issue_from.country.name," "),d.Kb(4),d.Nc(" ",c.data.issue_from.contact_no,"\u2003|\u2003"),d.Kb(3),d.sc("ngIf",c.data.issue_from.fax_no),d.Kb(6),d.sc("routerLink",d.vc(56,$c,c.id))}}let Gc=(()=>{class c{constructor(c,t,e,i,r){this.route=c,this.router=t,this.authService=e,this.deliveryOrderService=i,this.toastr=r,this.isLoading=!1,this.data={id:""}}ngOnInit(){this.route.paramMap.subscribe(c=>{this.id=c.get("id"),this.load()})}load(){v.a.isNull(this.id)||v.a.isUndefined(this.id)?this.isLoading=!1:(this.isLoading=!0,this.deliveryOrderService.edit(this.id).subscribe(c=>{this.data=c},c=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/mining-company/delivery-order/list"])}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(h.a),d.Wb(h.g),d.Wb(L.a),d.Wb(B.a),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-delivery-order-detail"]],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-12"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"row","mb-3"],[1,"col-sm-2"],[1,"col-sm-6"],[1,"border-bottom","border-dark"],[1,"row"],[1,"col-sm-6","offset-sm-2"],[4,"ngIf"],[1,"row","mb-4"],[1,"row","mb-5"],[1,"col-sm-12","table-responsive"],[1,"table","table-bordered"],[1,"col-sm-4","offset-sm-1"],[1,"border-bottom","border-dark","ml-3"],[1,"col-sm-4"],[1,"col-sm-3"],[1,"ml-3"],[1,"text-center","text-bold"],[1,"text-center"],[1,"row","mb-3","no-print"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["target","_blank",1,"btn","btn-default",3,"routerLink"],[1,"fas","fa-print"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1"),d.Lc(5,"DELIVERY ORDER"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",4),d.Jc(7,Vc,156,58,"div",5),d.bc()),2&c&&(d.Kb(7),d.sc("ngIf",!t.isLoading))},directives:[i.m,h.h],pipes:[i.e,i.s],styles:[".table-bordered[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #000!important}"]}),c})();var jc=e("5Pgx"),Hc=e("tk/3"),Zc=e("AytR");let Qc=(()=>{class c{constructor(c){this.http=c,this.baseUrl=Zc.a.baseUrl}list(c,t,e,i){let r=(new Hc.f).set("_page",c).set("_limit",t);return""!==e&&(""===i&&(i="asc"),r=r.append("sort",`${e}:${i}`)),this.http.get(this.baseUrl+"/api/purchase-orders",{params:r,observe:"response"})}search(c,t,e,i,r){let s=(new Hc.f).set("_page",c).set("_limit",t);return""!==e&&(""===i&&(i="asc"),s=s.append("sort",`${e}:${i}`)),this.http.post(this.baseUrl+"/api/purchase-orders",{keyword:r},{params:s,observe:"response"})}create(c){return this.http.post(this.baseUrl+"/api/purchase-order",c)}detail(c){return this.http.get(`${this.baseUrl}/api/purchase-order/${c}`)}}return c.\u0275fac=function(t){return new(t||c)(d.gc(Hc.b))},c.\u0275prov=d.Sb({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();function Yc(c,t){1&c&&(d.cc(0,"div",18),d.cc(1,"h4"),d.Lc(2,"No records found"),d.bc(),d.bc())}function zc(c,t){if(1&c){const c=d.dc();d.cc(0,"tr"),d.cc(1,"td"),d.Lc(2),d.bc(),d.cc(3,"td"),d.Lc(4),d.bc(),d.cc(5,"td"),d.Lc(6),d.bc(),d.cc(7,"td"),d.Lc(8),d.nc(9,"date"),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.cc(13,"button",23),d.kc("click",(function(){d.Dc(c);const e=t.$implicit;return d.mc(2).onView(e)})),d.Xb(14,"i",24),d.bc(),d.bc(),d.bc()}if(2&c){const c=t.$implicit,e=d.mc(2);d.Kb(2),d.Mc(c.po_num),d.Kb(2),d.Mc(c.buyer.name),d.Kb(2),d.Mc(c.issue_to.name),d.Kb(2),d.Mc(d.pc(9,5,c.issued_date,"d MMM yyyy h:mm:ss aaa")),d.Kb(3),d.Mc(e.getPOStatus(c))}}function ct(c,t){if(1&c){const c=d.dc();d.cc(0,"div",19),d.cc(1,"table",20),d.cc(2,"thead"),d.cc(3,"tr"),d.cc(4,"th"),d.cc(5,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(6,"th"),d.cc(7,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(8,"th"),d.cc(9,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(10,"th"),d.cc(11,"app-sort-column",21),d.kc("onSortBy",(function(t){return d.Dc(c),d.mc().onSortBy(t)})),d.bc(),d.bc(),d.cc(12,"th"),d.Lc(13,"Status"),d.bc(),d.Xb(14,"th"),d.bc(),d.bc(),d.cc(15,"tbody"),d.Jc(16,zc,15,8,"tr",22),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(5),d.sc("name","PO No.")("sort","po_num")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Buyer")("sort","buyer__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Issue To")("sort","issue_to__name")("dir",c.sortDir)("current",c.sort),d.Kb(2),d.sc("name","Issued Date")("sort","issued_date")("dir",c.sortDir)("current",c.sort),d.Kb(5),d.sc("ngForOf",c.list)}}function tt(c,t){if(1&c){const c=d.dc();d.cc(0,"div",25),d.cc(1,"div",26),d.cc(2,"pagination",27),d.kc("ngModelChange",(function(t){return d.Dc(c),d.mc().page=t}))("pageChanged",(function(t){return d.Dc(c),d.mc().pageChanged(t)})),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(2),d.sc("totalItems",c.totalCount)("itemsPerPage",c.pageSize)("maxSize",c.MAX_PAGE_NUMBERS)("ngModel",c.page)}}let et=(()=>{class c{constructor(c,t,e,i){this.route=c,this.router=t,this.purchaseOrderService=e,this.msService=i,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=q.a.PAGE_SIZE,this.page=1,this.search="",this.sort="issued_date",this.sortDir="desc",this.sx=0,this.sy=0,this.uiState="mining-company.purchase-order-listing",this.isEmpty=f.a.isEmpty,this.PAGE_SIZE=q.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=q.a.MAX_PAGE_NUMBERS}ngOnInit(){this.subs=this.msService.get().subscribe(c=>{if(c.name===this.uiState){const t=c.data;this.page=t.page,this.sort=t.sort,this.sortDir=t.dir,this.search=t.search,this.sx=t.sx,this.sy=t.sy}}),this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.purchaseOrderService.list(this.page,q.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(q.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(c){this.search=c,this.isLoading=!0,this.purchaseOrderService.search(this.page,q.a.PAGE_SIZE,this.sort,this.sortDir,c).subscribe(c=>{this.list=c.body,this.totalCount=Number(c.headers.get(q.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},c=>{},()=>{this.isLoading=!1})}pageChanged(c){this.page=c.page,this.load()}onSortBy(c){""===c.sort&&"asc"===c.dir?(this.sort="issued_date",this.sortDir="desc"):(this.sort=c.sort,this.sortDir=c.dir),this.load()}goto(c){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/mining-company/purchase-order/"+c])}onView(c){this.goto("detail/"+c.id)}getPOStatus(c){return c.status===q.a.POStatus.IN_PROGRESS?"IN PROGRESS":c.status===q.a.POStatus.COMPLETED?"COMPLETED":c.status===q.a.POStatus.CANCELLED?"CANCELLED":c.status===q.a.POStatus.REJECTED?"REJECTED":"PENDING"}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(h.a),d.Wb(h.g),d.Wb(Qc),d.Wb(W.a))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-eye"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Purchase Order Listing"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"div",6),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"app-search-input",10),d.kc("onSearch",(function(c){return t.onSearch(c)})),d.bc(),d.bc(),d.cc(13,"div",11),d.cc(14,"button",12),d.kc("click",(function(){return t.goto("create")})),d.Xb(15,"i",13),d.Lc(16," Issue PO"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(17,"div",14),d.Jc(18,Yc,3,0,"div",15),d.Jc(19,ct,17,17,"div",16),d.bc(),d.Jc(20,tt,3,4,"div",17),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(12),d.sc("search",t.search),d.Kb(6),d.sc("ngIf",t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",!t.isEmpty(t.list)&&!t.isLoading),d.Kb(1),d.sc("ngIf",t.totalCount&&!t.isLoading))},directives:[U.a,i.m,$.a,i.l,o.a,r.j,r.l],pipes:[i.e],styles:[""]}),c})();var it=e("mMBO");function rt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Buyer is required "),d.bc())}function st(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Material is required "),d.bc())}function nt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Truck is required "),d.bc())}function at(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Driver is required "),d.bc())}function ot(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Weight is required "),d.bc())}function dt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Weight is invalid "),d.bc())}function lt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Name is required "),d.bc())}function bt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Address is required "),d.bc())}function ut(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Postcode is required "),d.bc())}function mt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," City is required "),d.bc())}function pt(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," State is required "),d.bc())}function ht(c,t){1&c&&(d.cc(0,"small",27),d.Lc(1," Country is required "),d.bc())}const _t=function(c){return{"is-invalid":c}};function vt(c,t){if(1&c){const c=d.dc();d.cc(0,"div",28),d.cc(1,"div",17),d.cc(2,"h3",18),d.Lc(3),d.bc(),d.cc(4,"div",29),d.cc(5,"button",30),d.kc("click",(function(){d.Dc(c);const e=t.$implicit;return d.mc().onRemoveMaterial(e)})),d.Xb(6,"i",31),d.bc(),d.bc(),d.bc(),d.cc(7,"div",32),d.cc(8,"div",9),d.cc(9,"label",33),d.Lc(10,"Material\xa0"),d.cc(11,"span",11),d.Lc(12,"*"),d.bc(),d.bc(),d.cc(13,"div",34),d.Xb(14,"ng-select",35),d.Jc(15,st,2,0,"small",14),d.bc(),d.cc(16,"label",33),d.Lc(17,"Truck\xa0"),d.cc(18,"span",11),d.Lc(19,"*"),d.bc(),d.bc(),d.cc(20,"div",34),d.Xb(21,"ng-select",36),d.Jc(22,nt,2,0,"small",14),d.bc(),d.cc(23,"label",33),d.Lc(24,"Driver\xa0"),d.cc(25,"span",11),d.Lc(26,"*"),d.bc(),d.bc(),d.cc(27,"div",34),d.Xb(28,"ng-select",37),d.Jc(29,at,2,0,"small",14),d.bc(),d.bc(),d.cc(30,"div",9),d.cc(31,"label",33),d.Lc(32,"Weight\xa0"),d.cc(33,"span",11),d.Lc(34,"*"),d.bc(),d.bc(),d.cc(35,"div",34),d.Xb(36,"input",38),d.Jc(37,ot,2,0,"small",14),d.Jc(38,dt,2,0,"small",14),d.bc(),d.cc(39,"label",33),d.Lc(40,"tons"),d.bc(),d.bc(),d.cc(41,"div",15),d.cc(42,"div",16),d.cc(43,"h4",18),d.Lc(44,"Receiver Details"),d.bc(),d.Xb(45,"br"),d.Xb(46,"hr"),d.bc(),d.bc(),d.cc(47,"div",9),d.cc(48,"label",33),d.Lc(49,"Name\xa0"),d.cc(50,"span",11),d.Lc(51,"*"),d.bc(),d.bc(),d.cc(52,"div",39),d.Xb(53,"input",40),d.Jc(54,lt,2,0,"small",14),d.bc(),d.bc(),d.cc(55,"div",9),d.cc(56,"label",33),d.Lc(57,"Address\xa0"),d.cc(58,"span",11),d.Lc(59,"*"),d.bc(),d.bc(),d.cc(60,"div",39),d.Xb(61,"input",41),d.Jc(62,bt,2,0,"small",14),d.bc(),d.bc(),d.cc(63,"div",9),d.cc(64,"div",42),d.Xb(65,"input",43),d.bc(),d.bc(),d.cc(66,"div",9),d.cc(67,"div",42),d.Xb(68,"input",44),d.bc(),d.bc(),d.cc(69,"div",9),d.cc(70,"label",33),d.Lc(71,"Postcode\xa0"),d.cc(72,"span",11),d.Lc(73,"*"),d.bc(),d.bc(),d.cc(74,"div",45),d.Xb(75,"input",46),d.Jc(76,ut,2,0,"small",14),d.bc(),d.cc(77,"label",33),d.Lc(78,"City\xa0"),d.cc(79,"span",11),d.Lc(80,"*"),d.bc(),d.bc(),d.cc(81,"div",47),d.Xb(82,"input",48),d.Jc(83,mt,2,0,"small",14),d.bc(),d.bc(),d.cc(84,"div",9),d.cc(85,"label",33),d.Lc(86,"State\xa0"),d.cc(87,"span",11),d.Lc(88,"*"),d.bc(),d.bc(),d.cc(89,"div",45),d.Xb(90,"ng-select",49),d.Jc(91,pt,2,0,"small",14),d.bc(),d.cc(92,"label",33),d.Lc(93,"Country\xa0"),d.cc(94,"span",11),d.Lc(95,"*"),d.bc(),d.bc(),d.cc(96,"div",47),d.cc(97,"ng-select",50),d.kc("change",(function(e){d.Dc(c);const i=t.$implicit;return d.mc().onChangeReceiverCountry(e,i)})),d.bc(),d.Jc(98,ht,2,0,"small",14),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=t.$implicit,e=t.index,i=d.mc();d.Kb(3),d.Nc("Item #",e+1,""),d.Kb(4),d.sc("formGroupName",e),d.Kb(7),d.sc("items",i.materialList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"truck_id")&&i.hasErrorFg(c,"truck_id","required")),d.Kb(6),d.sc("items",i.truckList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"truck_id")&&i.hasErrorFg(c,"truck_id","required")),d.Kb(6),d.sc("items",i.driverList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"driver_id")&&i.hasErrorFg(c,"driver_id","required")),d.Kb(7),d.sc("ngClass",d.vc(23,_t,i.invalidFg(c,"weight"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"weight")&&i.hasErrorFg(c,"weight","required")),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"weight")&&i.hasErrorFg(c,"weight","pattern")),d.Kb(15),d.sc("ngClass",d.vc(25,_t,i.invalidFg(c,"recv_name"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_name")&&i.hasErrorFg(c,"recv_name","required")),d.Kb(7),d.sc("ngClass",d.vc(27,_t,i.invalidFg(c,"recv_addr_line_1"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_addr_line_1")&&i.hasErrorFg(c,"recv_addr_line_1","required")),d.Kb(13),d.sc("ngClass",d.vc(29,_t,i.invalidFg(c,"recv_postcode"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_postcode")&&i.hasErrorFg(c,"recv_postcode","required")),d.Kb(6),d.sc("ngClass",d.vc(31,_t,i.invalidFg(c,"recv_city"))),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_city")&&i.hasErrorFg(c,"recv_city","required")),d.Kb(7),d.sc("items",i.getStateList(c)),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_state_id")&&i.hasErrorFg(c,"recv_state_id","required")),d.Kb(6),d.sc("items",i.countryList),d.Kb(1),d.sc("ngIf",i.invalidFg(c,"recv_country_id")&&i.hasErrorFg(c,"recv_country_id","required"))}}function ft(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",d.oc(2,1,c.data.buyer.addr_line_2),"")}}function gt(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.nc(4,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(d.oc(4,1,c.data.buyer.addr_line_3))}}function yt(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(1),d.Nc(", ",d.oc(2,1,c.data.issue_to.addr_line_2),"")}}function Lt(c,t){if(1&c&&(d.ac(0),d.Lc(1,","),d.Xb(2,"br"),d.Lc(3),d.nc(4,"uppercase"),d.Zb()),2&c){const c=d.mc(2);d.Kb(3),d.Mc(d.oc(4,1,c.data.issue_to.addr_line_3))}}function kt(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(", ",d.oc(2,1,c.recv_addr_line_2),"")}}function Ct(c,t){if(1&c&&(d.ac(0),d.Lc(1),d.nc(2,"uppercase"),d.Zb()),2&c){const c=d.mc().$implicit;d.Kb(1),d.Nc(", ",d.oc(2,1,c.recv_addr_line_3),"")}}function St(c,t){if(1&c&&(d.ac(0),d.cc(1,"tr"),d.cc(2,"td"),d.Lc(3),d.bc(),d.cc(4,"td"),d.Lc(5),d.bc(),d.cc(6,"td"),d.Lc(7),d.bc(),d.cc(8,"td"),d.Lc(9),d.bc(),d.cc(10,"td"),d.Lc(11),d.bc(),d.cc(12,"td"),d.Lc(13),d.bc(),d.cc(14,"td"),d.Lc(15),d.bc(),d.bc(),d.cc(16,"tr"),d.cc(17,"td",26),d.Lc(18),d.Xb(19,"br"),d.Lc(20),d.nc(21,"uppercase"),d.Jc(22,kt,3,3,"ng-container",13),d.Jc(23,Ct,3,3,"ng-container",13),d.Lc(24),d.nc(25,"uppercase"),d.nc(26,"uppercase"),d.nc(27,"uppercase"),d.bc(),d.bc(),d.Zb()),2&c){const c=t.$implicit,e=t.index;d.Kb(3),d.Mc(e+1),d.Kb(2),d.Pc("",c.material.name," ",c.material.material_type," ",c.material.grade,""),d.Kb(2),d.Mc(c.truck.registration_num),d.Kb(2),d.Mc(c.driver.name),d.Kb(2),d.Mc(c.driver.id_num),d.Kb(2),d.Mc(c.weight),d.Kb(2),d.Mc(c.do_num),d.Kb(3),d.Nc(" Destination: ",c.recv_name,""),d.Kb(2),d.Nc(" ",d.oc(21,17,c.recv_addr_line_1),""),d.Kb(2),d.sc("ngIf",c.recv_addr_line_2),d.Kb(1),d.sc("ngIf",c.recv_addr_line_3),d.Kb(1),d.Qc(" ",c.recv_postcode," ",d.oc(25,19,c.recv_city)," ",d.oc(26,21,c.recv_state.name),", ",d.oc(27,23,c.recv_country.name)," ")}}const Kt=function(c){return["/purchase-order",c,"print"]};function Nt(c,t){if(1&c){const c=d.dc();d.cc(0,"div",1),d.cc(1,"div",7),d.cc(2,"div",8),d.cc(3,"div",9),d.cc(4,"div",7),d.cc(5,"div",8),d.cc(6,"h4"),d.cc(7,"small",10),d.Lc(8),d.nc(9,"date"),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(10,"div",11),d.cc(11,"div",12),d.Lc(12," From "),d.cc(13,"address"),d.cc(14,"strong"),d.Lc(15),d.bc(),d.Xb(16,"br"),d.Lc(17),d.Xb(18,"br"),d.Lc(19),d.nc(20,"uppercase"),d.Jc(21,ft,3,3,"ng-container",13),d.Jc(22,gt,5,3,"ng-container",13),d.Xb(23,"br"),d.Lc(24),d.nc(25,"uppercase"),d.Xb(26,"br"),d.Lc(27),d.nc(28,"uppercase"),d.nc(29,"uppercase"),d.Xb(30,"br"),d.Lc(31),d.Xb(32,"br"),d.Lc(33),d.bc(),d.bc(),d.cc(34,"div",12),d.Lc(35," To "),d.cc(36,"address"),d.cc(37,"strong"),d.Lc(38),d.bc(),d.Xb(39,"br"),d.Lc(40),d.Xb(41,"br"),d.Lc(42),d.nc(43,"uppercase"),d.Jc(44,yt,3,3,"ng-container",13),d.Jc(45,Lt,5,3,"ng-container",13),d.Xb(46,"br"),d.Lc(47),d.nc(48,"uppercase"),d.Xb(49,"br"),d.Lc(50),d.nc(51,"uppercase"),d.nc(52,"uppercase"),d.Xb(53,"br"),d.Lc(54),d.Xb(55,"br"),d.Lc(56),d.bc(),d.bc(),d.cc(57,"div",14),d.cc(58,"b"),d.Lc(59),d.bc(),d.Xb(60,"br"),d.bc(),d.bc(),d.cc(61,"div",7),d.cc(62,"div",15),d.cc(63,"table",16),d.cc(64,"thead"),d.cc(65,"tr"),d.cc(66,"th"),d.Lc(67,"#"),d.bc(),d.cc(68,"th"),d.Lc(69,"Material"),d.bc(),d.cc(70,"th"),d.Lc(71,"Truck"),d.bc(),d.cc(72,"th"),d.Lc(73,"Driver"),d.bc(),d.cc(74,"th"),d.Lc(75,"I/C No."),d.bc(),d.cc(76,"th"),d.Lc(77,"Weight (tons)"),d.bc(),d.cc(78,"th"),d.Lc(79,"DO No."),d.bc(),d.bc(),d.bc(),d.cc(80,"tbody"),d.Jc(81,St,28,25,"ng-container",17),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(82,"div",18),d.cc(83,"div",8),d.cc(84,"button",19),d.kc("click",(function(){return d.Dc(c),d.mc().onBack()})),d.Xb(85,"i",20),d.Lc(86," Back"),d.bc(),d.cc(87,"button",21),d.kc("cbOnSuccess",(function(t){return d.Dc(c),d.mc().onCopySuccess(t)})),d.Lc(88,"Copy"),d.bc(),d.cc(89,"button",22),d.kc("click",(function(){return d.Dc(c),d.mc().onWhatsapp()})),d.Xb(90,"i",23),d.bc(),d.cc(91,"a",24),d.Xb(92,"i",25),d.Lc(93," Print"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()}if(2&c){const c=d.mc();d.Kb(8),d.Nc("Date: ",d.pc(9,27,c.data.issued_date,"d MMM yyyy"),""),d.Kb(7),d.Mc(c.data.buyer.name),d.Kb(2),d.Nc("",c.data.buyer.registration_num," "),d.Kb(2),d.Mc(d.oc(20,30,c.data.buyer.addr_line_1)),d.Kb(2),d.sc("ngIf",c.data.buyer.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.buyer.addr_line_3),d.Kb(2),d.Oc("",c.data.buyer.postcode," ",d.oc(25,32,c.data.buyer.city)," "),d.Kb(3),d.Oc("",d.oc(28,34,c.data.buyer.state.name),", ",d.oc(29,36,c.data.buyer.country.name)," "),d.Kb(4),d.Nc("Phone: ",c.data.buyer.contact_no," "),d.Kb(2),d.Nc("Email: ",c.data.buyer.email," "),d.Kb(5),d.Mc(c.data.issue_to.name),d.Kb(2),d.Nc("",c.data.issue_to.registration_num," "),d.Kb(2),d.Mc(d.oc(43,38,c.data.issue_to.addr_line_1)),d.Kb(2),d.sc("ngIf",c.data.issue_to.addr_line_2),d.Kb(1),d.sc("ngIf",c.data.issue_to.addr_line_3),d.Kb(2),d.Oc("",c.data.issue_to.postcode," ",d.oc(48,40,c.data.issue_to.city)," "),d.Kb(3),d.Oc("",d.oc(51,42,c.data.issue_to.state.name),", ",d.oc(52,44,c.data.issue_to.country.name)," "),d.Kb(4),d.Nc("Phone: ",c.data.issue_to.contact_no," "),d.Kb(2),d.Nc("Email: ",c.data.issue_to.email," "),d.Kb(3),d.Nc("Purchase Order #",c.data.po_num,""),d.Kb(22),d.sc("ngForOf",c.data.details),d.Kb(6),d.sc("cbContent",c.getPODetails()),d.Kb(4),d.sc("routerLink",d.vc(46,Kt,c.id))}}const Et=[{path:"company-details",component:T},{path:"delivery-order",children:[{path:"list",component:tc},{path:"create",component:Ec},{path:"edit/:id",component:Ec},{path:"detail/:id",component:Gc}]},{path:"permit/:id",component:wc},{path:"purchase-order",children:[{path:"list",component:et},{path:"create",component:(()=>{class c extends g.a{constructor(c,t,e,i,r,s,n){super(),this.fb=c,this.route=t,this.router=e,this.authService=i,this.lookupService=r,this.purchaseOrderService=s,this.toastr=n,this.isLoading=!1,this.buyerList=[],this.materialList=[],this.truckList=[],this.driverList=[],this.countryList=[],this.createForm()}ngOnInit(){const c=this.authService.loadUser();this.mining_company_id=c.mining_company_id,this.load()}createForm(){this.mform=this.fb.group({buyer_id:[null,[r.p.required]],materialForms:this.fb.array([])})}createMaterialForm(){return this.fb.group({id:[v.a.uniqueId()],material_id:[null],weight:["0",[r.p.required,r.p.pattern(q.a.VALIDATE.AMOUNT)]],truck_id:[null,[r.p.required]],driver_id:[null,[r.p.required]],recv_name:["",[r.p.required]],recv_addr_line_1:["",[r.p.required]],recv_addr_line_2:[""],recv_addr_line_3:[""],recv_postcode:["",[r.p.required]],recv_city:["",[r.p.required]],recv_state_id:[null,[r.p.required]],recv_country_id:[null,[r.p.required]],stateList:[[]]})}load(){this.isLoading=!0;let c=this.lookupService.listBuyer(),t=this.lookupService.listMaterial(this.mining_company_id),e=this.lookupService.listCountry();Object(ec.a)([c,t,e]).subscribe(c=>{this.buyerList=c[0],this.materialList=c[1],this.countryList=c[2],this.materialList=c[1].map(c=>(c.label=`${c.name} (${c.material_type}) - ${c.grade}`,c))},c=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/mining-company/purchase-order/list"])}onAddMaterial(){let c=this.materialForms;const t=this.createMaterialForm();t.patchValue({recv_country_id:this.countryList[0].id}),this.onChangeReceiverCountry(this.countryList[0],t),c.insert(0,t)}onRemoveMaterial(c){let t=this.materialForms,e=v.a.reject(t.controls,t=>t.controls.id.value===c.controls.id.value);t.controls=e}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const c=this.materialForms.value.map(c=>({material_id:c.material_id,truck_id:c.truck_id,driver_id:c.driver_id,weight:c.weight,recv_name:c.recv_name,recv_addr_line_1:c.recv_addr_line_1,recv_addr_line_2:c.recv_addr_line_2,recv_addr_line_3:c.recv_addr_line_3,recv_postcode:c.recv_postcode,recv_city:c.recv_city,recv_state_id:c.recv_state_id,recv_country_id:c.recv_country_id}));this.purchaseOrderService.create({buyer_id:this.mform.value.buyer_id,issue_to_id:this.mining_company_id,purchase_order_detail:c}).subscribe(c=>{this.toastr.success("New Purchase Order successfully created"),this.mform.reset()})}onChangeBuyer(c){let t=this.lookupService.listTruck(c.id),e=this.lookupService.listDriver(c.id);Object(ec.a)([t,e]).subscribe(c=>{this.truckList=c[0],this.driverList=c[1],this.driverList=c[1].map(c=>(c.label=`${c.name} - ${c.id_num}`,c)),v.a.each(this.materialForms.controls,c=>{c.patchValue({truck_id:null,driver_id:null})})})}onChangeReceiverCountry(c,t){this.lookupService.listStates(c.id).subscribe(c=>{t.patchValue({state_id:null,stateList:c})})}get materialForms(){return this.mform.get("materialForms")}getStateList(c){return c.controls.stateList.value}invalidFg(c,t){const e=c.controls[t];return e.invalid&&(e.dirty||e.touched)}hasErrorFg(c,t,e){return c.controls[t].hasError(e)}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(r.c),d.Wb(h.a),d.Wb(h.g),d.Wb(L.a),d.Wb(y.a),d.Wb(it.a),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-create"]],features:[d.Hb],decls:40,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","buyer_id","name","buyer_id",3,"items","change"],["class","badge badge-danger",4,"ngIf"],[1,"row"],[1,"col-sm-12"],[1,"card-header"],[1,"card-title"],[1,"col-sm-2","col-4"],["type","button",1,"btn","btn-primary",3,"click"],["class","card","formArrayName","materialForms",4,"ngFor","ngForOf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"],["formArrayName","materialForms",1,"card"],[1,"card-tools"],["type","button",1,"btn","btn-tool",3,"click"],[1,"fas","fa-times"],[1,"card-body",3,"formGroupName"],[1,"col-sm-1","col-form-label"],[1,"col-sm-2"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","material_id","name","material_id",3,"items"],["bindLabel","registration_num","bindValue","id","placeholder","Please select","formControlName","truck_id","name","truck_id",3,"items"],["bindLabel","label","bindValue","id","placeholder","Please select","formControlName","driver_id","name","driver_id",3,"items"],["type","text","placeholder","Weight (tons)","name","weight","formControlName","weight",1,"form-control",3,"ngClass"],[1,"col-sm-11"],["type","text","placeholder","Name","name","recv_name","formControlName","recv_name",1,"form-control",3,"ngClass"],["type","text","placeholder","Address","name","recv_addr_line_1","formControlName","recv_addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-11","offset-sm-1"],["type","text","placeholder","Address 2","name","recv_addr_line_2","formControlName","recv_addr_line_2",1,"form-control"],["type","text","placeholder","Address 3","name","recv_addr_line_3","formControlName","recv_addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","recv_postcode","formControlName","recv_postcode",1,"form-control",3,"ngClass"],[1,"col-sm-7"],["type","text","placeholder","City","name","recv_city","formControlName","recv_city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","recv_state_id","name","recv_state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","name","recv_country_id","formControlName","recv_country_id",3,"items","change"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1",4),d.Lc(5,"Issue Purchase Order"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(6,"section",5),d.cc(7,"div",1),d.cc(8,"form",6),d.kc("ngSubmit",(function(){return t.onSubmit()})),d.cc(9,"div",7),d.cc(10,"div",8),d.cc(11,"div",9),d.cc(12,"label",10),d.Lc(13,"Buyer\xa0"),d.cc(14,"span",11),d.Lc(15,"*"),d.bc(),d.bc(),d.cc(16,"div",12),d.cc(17,"ng-select",13),d.kc("change",(function(c){return t.onChangeBuyer(c)})),d.bc(),d.Jc(18,rt,2,0,"small",14),d.bc(),d.bc(),d.bc(),d.bc(),d.cc(19,"div",15),d.cc(20,"div",16),d.cc(21,"div",7),d.cc(22,"div",17),d.cc(23,"h3",18),d.Lc(24,"Materials"),d.bc(),d.bc(),d.cc(25,"div",8),d.cc(26,"div",9),d.cc(27,"div",19),d.ac(28),d.cc(29,"button",20),d.kc("click",(function(){return t.onAddMaterial()})),d.Lc(30,"Add Material"),d.bc(),d.Zb(),d.bc(),d.bc(),d.Jc(31,vt,99,33,"div",21),d.bc(),d.cc(32,"div",22),d.cc(33,"div",3),d.cc(34,"button",23),d.kc("click",(function(){return t.onBack()})),d.Xb(35,"i",24),d.Lc(36," Back"),d.bc(),d.cc(37,"button",25),d.Xb(38,"i",26),d.Lc(39," Submit"),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc(),d.bc()),2&c&&(d.Kb(8),d.sc("formGroup",t.mform),d.Kb(9),d.sc("items",t.buyerList),d.Kb(1),d.sc("ngIf",t.invalid("buyer_id")&&t.f.buyer_id.hasError("required")),d.Kb(13),d.sc("ngForOf",t.materialForms.controls))},directives:[r.q,r.k,r.e,s.a,r.j,r.d,i.m,i.l,r.b,r.f,r.a,i.k],styles:[""]}),c})()},{path:"detail/:id",component:(()=>{class c{constructor(c,t,e,i,r){this.route=c,this.router=t,this.authService=e,this.purchaseOrderService=i,this.toastr=r,this.isLoading=!1,this.data={id:""}}ngOnInit(){this.route.paramMap.subscribe(c=>{this.id=c.get("id"),this.load()})}load(){v.a.isNull(this.id)||v.a.isUndefined(this.id)?this.isLoading=!1:(this.isLoading=!0,this.purchaseOrderService.detail(this.id).subscribe(c=>{this.data=c},c=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/mining-company/purchase-order/list"])}onCopySuccess(c){this.toastr.success("DO Details copied")}onWhatsapp(){let c=this.getPODetails();c=encodeURIComponent(c);let t=""+this.data.issue_to.contact_no;t&&t.indexOf("60")<0&&(t="6"+t),window.open(`https://api.whatsapp.com/send?phone=${t}&text=${c}`,"_blank")}getPODetails(){let c=[],t="";return v.a.each(this.data.details,t=>{let e=`DO #${t.do_num}\n`;e+=`Material: ${t.material.name}, Type: ${t.material.material_type}, Grade: ${t.material.grade}\n`,e+=`Truck No: ${t.truck.registration_num}\n`,e+=`Driver: ${t.driver.name}, IC No.: ${t.driver.id_num}\n\n`,c.push(e)}),t=c.join("-----------------------------\n\n"),t}}return c.\u0275fac=function(t){return new(t||c)(d.Wb(h.a),d.Wb(h.g),d.Wb(L.a),d.Wb(Qc),d.Wb(C.b))},c.\u0275cmp=d.Qb({type:c,selectors:[["app-purchase-order-detail"]],decls:9,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-10"],[1,"col-sm-2"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"invoice","p-3","mb-3"],[1,"float-right"],[1,"row","invoice-info"],[1,"col-sm-6","invoice-col"],[4,"ngIf"],[1,"col-sm-4","invoice-col"],[1,"col-12","table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"row","no-print"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button","ngxClipboard","",1,"btn","btn-default","mr-2",3,"cbContent","cbOnSuccess"],["type","button",1,"btn","btn-success","mr-2",3,"click"],[1,"fab","fa-whatsapp"],["target","_blank",1,"btn","btn-default",3,"routerLink"],[1,"fas","fa-print"],["colspan","7"]],template:function(c,t){1&c&&(d.cc(0,"section",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"div",3),d.cc(4,"h1"),d.Lc(5,"Purchase Order"),d.bc(),d.bc(),d.Xb(6,"div",4),d.bc(),d.bc(),d.bc(),d.cc(7,"section",5),d.Jc(8,Nt,94,48,"div",6),d.bc()),2&c&&(d.Kb(8),d.sc("ngIf",!t.isLoading))},directives:[i.m,i.l,m,h.h],pipes:[i.e,i.s],styles:[""]}),c})()}]},{path:"buyer",children:[{path:"list",component:Dc.a},{path:"create",component:Oc.a},{path:"edit/:id",component:Oc.a},{path:"truck/:buyer_id",children:[{path:"list",component:xc.a},{path:"create",component:Pc.a},{path:"edit/:id",component:Pc.a}]},{path:"driver/:buyer_id",children:[{path:"list",component:Tc.a},{path:"create",component:qc.a},{path:"edit/:id",component:qc.a}]},{path:"user/:buyer_id",children:[{path:"list",component:jc.a}]}]}];let It=(()=>{class c{}return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},imports:[[h.i.forChild(Et)],h.i]}),c})();var Mt=e("jgPy"),At=e("mrcu"),wt=e("Thox"),Dt=e("DLVw"),Ot=e("WF//");let xt=(()=>{class c{}return c.\u0275mod=d.Ub({type:c}),c.\u0275inj=d.Tb({factory:function(t){return new(t||c)},providers:[At.a,wt.a,B.a,Ic.a,Dt.a,ic.a,rc.a,Ot.a,Qc],imports:[[i.c,It,r.g,r.n,Mt.a,s.b,n.c.forRoot(),a.c.forRoot(),o.b.forRoot(),p]]}),c})()}}]);