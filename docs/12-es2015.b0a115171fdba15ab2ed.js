(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{VOPl:function(t,c,i){"use strict";i.r(c),i.d(c,"SetupModule",(function(){return $c}));var s=i("ofXK"),e=i("3Pt+"),r=i("ZOsW"),n=i("LqlI"),o=i("ienR"),a=i("6No5"),d=i("tyNb"),b=i("d2bA"),l=i("C7yL"),u=i("g/JT"),h=i("fXoL"),m=i("tk/3"),p=i("AytR");let g=(()=>{class t{constructor(t){this.http=t,this.baseUrl=p.a.baseUrl}list(t,c,i,s){let e=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),e=e.append("sort",`${i}:${s}`)),this.http.get(this.baseUrl+"/api/users",{params:e,observe:"response"})}search(t,c,i,s,e){let r=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),r=r.append("sort",`${i}:${s}`)),this.http.post(this.baseUrl+"/api/users",{keyword:e},{params:r,observe:"response"})}create(t){return this.http.post(this.baseUrl+"/api/user",t)}edit(t){return this.http.get(`${this.baseUrl}/api/user/${t}`)}update(t,c){return this.http.put(`${this.baseUrl}/api/user/${t}`,c)}remove(t){return this.http.delete(`${this.baseUrl}/api/user/${t}`)}}return t.\u0275fac=function(c){return new(c||t)(h.gc(m.b))},t.\u0275prov=h.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=i("QLLi"),v=i("5eHb"),y=i("OpGx"),_=i("C4D8");function S(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function L(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td"),h.Lc(8),h.bc(),h.cc(9,"td"),h.Lc(10),h.bc(),h.cc(11,"td",23),h.cc(12,"button",24),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(13,"i",25),h.bc(),h.cc(14,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(15,"i",27),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit,i=h.mc(2);h.Kb(2),h.Mc(t.username),h.Kb(2),h.Mc(t.email),h.Kb(2),h.Mc(t.first_name),h.Kb(2),h.Mc(t.last_name),h.Kb(2),h.Mc(i.getUserRoles(t))}}function k(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(10,"th"),h.cc(11,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(12,"th"),h.Lc(13,"Role"),h.bc(),h.Xb(14,"th"),h.bc(),h.bc(),h.cc(15,"tbody"),h.Jc(16,L,16,5,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Username")("sort","username")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","First name")("sort","first_name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Last name")("sort","last_name")("dir",t.sortDir)("current",t.sort),h.Kb(5),h.sc("ngForOf",t.list)}}function E(t,c){if(1&t){const t=h.dc();h.cc(0,"div",28),h.cc(1,"div",29),h.cc(2,"pagination",30),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let C=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.userService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="username",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.user.user-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.userService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.userService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="username",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/user/"+t])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete User",message:`Are you sure to delete this User ${t.username} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.userService.remove(t.id).subscribe(t=>{this.toastr.success("User successfully deleted"),this.load()})})}getUserRoles(t){return t.groups.map(t=>t.name).join(", ")}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(g),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-user-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"User Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,S,3,0,"div",15),h.Jc(19,k,17,17,"div",16),h.bc(),h.Jc(20,E,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();var D=i("LvDl"),K=i.n(D),I=i("fwOm"),x=i("wgH9");function A(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Username is required "),h.bc())}function N(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Password is required "),h.bc())}function w(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Password should be between 6 to 8 characters in length "),h.bc())}function M(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Password should be between 6 to 8 characters in length "),h.bc())}function B(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Email is invalid "),h.bc())}function P(t,c){if(1&t&&(h.ac(0),h.Xb(1,"input",27),h.Zb()),2&t){const t=h.mc(2);h.Kb(1),h.sc("value",t.group)}}function T(t,c){1&t&&(h.cc(0,"small",26),h.Lc(1," Role is required "),h.bc())}function X(t,c){if(1&t&&(h.ac(0),h.Xb(1,"ng-select",28),h.Jc(2,T,2,0,"small",15),h.Zb()),2&t){const t=h.mc(2);h.Kb(1),h.sc("items",t.groupList),h.Kb(1),h.sc("ngIf",t.invalid("group_id")&&t.f.group_id.hasError("required"))}}const U=function(t){return{"is-invalid":t}};function G(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Username\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,A,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"Password\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"input",16),h.Jc(19,N,2,0,"small",15),h.Jc(20,w,2,0,"small",15),h.Jc(21,M,2,0,"small",15),h.bc(),h.bc(),h.cc(22,"div",10),h.cc(23,"label",11),h.Lc(24,"Email"),h.bc(),h.cc(25,"div",13),h.Xb(26,"input",17),h.Jc(27,B,2,0,"small",15),h.bc(),h.bc(),h.cc(28,"div",10),h.cc(29,"label",11),h.Lc(30,"First name"),h.bc(),h.cc(31,"div",13),h.Xb(32,"input",18),h.bc(),h.bc(),h.cc(33,"div",10),h.cc(34,"label",11),h.Lc(35,"Last name"),h.bc(),h.cc(36,"div",13),h.Xb(37,"input",19),h.bc(),h.bc(),h.cc(38,"div",10),h.cc(39,"label",11),h.Lc(40,"Role\xa0"),h.cc(41,"span",12),h.Lc(42,"*"),h.bc(),h.bc(),h.cc(43,"div",13),h.Jc(44,P,2,1,"ng-container",20),h.Jc(45,X,3,2,"ng-container",20),h.bc(),h.bc(),h.bc(),h.cc(46,"div",21),h.cc(47,"button",22),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(48,"i",23),h.Lc(49," Back"),h.bc(),h.cc(50,"button",24),h.Xb(51,"i",25),h.Lc(52," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(11,U,t.invalid("username"))),h.Kb(1),h.sc("ngIf",t.invalid("username")&&t.f.username.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(13,U,t.invalid("password"))),h.Kb(1),h.sc("ngIf",t.invalid("password")&&t.f.password.hasError("required")),h.Kb(1),h.sc("ngIf",t.invalid("password")&&t.f.password.hasError("minLength")),h.Kb(1),h.sc("ngIf",t.invalid("password")&&t.f.password.hasError("maxLength")),h.Kb(5),h.sc("ngClass",h.vc(15,U,t.invalid("email"))),h.Kb(1),h.sc("ngIf",t.invalid("email")&&t.f.email.hasError("email")),h.Kb(17),h.sc("ngIf",t.lockGroup),h.Kb(1),h.sc("ngIf",!t.lockGroup)}}let W=(()=>{class t extends I.a{constructor(t,c,i,s,e,r){super(),this.fb=t,this.route=c,this.router=i,this.lookupService=s,this.userService=e,this.toastr=r,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.lockGroup=!1,this.groupList=[],this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({username:["",[e.r.required]],password:["",[e.r.required,e.r.minLength(6),e.r.maxLength(8)]],email:["",[e.r.email]],first_name:[""],last_name:[""],group_id:[null,[e.r.required]]})}setForm(){const t=this.data;this.lockGroup=t.assigned;const c=t.groups;let i=0;u.a.isEmpty(c)||(i=c[0].id),this.mform.patchValue({username:t.username,password:"********",email:t.email,first_name:t.first_name,last_name:t.last_name,group_id:i})}load(){this.isLoading=!0,this.lookupService.listGroup().subscribe(t=>{this.groupList=t,this.loadDetails()},t=>{this.isLoading=!1})}loadDetails(){K.a.isNull(this.id)||K.a.isUndefined(this.id)?this.isLoading=!1:this.userService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/setup/user/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={username:t.username,password:t.password,email:t.email,first_name:t.first_name,last_name:t.last_name};this.lockGroup||(c.group_id=t.group_id),this.isEdit?this.userService.update(this.data.id,c).subscribe(t=>{this.toastr.success("User successfully updated")}):this.userService.create(c).subscribe(t=>{this.toastr.success("New User successfully created"),this.mform.reset()})}get group(){const t=this.data.groups;let c="";return u.a.isEmpty(t)||(c=t[0].name),c}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(x.a),h.Wb(g),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-user-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Username","name","username","formControlName","username",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Password","name","password","formControlName","password",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control",3,"ngClass"],["type","text","placeholder","First name","name","first_name","formControlName","first_name",1,"form-control"],["type","text","placeholder","Last name","name","last_name","formControlName","last_name",1,"form-control"],[4,"ngIf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"],["type","text","readonly","",1,"form-control",3,"value"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","group_id","name","group_id",3,"items"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit User"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,G,53,17,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k,r.a],styles:[""]}),t})();var O=i("mrcu");function R(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function $(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td",23),h.cc(6,"button",24),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(7,"i",25),h.bc(),h.cc(8,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(9,"i",27),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.iso_code)}}function J(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.Xb(8,"th"),h.bc(),h.bc(),h.cc(9,"tbody"),h.Jc(10,$,10,2,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","ISO Code")("sort","iso_code")("dir",t.sortDir)("current",t.sort),h.Kb(3),h.sc("ngForOf",t.list)}}function q(t,c){if(1&t){const t=h.dc();h.cc(0,"div",28),h.cc(1,"div",29),h.cc(2,"pagination",30),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let F=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.countryService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.country.country-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.countryService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.countryService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/country/"+t])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Country",message:`Are you sure to delete this Country ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.countryService.remove(t.id).subscribe(t=>{this.toastr.success("Country successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(O.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-country-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Country Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,R,3,0,"div",15),h.Jc(19,J,11,9,"div",16),h.bc(),h.Jc(20,q,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function Z(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," Name is required "),h.bc())}function H(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," ISO Code is required "),h.bc())}const z=function(t){return{"is-invalid":t}};function j(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,Z,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"ISO Code\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"input",16),h.Jc(19,H,2,0,"small",15),h.bc(),h.bc(),h.bc(),h.cc(20,"div",17),h.cc(21,"button",18),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(22,"i",19),h.Lc(23," Back"),h.bc(),h.cc(24,"button",20),h.Xb(25,"i",21),h.Lc(26," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(5,z,t.invalid("name"))),h.Kb(1),h.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(7,z,t.invalid("iso_code"))),h.Kb(1),h.sc("ngIf",t.invalid("iso_code")&&t.f.iso_code.hasError("required"))}}let V=(()=>{class t extends I.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.countryService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],iso_code:["",[e.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,iso_code:t.iso_code})}load(){K.a.isNull(this.id)||K.a.isUndefined(this.id)||(this.isLoading=!0,this.countryService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/setup/country/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,iso_code:t.iso_code};this.isEdit?this.countryService.update(this.data.id,c).subscribe(t=>{this.toastr.success("Country successfully updated")}):this.countryService.create(c).subscribe(t=>{this.toastr.success("New Country successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(O.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-country-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","ISO Code","name","iso_code","formControlName","iso_code",1,"form-control",3,"ngClass"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit Country"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,j,27,9,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k],styles:[""]}),t})();var Q=i("Thox");function Y(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function tt(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td",23),h.cc(6,"button",24),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(7,"i",25),h.bc(),h.cc(8,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(9,"i",27),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.country.name)}}function ct(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.Xb(8,"th"),h.bc(),h.bc(),h.cc(9,"tbody"),h.Jc(10,tt,10,2,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Country")("sort","country__name")("dir",t.sortDir)("current",t.sort),h.Kb(3),h.sc("ngForOf",t.list)}}function it(t,c){if(1&t){const t=h.dc();h.cc(0,"div",28),h.cc(1,"div",29),h.cc(2,"pagination",30),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let st=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.stateService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.state.state-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.stateService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.stateService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/state/"+t])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete State",message:`Are you sure to delete this State ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.stateService.remove(t.id).subscribe(t=>{this.toastr.success("State successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(Q.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-state-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"State Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,Y,3,0,"div",15),h.Jc(19,ct,11,9,"div",16),h.bc(),h.Jc(20,it,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function et(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," Name is required "),h.bc())}function rt(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," Country is required "),h.bc())}const nt=function(t){return{"is-invalid":t}};function ot(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,et,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"Country\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"ng-select",16),h.Jc(19,rt,2,0,"small",15),h.bc(),h.bc(),h.bc(),h.cc(20,"div",17),h.cc(21,"button",18),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(22,"i",19),h.Lc(23," Back"),h.bc(),h.cc(24,"button",20),h.Xb(25,"i",21),h.Lc(26," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(5,nt,t.invalid("name"))),h.Kb(1),h.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),h.Kb(7),h.sc("items",t.countryList),h.Kb(1),h.sc("ngIf",t.invalid("country_id")&&t.f.country_id.hasError("required"))}}let at=(()=>{class t extends I.a{constructor(t,c,i,s,e,r){super(),this.fb=t,this.route=c,this.router=i,this.lookupService=s,this.stateService=e,this.toastr=r,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.countryList=[],this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],country_id:[null,[e.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,country_id:t.country.id})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(t=>{this.countryList=t,this.loadDetails()},t=>{this.isLoading=!1})}loadDetails(){K.a.isNull(this.id)||K.a.isUndefined(this.id)?this.isLoading=!1:this.stateService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/setup/state/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,country_id:t.country_id};this.isEdit?this.stateService.update(this.data.id,c).subscribe(t=>{this.toastr.success("State successfully updated")}):this.stateService.create(c).subscribe(t=>{this.toastr.success("New State successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(x.a),h.Wb(Q.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-state-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit State"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,ot,27,7,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k,r.a],styles:[""]}),t})();var dt=i("DLVw");function bt(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function lt(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td"),h.Lc(8),h.bc(),h.cc(9,"td"),h.Lc(10),h.bc(),h.cc(11,"td"),h.Lc(12),h.bc(),h.cc(13,"td"),h.Lc(14),h.bc(),h.cc(15,"td"),h.Lc(16),h.bc(),h.cc(17,"td"),h.Lc(18),h.bc(),h.cc(19,"td"),h.Lc(20),h.bc(),h.cc(21,"td"),h.cc(22,"button",23),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onTruck(i)})),h.Xb(23,"i",24),h.bc(),h.bc(),h.cc(24,"td"),h.cc(25,"button",23),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDriver(i)})),h.Xb(26,"i",25),h.bc(),h.bc(),h.cc(27,"td"),h.cc(28,"button",23),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onUser(i)})),h.Xb(29,"i",26),h.bc(),h.bc(),h.cc(30,"td",27),h.cc(31,"button",28),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(32,"i",29),h.bc(),h.cc(33,"button",30),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(34,"i",31),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.registration_num),h.Kb(2),h.Mc(t.contact_no),h.Kb(2),h.Mc(t.email),h.Kb(2),h.Mc(t.fax_no),h.Kb(2),h.Mc(t.addr_line_1),h.Kb(2),h.Mc(t.postcode),h.Kb(2),h.Mc(t.city),h.Kb(2),h.Mc(t.state.name),h.Kb(2),h.Mc(t.country.name)}}function ut(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(10,"th"),h.cc(11,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(12,"th"),h.cc(13,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(14,"th"),h.cc(15,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(16,"th"),h.cc(17,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(18,"th"),h.cc(19,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(20,"th"),h.cc(21,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(22,"th"),h.cc(23,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(24,"th"),h.Lc(25,"Trucks"),h.bc(),h.cc(26,"th"),h.Lc(27,"Drivers"),h.bc(),h.cc(28,"th"),h.Lc(29,"Users"),h.bc(),h.Xb(30,"th"),h.bc(),h.bc(),h.cc(31,"tbody"),h.Jc(32,lt,35,10,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Business Reg. No.")("sort","registration_num")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Contact No.")("sort","contact_no")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Fax No.")("sort","fax_no")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Address 1")("sort","addr_line_1")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Postcode")("sort","pstcode")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","City")("sort","city")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","State")("sort","state__name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Country")("sort","country__name")("dir",t.sortDir)("current",t.sort),h.Kb(9),h.sc("ngForOf",t.list)}}function ht(t,c){if(1&t){const t=h.dc();h.cc(0,"div",32),h.cc(1,"div",33),h.cc(2,"pagination",34),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let mt=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.buyerService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.buyer-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.buyerService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.buyerService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/buyer/"+t])}onTruck(t){this.goto(`truck/${t.id}/list`)}onDriver(t){this.goto(`driver/${t.id}/list`)}onUser(t){this.goto(`user/${t.id}/list`)}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Buyer",message:`Are you sure to delete this Buyer ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.buyerService.remove(t.id).subscribe(t=>{this.toastr.success("Buyer successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(dt.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-buyer-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-truck"],[1,"fas","fa-id-card"],[1,"fas","fa-user"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Buyer Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,bt,3,0,"div",15),h.Jc(19,ut,33,41,"div",16),h.bc(),h.Jc(20,ht,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function pt(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Name is required "),h.bc())}function gt(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Business Registration No. is required "),h.bc())}function ft(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Contact No. is required "),h.bc())}function vt(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Address 1 is required "),h.bc())}function yt(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Postcode is required "),h.bc())}function _t(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," City is required "),h.bc())}function St(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," State is required "),h.bc())}function Lt(t,c){1&t&&(h.cc(0,"small",36),h.Lc(1," Country is required "),h.bc())}const kt=function(t){return{"is-invalid":t}};function Et(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,pt,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"Business Registration No.\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"input",16),h.Jc(19,gt,2,0,"small",15),h.bc(),h.bc(),h.cc(20,"div",10),h.cc(21,"label",11),h.Lc(22,"Contact No.\xa0"),h.cc(23,"span",12),h.Lc(24,"*"),h.bc(),h.bc(),h.cc(25,"div",13),h.Xb(26,"input",17),h.Jc(27,ft,2,0,"small",15),h.bc(),h.bc(),h.cc(28,"div",10),h.cc(29,"label",11),h.Lc(30,"Email"),h.bc(),h.cc(31,"div",13),h.Xb(32,"input",18),h.bc(),h.bc(),h.cc(33,"div",10),h.cc(34,"label",11),h.Lc(35,"Fax No."),h.bc(),h.cc(36,"div",13),h.Xb(37,"input",19),h.bc(),h.bc(),h.cc(38,"div",10),h.cc(39,"label",11),h.Lc(40,"Address\xa0"),h.cc(41,"span",12),h.Lc(42,"*"),h.bc(),h.bc(),h.cc(43,"div",13),h.Xb(44,"input",20),h.Jc(45,vt,2,0,"small",15),h.bc(),h.bc(),h.cc(46,"div",10),h.cc(47,"div",21),h.Xb(48,"input",22),h.bc(),h.bc(),h.cc(49,"div",10),h.cc(50,"div",21),h.Xb(51,"input",23),h.bc(),h.bc(),h.cc(52,"div",10),h.cc(53,"label",11),h.Lc(54,"Postcode\xa0"),h.cc(55,"span",12),h.Lc(56,"*"),h.bc(),h.bc(),h.cc(57,"div",24),h.Xb(58,"input",25),h.Jc(59,yt,2,0,"small",15),h.bc(),h.cc(60,"label",26),h.Lc(61,"City\xa0"),h.cc(62,"span",12),h.Lc(63,"*"),h.bc(),h.bc(),h.cc(64,"div",27),h.Xb(65,"input",28),h.Jc(66,_t,2,0,"small",15),h.bc(),h.bc(),h.cc(67,"div",10),h.cc(68,"label",11),h.Lc(69,"State\xa0"),h.cc(70,"span",12),h.Lc(71,"*"),h.bc(),h.bc(),h.cc(72,"div",24),h.Xb(73,"ng-select",29),h.Jc(74,St,2,0,"small",15),h.bc(),h.cc(75,"label",26),h.Lc(76,"Country\xa0"),h.cc(77,"span",12),h.Lc(78,"*"),h.bc(),h.bc(),h.cc(79,"div",27),h.cc(80,"ng-select",30),h.kc("change",(function(c){return h.Dc(t),h.mc().onChangeCountry(c)})),h.bc(),h.Jc(81,Lt,2,0,"small",15),h.bc(),h.bc(),h.bc(),h.cc(82,"div",31),h.cc(83,"button",32),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(84,"i",33),h.Lc(85," Back"),h.bc(),h.cc(86,"button",34),h.Xb(87,"i",35),h.Lc(88," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(17,kt,t.invalid("name"))),h.Kb(1),h.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(19,kt,t.invalid("registration_num"))),h.Kb(1),h.sc("ngIf",t.invalid("registration_num")&&t.f.registration_num.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(21,kt,t.invalid("contact_no"))),h.Kb(1),h.sc("ngIf",t.invalid("contact_no")&&t.f.contact_no.hasError("required")),h.Kb(17),h.sc("ngClass",h.vc(23,kt,t.invalid("addr_line_1"))),h.Kb(1),h.sc("ngIf",t.invalid("addr_line_1")&&t.f.addr_line_1.hasError("required")),h.Kb(13),h.sc("ngClass",h.vc(25,kt,t.invalid("postcode"))),h.Kb(1),h.sc("ngIf",t.invalid("postcode")&&t.f.postcode.hasError("required")),h.Kb(6),h.sc("ngClass",h.vc(27,kt,t.invalid("city"))),h.Kb(1),h.sc("ngIf",t.invalid("city")&&t.f.city.hasError("required")),h.Kb(7),h.sc("items",t.stateList),h.Kb(1),h.sc("ngIf",t.invalid("state_id")&&t.f.state_id.hasError("required")),h.Kb(6),h.sc("items",t.countryList),h.Kb(1),h.sc("ngIf",t.invalid("country_id")&&t.f.country_id.hasError("required"))}}let Ct=(()=>{class t extends I.a{constructor(t,c,i,s,e,r){super(),this.fb=t,this.route=c,this.router=i,this.lookupService=s,this.buyerService=e,this.toastr=r,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],registration_num:["",[e.r.required]],contact_no:["",[e.r.required]],email:[""],fax_no:[""],addr_line_1:["",[e.r.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[e.r.required]],city:["",[e.r.required]],state_id:[null,[e.r.required]],country_id:[null,[e.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,registration_num:t.registration_num,contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,country_id:t.country.id}),this.lookupService.listStates(t.country.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({state_id:t.state.id})})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(t=>{this.countryList=t,this.mform.patchValue({country_id:this.countryList[0].id}),this.onChangeCountry(this.countryList[0]),this.loadDetails()},t=>{this.isLoading=!1})}loadDetails(){K.a.isNull(this.id)||K.a.isUndefined(this.id)?this.isLoading=!1:this.buyerService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,registration_num:t.registration_num,contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,state_id:t.state_id,country_id:t.country_id};this.isEdit?this.buyerService.update(this.data.id,c).subscribe(t=>{this.toastr.success("Buyer successfully updated")}):this.buyerService.create(c).subscribe(t=>{this.toastr.success("New Buyer successfully created"),this.mform.reset()})}onChangeCountry(t){this.lookupService.listStates(t.id).subscribe(t=>{this.stateList=t,this.mform.patchValue({state_id:null})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(x.a),h.Wb(dt.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-buyer-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit Buyer"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,Et,89,29,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k,r.a],styles:[""]}),t})();var Dt=i("lSWO");function Kt(t,c){1&t&&(h.cc(0,"div",20),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function It(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td",25),h.cc(4,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(5,"i",27),h.bc(),h.cc(6,"button",28),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(7,"i",29),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.registration_num)}}function xt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",21),h.cc(1,"table",22),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",23),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.Xb(6,"th"),h.bc(),h.bc(),h.cc(7,"tbody"),h.Jc(8,It,8,1,"tr",24),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Registration No.")("sort","registration_num")("dir",t.sortDir)("current",t.sort),h.Kb(3),h.sc("ngForOf",t.list)}}function At(t,c){if(1&t){const t=h.dc();h.cc(0,"div",30),h.cc(1,"div",31),h.cc(2,"pagination",32),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let Nt=(()=>{class t{constructor(t,c,i,s,e,r,n){this.route=t,this.router=c,this.truckService=i,this.buyerService=s,this.msService=e,this.toastr=r,this.modalService=n,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="registration_num",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.truck-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){""===this.search?(this.isLoading=!0,this.truckService.list(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.truckService.search(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="registration_num",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate([`/ams/setup/buyer/truck/${this.buyer_id}/${t}`])}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Truck",message:`Are you sure to delete this Truck ${t.registration_num} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.truckService.remove(this.buyer_id,t.id).subscribe(t=>{this.toastr.success("Truck successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.a),h.Wb(d.g),h.Wb(Dt.a),h.Wb(dt.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-truck-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.onBack()})),h.Xb(15,"i",13),h.Lc(16," Back"),h.bc(),h.cc(17,"button",14),h.kc("click",(function(){return c.goto("create")})),h.Xb(18,"i",15),h.Lc(19," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(20,"div",16),h.Jc(21,Kt,3,0,"div",17),h.Jc(22,xt,9,5,"div",18),h.bc(),h.Jc(23,At,3,4,"div",19),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(5),h.Nc("Truck Listing ",c.buyer,""),h.Kb(7),h.sc("search",c.search),h.Kb(9),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function wt(t,c){1&t&&(h.cc(0,"div",3),h.cc(1,"div",18),h.cc(2,"div",19),h.cc(3,"h1",20),h.Lc(4,"Add / Edit Truck"),h.bc(),h.bc(),h.bc(),h.bc())}function Mt(t,c){1&t&&(h.cc(0,"small",21),h.Lc(1," Registration No. is required "),h.bc())}const Bt=function(t){return{"is-invalid":t}};let Pt=(()=>{class t extends I.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.truckService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),this.buyer_id=t.get("buyer_id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({registration_num:["",[e.r.required]]})}setForm(){this.mform.patchValue({registration_num:this.data.registration_num})}load(){K.a.isNull(this.id)||K.a.isUndefined(this.id)||(this.isLoading=!0,this.truckService.edit(this.buyer_id,this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate([`/ams/setup/buyer/truck/${this.buyer_id}/list`])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t={registration_num:this.mform.value.registration_num,buyer_id:this.buyer_id};this.isEdit?this.truckService.update(this.buyer_id,this.data.id,t).subscribe(t=>{this.toastr.success("Truck successfully updated")}):this.truckService.create(this.buyer_id,t).subscribe(t=>{this.toastr.success("New Truck successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(Dt.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-truck-create"]],features:[h.Hb],decls:22,vars:6,consts:[[1,"content-header"],["class","container-fluid",4,"ngIf"],[1,"content"],[1,"container-fluid"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.Jc(1,wt,5,0,"div",1),h.bc(),h.cc(2,"section",2),h.cc(3,"div",3),h.cc(4,"form",4),h.kc("ngSubmit",(function(){return c.onSubmit()})),h.cc(5,"div",5),h.cc(6,"div",6),h.cc(7,"div",7),h.cc(8,"label",8),h.Lc(9,"Registration No.\xa0"),h.cc(10,"span",9),h.Lc(11,"*"),h.bc(),h.bc(),h.cc(12,"div",10),h.Xb(13,"input",11),h.Jc(14,Mt,2,0,"small",12),h.bc(),h.bc(),h.bc(),h.cc(15,"div",13),h.cc(16,"button",14),h.kc("click",(function(){return c.onBack()})),h.Xb(17,"i",15),h.Lc(18," Back"),h.bc(),h.cc(19,"button",16),h.Xb(20,"i",17),h.Lc(21," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(1),h.sc("ngIf",!c.isLoading),h.Kb(3),h.sc("formGroup",c.mform),h.Kb(9),h.sc("ngClass",h.vc(4,Bt,c.invalid("registration_num"))),h.Kb(1),h.sc("ngIf",c.invalid("registration_num")&&c.f.registration_num.hasError("required")))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k],styles:[""]}),t})();var Tt=i("kny6");function Xt(t,c){1&t&&(h.cc(0,"div",20),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function Ut(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td",25),h.cc(6,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(7,"i",27),h.bc(),h.cc(8,"button",28),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(9,"i",29),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.id_num)}}function Gt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",21),h.cc(1,"table",22),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",23),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",23),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.Xb(8,"th"),h.bc(),h.bc(),h.cc(9,"tbody"),h.Jc(10,Ut,10,2,"tr",24),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","ID Number")("sort","id_num")("dir",t.sortDir)("current",t.sort),h.Kb(3),h.sc("ngForOf",t.list)}}function Wt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",30),h.cc(1,"div",31),h.cc(2,"pagination",32),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let Ot=(()=>{class t{constructor(t,c,i,s,e,r,n){this.route=t,this.router=c,this.driverService=i,this.buyerService=s,this.msService=e,this.toastr=r,this.modalService=n,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.buyer.driver-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){""===this.search?(this.isLoading=!0,this.driverService.list(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.driverService.search(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate([`/ams/setup/buyer/driver/${this.buyer_id}/${t}`])}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Driver",message:`Are you sure to delete this Driver ${t.id_num} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.driverService.remove(this.buyer_id,t.id).subscribe(t=>{this.toastr.success("Driver successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.a),h.Wb(d.g),h.Wb(Tt.a),h.Wb(dt.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-driver-listing"]],decls:24,vars:5,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.onBack()})),h.Xb(15,"i",13),h.Lc(16," Back"),h.bc(),h.cc(17,"button",14),h.kc("click",(function(){return c.goto("create")})),h.Xb(18,"i",15),h.Lc(19," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(20,"div",16),h.Jc(21,Xt,3,0,"div",17),h.Jc(22,Gt,11,9,"div",18),h.bc(),h.Jc(23,Wt,3,4,"div",19),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(5),h.Nc("Driver Listing ",c.buyer,""),h.Kb(7),h.sc("search",c.search),h.Kb(9),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function Rt(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," Name is required "),h.bc())}function $t(t,c){1&t&&(h.cc(0,"small",22),h.Lc(1," ID No. is required "),h.bc())}const Jt=function(t){return{"is-invalid":t}};function qt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,Rt,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"ID No.\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"input",16),h.Jc(19,$t,2,0,"small",15),h.bc(),h.bc(),h.bc(),h.cc(20,"div",17),h.cc(21,"button",18),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(22,"i",19),h.Lc(23," Back"),h.bc(),h.cc(24,"button",20),h.Xb(25,"i",21),h.Lc(26," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(5,Jt,t.invalid("name"))),h.Kb(1),h.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(7,Jt,t.invalid("id_num"))),h.Kb(1),h.sc("ngIf",t.invalid("id_num")&&t.f.id_num.hasError("required"))}}let Ft=(()=>{class t extends I.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.driverService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),this.buyer_id=t.get("buyer_id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],id_num:["",[e.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,id_num:t.id_num})}load(){K.a.isNull(this.id)||K.a.isUndefined(this.id)||(this.isLoading=!0,this.driverService.edit(this.buyer_id,this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate([`/ams/setup/buyer/driver/${this.buyer_id}/list`])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,id_num:t.id_num,buyer_id:this.buyer_id};this.isEdit?this.driverService.update(this.buyer_id,this.data.id,c).subscribe(t=>{this.toastr.success("Driver successfully updated")}):this.driverService.create(this.buyer_id,c).subscribe(t=>{this.toastr.success("New Driver successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(Tt.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-driver-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","ID No.","name","id_num","formControlName","id_num",1,"form-control",3,"ngClass"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit Driver"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,qt,27,9,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k],styles:[""]}),t})(),Zt=(()=>{class t{constructor(t){this.http=t,this.baseUrl=p.a.baseUrl}listPending(t,c,i,s){let e=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),e=e.append("sort",`${i}:${s}`)),this.http.get(this.baseUrl+"/api/assign/buyers",{params:e,observe:"response"})}searchPending(t,c,i,s,e){let r=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),r=r.append("sort",`${i}:${s}`)),this.http.post(this.baseUrl+"/api/assign/buyers",{keyword:e},{params:r,observe:"response"})}listActive(t,c,i,s,e){let r=(new m.f).set("_page",c).set("_limit",i);return""!==s&&(""===e&&(e="asc"),r=r.append("sort",`${s}:${e}`)),this.http.get(`${this.baseUrl}/api/assigned/buyers/${t}`,{params:r,observe:"response"})}searchActive(t,c,i,s,e,r){let n=(new m.f).set("_page",c).set("_limit",i);return""!==s&&(""===e&&(e="asc"),n=n.append("sort",`${s}:${e}`)),this.http.post(`${this.baseUrl}/api/assigned/buyers/${t}`,{keyword:r},{params:n,observe:"response"})}assign(t){return this.http.post(this.baseUrl+"/api/assigned/buyer",t)}remove(t){return this.http.post(this.baseUrl+"/api/assigned/buyer/delete",t)}}return t.\u0275fac=function(c){return new(c||t)(h.gc(m.b))},t.\u0275prov=h.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Ht(t,c){1&t&&(h.cc(0,"div",21),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function zt(t,c){if(1&t){const t=h.dc();h.ac(0),h.cc(1,"button",28),h.kc("click",(function(){h.Dc(t);const c=h.mc().$implicit;return h.mc(2).onAssign(c)})),h.Xb(2,"i",29),h.bc(),h.Zb()}}function jt(t,c){if(1&t){const t=h.dc();h.ac(0),h.cc(1,"button",30),h.kc("click",(function(){h.Dc(t);const c=h.mc().$implicit;return h.mc(2).onDelete(c)})),h.Xb(2,"i",31),h.bc(),h.Zb()}}function Vt(t,c){if(1&t&&(h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td"),h.Lc(8),h.bc(),h.cc(9,"td"),h.Lc(10),h.bc(),h.cc(11,"td",26),h.Jc(12,zt,3,0,"ng-container",27),h.Jc(13,jt,3,0,"ng-container",27),h.bc(),h.bc()),2&t){const t=c.$implicit,i=h.mc(2);h.Kb(2),h.Mc(t.username),h.Kb(2),h.Mc(t.email),h.Kb(2),h.Mc(t.first_name),h.Kb(2),h.Mc(t.last_name),h.Kb(2),h.Mc(i.getUserRoles(t)),h.Kb(2),h.sc("ngIf",0===i.tab),h.Kb(1),h.sc("ngIf",1===i.tab)}}function Qt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",22),h.cc(1,"table",23),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(10,"th"),h.cc(11,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(12,"th"),h.Lc(13,"Role"),h.bc(),h.Xb(14,"th"),h.bc(),h.bc(),h.cc(15,"tbody"),h.Jc(16,Vt,14,7,"tr",25),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Username")("sort","username")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","First name")("sort","first_name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Last name")("sort","last_name")("dir",t.sortDir)("current",t.sort),h.Kb(5),h.sc("ngForOf",t.list)}}function Yt(t,c){if(1&t){const t=h.dc();h.cc(0,"div",32),h.cc(1,"div",33),h.cc(2,"pagination",34),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}const tc=function(t){return{active:t}};let cc=(()=>{class t{constructor(t,c,i,s,e,r,n){this.route=t,this.router=c,this.userService=i,this.buyerService=s,this.msService=e,this.toastr=r,this.modalService=n,this.buyer="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="username",this.sortDir="asc",this.tab=0,this.sx=0,this.sy=0,this.uiState="setup.buyer.user-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.buyer_id=t.get("buyer_id"),this.isLoading=!0,this.loadBuyer()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadBuyer(){this.buyerService.edit(this.buyer_id).subscribe(t=>{this.buyer=" - "+t.name,this.load()})}load(){if(""!==this.search)return void this.onSearch(this.search);this.isLoading=!0;let t=null;t=0===this.tab?this.userService.listPending(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir):this.userService.listActive(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir),t.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}onSearch(t){this.search=t,this.isLoading=!0;let c=null;c=0===this.tab?this.userService.searchPending(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t):this.userService.searchActive(this.buyer_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t),c.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="username",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}onTab(t){return this.tab!==t&&(this.page=1),this.tab=t,this.load(),!1}onBack(){this.router.navigate(["/ams/setup/buyer/list"])}onAssign(t){this.userService.assign({buyer_id:this.buyer_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully assigned"),this.load()})}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete User from "+this._buyer,message:`Are you sure to delete this User ${t.username} from ${this._buyer} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.userService.remove({buyer_id:this.buyer_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully deleted"),this.load()})})}getUserRoles(t){return t.groups.map(t=>t.name).join(", ")}get _buyer(){return this.buyer.replace(" - ","")}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.a),h.Wb(d.g),h.Wb(Zt),h.Wb(dt.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-user-listing"]],decls:28,vars:11,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"fas","fa-chevron-circle-left"],[1,"card-body"],["role","tablist",1,"nav","nav-tabs"],[1,"nav-item"],["data-toggle","pill","href","#","role","tab",1,"nav-link",3,"ngClass","click"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],[4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.onBack()})),h.Xb(15,"i",13),h.Lc(16," Back"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.cc(18,"ul",15),h.cc(19,"li",16),h.cc(20,"a",17),h.kc("click",(function(){return c.onTab(0)})),h.Lc(21,"Pending"),h.bc(),h.bc(),h.cc(22,"li",16),h.cc(23,"a",17),h.kc("click",(function(){return c.onTab(1)})),h.Lc(24,"Active"),h.bc(),h.bc(),h.bc(),h.Jc(25,Ht,3,0,"div",18),h.Jc(26,Qt,17,17,"div",19),h.bc(),h.Jc(27,Yt,3,4,"div",20),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(5),h.Nc("User Listing ",c.buyer,""),h.Kb(7),h.sc("search",c.search),h.Kb(8),h.sc("ngClass",h.vc(7,tc,0===c.tab)),h.Kb(3),h.sc("ngClass",h.vc(9,tc,1===c.tab)),h.Kb(2),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.k,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();var ic=i("a+IK");function sc(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function ec(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td"),h.Lc(8),h.bc(),h.cc(9,"td"),h.Lc(10),h.bc(),h.cc(11,"td"),h.Lc(12),h.bc(),h.cc(13,"td"),h.Lc(14),h.bc(),h.cc(15,"td"),h.Lc(16),h.bc(),h.cc(17,"td"),h.Lc(18),h.bc(),h.cc(19,"td"),h.Lc(20),h.bc(),h.cc(21,"td"),h.cc(22,"button",23),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onUser(i)})),h.Xb(23,"i",24),h.bc(),h.bc(),h.cc(24,"td",25),h.cc(25,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(26,"i",27),h.bc(),h.cc(27,"button",28),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(28,"i",29),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.registration_num),h.Kb(2),h.Mc(t.contact_no),h.Kb(2),h.Mc(t.email),h.Kb(2),h.Mc(t.fax_no),h.Kb(2),h.Mc(t.addr_line_1),h.Kb(2),h.Mc(t.postcode),h.Kb(2),h.Mc(t.city),h.Kb(2),h.Mc(t.state.name),h.Kb(2),h.Mc(t.country.name)}}function rc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(10,"th"),h.cc(11,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(12,"th"),h.cc(13,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(14,"th"),h.cc(15,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(16,"th"),h.cc(17,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(18,"th"),h.cc(19,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(20,"th"),h.cc(21,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(22,"th"),h.cc(23,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(24,"th"),h.Lc(25,"Users"),h.bc(),h.Xb(26,"th"),h.bc(),h.bc(),h.cc(27,"tbody"),h.Jc(28,ec,29,10,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Business Reg. No.")("sort","registration_num")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Contact No.")("sort","contact_no")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Fax No.")("sort","fax_no")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Address 1")("sort","addr_line_1")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Postcode")("sort","pstcode")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","City")("sort","city")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","State")("sort","state__name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Country")("sort","country__name")("dir",t.sortDir)("current",t.sort),h.Kb(5),h.sc("ngForOf",t.list)}}function nc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",30),h.cc(1,"div",31),h.cc(2,"pagination",32),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let oc=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.miningCompanyService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.mining-company.mining-company-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.miningCompanyService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.miningCompanyService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/mining-company/"+t])}onUser(t){this.goto(`user/${t.id}/list`)}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Mining Company",message:`Are you sure to delete this Mining Company ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.miningCompanyService.remove(t.id).subscribe(t=>{this.toastr.success("Mining Company successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(ic.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-mining-company-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-user"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Mining Company Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,sc,3,0,"div",15),h.Jc(19,rc,29,41,"div",16),h.bc(),h.Jc(20,nc,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function ac(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Name is required "),h.bc())}function dc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Business Registration No. is required "),h.bc())}function bc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Mining License No. is required "),h.bc())}function lc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Contact No. is required "),h.bc())}function uc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Address 1 is required "),h.bc())}function hc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Postcode is required "),h.bc())}function mc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," City is required "),h.bc())}function pc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," State is required "),h.bc())}function gc(t,c){1&t&&(h.cc(0,"small",44),h.Lc(1," Country is required "),h.bc())}const fc=function(t){return{"is-invalid":t}},vc=function(){return{containerClass:"theme-blue",dateInputFormat:"YYYY-MM-DD"}};function yc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,ac,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"Business Registration No.\xa0"),h.cc(15,"span",12),h.Lc(16,"*"),h.bc(),h.bc(),h.cc(17,"div",13),h.Xb(18,"input",16),h.Jc(19,dc,2,0,"small",15),h.bc(),h.bc(),h.cc(20,"div",10),h.cc(21,"label",11),h.Lc(22,"Mining License No.\xa0"),h.cc(23,"span",12),h.Lc(24,"*"),h.bc(),h.bc(),h.cc(25,"div",13),h.Xb(26,"input",17),h.Jc(27,bc,2,0,"small",15),h.bc(),h.bc(),h.cc(28,"div",10),h.cc(29,"label",11),h.Lc(30,"License Expiry\xa0"),h.cc(31,"span",12),h.Lc(32,"*"),h.bc(),h.bc(),h.cc(33,"div",18),h.cc(34,"div",19),h.Xb(35,"input",20,21),h.cc(37,"div",22),h.cc(38,"button",23),h.kc("click",(function(){return h.Dc(t),h.Bc(36).show()})),h.Xb(39,"i",24),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(40,"div",10),h.cc(41,"label",11),h.Lc(42,"Contact No.\xa0"),h.cc(43,"span",12),h.Lc(44,"*"),h.bc(),h.bc(),h.cc(45,"div",13),h.Xb(46,"input",25),h.Jc(47,lc,2,0,"small",15),h.bc(),h.bc(),h.cc(48,"div",10),h.cc(49,"label",11),h.Lc(50,"Email"),h.bc(),h.cc(51,"div",13),h.Xb(52,"input",26),h.bc(),h.bc(),h.cc(53,"div",10),h.cc(54,"label",11),h.Lc(55,"Fax No."),h.bc(),h.cc(56,"div",13),h.Xb(57,"input",27),h.bc(),h.bc(),h.cc(58,"div",10),h.cc(59,"label",11),h.Lc(60,"Address\xa0"),h.cc(61,"span",12),h.Lc(62,"*"),h.bc(),h.bc(),h.cc(63,"div",13),h.Xb(64,"input",28),h.Jc(65,uc,2,0,"small",15),h.bc(),h.bc(),h.cc(66,"div",10),h.cc(67,"div",29),h.Xb(68,"input",30),h.bc(),h.bc(),h.cc(69,"div",10),h.cc(70,"div",29),h.Xb(71,"input",31),h.bc(),h.bc(),h.cc(72,"div",10),h.cc(73,"label",11),h.Lc(74,"Postcode\xa0"),h.cc(75,"span",12),h.Lc(76,"*"),h.bc(),h.bc(),h.cc(77,"div",32),h.Xb(78,"input",33),h.Jc(79,hc,2,0,"small",15),h.bc(),h.cc(80,"label",34),h.Lc(81,"City\xa0"),h.cc(82,"span",12),h.Lc(83,"*"),h.bc(),h.bc(),h.cc(84,"div",35),h.Xb(85,"input",36),h.Jc(86,mc,2,0,"small",15),h.bc(),h.bc(),h.cc(87,"div",10),h.cc(88,"label",11),h.Lc(89,"State\xa0"),h.cc(90,"span",12),h.Lc(91,"*"),h.bc(),h.bc(),h.cc(92,"div",32),h.Xb(93,"ng-select",37),h.Jc(94,pc,2,0,"small",15),h.bc(),h.cc(95,"label",34),h.Lc(96,"Country\xa0"),h.cc(97,"span",12),h.Lc(98,"*"),h.bc(),h.bc(),h.cc(99,"div",35),h.cc(100,"ng-select",38),h.kc("change",(function(c){return h.Dc(t),h.mc().onChangeCountry(c)})),h.bc(),h.Jc(101,gc,2,0,"small",15),h.bc(),h.bc(),h.bc(),h.cc(102,"div",39),h.cc(103,"button",40),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(104,"i",41),h.Lc(105," Back"),h.bc(),h.cc(106,"button",42),h.Xb(107,"i",43),h.Lc(108," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.Bc(36),c=h.mc();h.Kb(1),h.sc("formGroup",c.mform),h.Kb(9),h.sc("ngClass",h.vc(21,fc,c.invalid("name"))),h.Kb(1),h.sc("ngIf",c.invalid("name")&&c.f.name.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(23,fc,c.invalid("registration_num"))),h.Kb(1),h.sc("ngIf",c.invalid("registration_num")&&c.f.registration_num.hasError("required")),h.Kb(7),h.sc("ngClass",h.vc(25,fc,c.invalid("registration_num"))),h.Kb(1),h.sc("ngIf",c.invalid("mining_license_num")&&c.f.mining_license_num.hasError("required")),h.Kb(8),h.sc("bsConfig",h.uc(27,vc)),h.Kb(3),h.Lb("aria-expanded",t.isOpen),h.Kb(8),h.sc("ngClass",h.vc(28,fc,c.invalid("contact_no"))),h.Kb(1),h.sc("ngIf",c.invalid("contact_no")&&c.f.contact_no.hasError("required")),h.Kb(17),h.sc("ngClass",h.vc(30,fc,c.invalid("addr_line_1"))),h.Kb(1),h.sc("ngIf",c.invalid("addr_line_1")&&c.f.addr_line_1.hasError("required")),h.Kb(13),h.sc("ngClass",h.vc(32,fc,c.invalid("postcode"))),h.Kb(1),h.sc("ngIf",c.invalid("postcode")&&c.f.postcode.hasError("required")),h.Kb(6),h.sc("ngClass",h.vc(34,fc,c.invalid("city"))),h.Kb(1),h.sc("ngIf",c.invalid("city")&&c.f.city.hasError("required")),h.Kb(7),h.sc("items",c.stateList),h.Kb(1),h.sc("ngIf",c.invalid("state_id")&&c.f.state_id.hasError("required")),h.Kb(6),h.sc("items",c.countryList),h.Kb(1),h.sc("ngIf",c.invalid("country_id")&&c.f.country_id.hasError("required"))}}let _c=(()=>{class t extends I.a{constructor(t,c,i,s,e,r){super(),this.fb=t,this.route=c,this.router=i,this.lookupService=s,this.miningCompanyService=e,this.toastr=r,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.countryList=[],this.stateList=[],this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],registration_num:["",[e.r.required]],mining_license_num:["",[e.r.required]],mining_license_expiry_date:[null,[e.r.required]],contact_no:["",[e.r.required]],email:[""],fax_no:[""],addr_line_1:["",[e.r.required]],addr_line_2:[""],addr_line_3:[""],postcode:["",[e.r.required]],city:["",[e.r.required]],state_id:[null,[e.r.required]],country_id:[null,[e.r.required]]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,registration_num:t.registration_num,mining_license_num:t.mining_license_num,mining_license_expiry_date:t.mining_license_expiry_date,contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,country_id:t.country.id}),this.lookupService.listStates(t.country.id).subscribe(c=>{this.stateList=c,this.mform.patchValue({state_id:t.state.id})})}load(){this.isLoading=!0,this.lookupService.listCountry().subscribe(t=>{this.countryList=t,this.mform.patchValue({country_id:this.countryList[0].id}),this.onChangeCountry(this.countryList[0]),this.loadDetails()},t=>{this.isLoading=!1})}loadDetails(){K.a.isNull(this.id)||K.a.isUndefined(this.id)?this.isLoading=!1:this.miningCompanyService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1})}onBack(){this.router.navigate(["/ams/setup/mining-company/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,registration_num:t.registration_num,mining_license_num:t.mining_license_num,mining_license_expiry_date:u.a.toDateStr(t.mining_license_expiry_date),contact_no:t.contact_no,email:t.email,fax_no:t.fax_no,addr_line_1:t.addr_line_1,addr_line_2:t.addr_line_2,addr_line_3:t.addr_line_3,postcode:t.postcode,city:t.city,state_id:t.state_id,country_id:t.country_id};this.isEdit?this.miningCompanyService.update(this.data.id,c).subscribe(t=>{this.toastr.success("Mining Company successfully updated")}):this.miningCompanyService.create(c).subscribe(t=>{this.toastr.success("New Mining Company successfully created"),this.mform.reset()})}onChangeCountry(t){this.lookupService.listStates(t.id).subscribe(t=>{this.stateList=t,this.mform.patchValue({state_id:null})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(x.a),h.Wb(ic.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-mining-company-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Business Registration No.","name","registration_num","formControlName","registration_num",1,"form-control",3,"ngClass"],["type","text","placeholder","Mining License No.","name","mining_license_num","formControlName","mining_license_num",1,"form-control",3,"ngClass"],[1,"col-sm-2","col-12"],[1,"input-group","date"],["type","text","placeholder","License Expiry","name","mining_license_expiry_date","formControlName","mining_license_expiry_date","bsDatepicker","",1,"form-control",3,"bsConfig"],["dp1","bsDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-default",3,"click"],[1,"fas","fa-calendar-alt"],["type","text","placeholder","Contact No.","name","contact_no","formControlName","contact_no",1,"form-control",3,"ngClass"],["type","text","placeholder","Email","name","email","formControlName","email",1,"form-control"],["type","text","placeholder","Fax No.","name","fax_no","formControlName","fax_no",1,"form-control"],["type","text","placeholder","Adress 1","name","addr_line_1","formControlName","addr_line_1",1,"form-control",3,"ngClass"],[1,"col-sm-10","offset-sm-2"],["type","text","placeholder","Adress 2","name","addr_line_2","formControlName","addr_line_2",1,"form-control"],["type","text","placeholder","Adress 3","name","addr_line_3","formControlName","addr_line_3",1,"form-control"],[1,"col-sm-3"],["type","text","placeholder","Postcode","name","postcode","formControlName","postcode",1,"form-control",3,"ngClass"],[1,"col-sm-1","col-form-label"],[1,"col-sm-6"],["type","text","placeholder","City","name","city","formControlName","city",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","state_id","name","state_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","Please select","formControlName","country_id","name","country_id",3,"items","change"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit Mining Company"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,yc,109,36,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k,o.b,o.a,r.a],styles:[""]}),t})(),Sc=(()=>{class t{constructor(t){this.http=t,this.baseUrl=p.a.baseUrl}listPending(t,c,i,s){let e=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),e=e.append("sort",`${i}:${s}`)),this.http.get(this.baseUrl+"/api/assign/mining-companies",{params:e,observe:"response"})}searchPending(t,c,i,s,e){let r=(new m.f).set("_page",t).set("_limit",c);return""!==i&&(""===s&&(s="asc"),r=r.append("sort",`${i}:${s}`)),this.http.post(this.baseUrl+"/api/assign/mining-companies",{keyword:e},{params:r,observe:"response"})}listActive(t,c,i,s,e){let r=(new m.f).set("_page",c).set("_limit",i);return""!==s&&(""===e&&(e="asc"),r=r.append("sort",`${s}:${e}`)),this.http.get(`${this.baseUrl}/api/assigned/mining-companies/${t}`,{params:r,observe:"response"})}searchActive(t,c,i,s,e,r){let n=(new m.f).set("_page",c).set("_limit",i);return""!==s&&(""===e&&(e="asc"),n=n.append("sort",`${s}:${e}`)),this.http.post(`${this.baseUrl}/api/assigned/mining-companies/${t}`,{keyword:r},{params:n,observe:"response"})}assign(t){return this.http.post(this.baseUrl+"/api/assigned/mining-company",t)}remove(t){return this.http.post(this.baseUrl+"/api/assigned/mining-company/delete",t)}}return t.\u0275fac=function(c){return new(c||t)(h.gc(m.b))},t.\u0275prov=h.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Lc(t,c){1&t&&(h.cc(0,"div",21),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function kc(t,c){if(1&t){const t=h.dc();h.ac(0),h.cc(1,"button",28),h.kc("click",(function(){h.Dc(t);const c=h.mc().$implicit;return h.mc(2).onAssign(c)})),h.Xb(2,"i",29),h.bc(),h.Zb()}}function Ec(t,c){if(1&t){const t=h.dc();h.ac(0),h.cc(1,"button",30),h.kc("click",(function(){h.Dc(t);const c=h.mc().$implicit;return h.mc(2).onDelete(c)})),h.Xb(2,"i",31),h.bc(),h.Zb()}}function Cc(t,c){if(1&t&&(h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td"),h.Lc(8),h.bc(),h.cc(9,"td"),h.Lc(10),h.bc(),h.cc(11,"td",26),h.Jc(12,kc,3,0,"ng-container",27),h.Jc(13,Ec,3,0,"ng-container",27),h.bc(),h.bc()),2&t){const t=c.$implicit,i=h.mc(2);h.Kb(2),h.Mc(t.username),h.Kb(2),h.Mc(t.email),h.Kb(2),h.Mc(t.first_name),h.Kb(2),h.Mc(t.last_name),h.Kb(2),h.Mc(i.getUserRoles(t)),h.Kb(2),h.sc("ngIf",0===i.tab),h.Kb(1),h.sc("ngIf",1===i.tab)}}function Dc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",22),h.cc(1,"table",23),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(10,"th"),h.cc(11,"app-sort-column",24),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(12,"th"),h.Lc(13,"Role"),h.bc(),h.Xb(14,"th"),h.bc(),h.bc(),h.cc(15,"tbody"),h.Jc(16,Cc,14,7,"tr",25),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Username")("sort","username")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Email")("sort","email")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","First name")("sort","first_name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Last name")("sort","last_name")("dir",t.sortDir)("current",t.sort),h.Kb(5),h.sc("ngForOf",t.list)}}function Kc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",32),h.cc(1,"div",33),h.cc(2,"pagination",34),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}const Ic=function(t){return{active:t}};let xc=(()=>{class t{constructor(t,c,i,s,e,r,n){this.route=t,this.router=c,this.userService=i,this.miningCompanyService=s,this.msService=e,this.toastr=r,this.modalService=n,this.mining_company="",this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="username",this.sortDir="asc",this.tab=0,this.sx=0,this.sy=0,this.uiState="setup.mining-company.user-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS}ngOnInit(){this.route.paramMap.subscribe(t=>{this.mining_company_id=t.get("mining_company_id"),this.isLoading=!0,this.loadMiningCompany()}),this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnDestroy(){this.subs.unsubscribe()}loadMiningCompany(){this.miningCompanyService.edit(this.mining_company_id).subscribe(t=>{this.mining_company=" - "+t.name,this.load()})}load(){if(""!==this.search)return void this.onSearch(this.search);this.isLoading=!0;let t=null;t=0===this.tab?this.userService.listPending(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir):this.userService.listActive(this.mining_company_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir),t.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}onSearch(t){this.search=t,this.isLoading=!0;let c=null;c=0===this.tab?this.userService.searchPending(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t):this.userService.searchActive(this.mining_company_id,this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t),c.subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="username",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}onTab(t){return this.tab!==t&&(this.page=1),this.tab=t,this.load(),!1}onBack(){this.router.navigate(["/ams/setup/mining-company/list"])}onAssign(t){this.userService.assign({mining_company_id:this.mining_company_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully assigned"),this.load()})}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete User from "+this._mining_company,message:`Are you sure to delete this User ${t.username} from ${this._mining_company} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.userService.remove({mining_company_id:this.mining_company_id,user_id:t.id}).subscribe(t=>{this.toastr.success("User successfully deleted"),this.load()})})}getUserRoles(t){return t.groups.map(t=>t.name).join(", ")}get _mining_company(){return this.mining_company.replace(" - ","")}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.a),h.Wb(d.g),h.Wb(Sc),h.Wb(ic.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-user-listing"]],decls:28,vars:11,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"fas","fa-chevron-circle-left"],[1,"card-body"],["role","tablist",1,"nav","nav-tabs"],[1,"nav-item"],["data-toggle","pill","href","#","role","tab",1,"nav-link",3,"ngClass","click"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],[4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.onBack()})),h.Xb(15,"i",13),h.Lc(16," Back"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.cc(18,"ul",15),h.cc(19,"li",16),h.cc(20,"a",17),h.kc("click",(function(){return c.onTab(0)})),h.Lc(21,"Pending"),h.bc(),h.bc(),h.cc(22,"li",16),h.cc(23,"a",17),h.kc("click",(function(){return c.onTab(1)})),h.Lc(24,"Active"),h.bc(),h.bc(),h.bc(),h.Jc(25,Lc,3,0,"div",18),h.Jc(26,Dc,17,17,"div",19),h.bc(),h.Jc(27,Kc,3,4,"div",20),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(5),h.Nc("User Listing ",c.mining_company,""),h.Kb(7),h.sc("search",c.search),h.Kb(8),h.sc("ngClass",h.vc(7,Ic,0===c.tab)),h.Kb(3),h.sc("ngClass",h.vc(9,Ic,1===c.tab)),h.Kb(2),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.k,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();var Ac=i("WF//");function Nc(t,c){1&t&&(h.cc(0,"div",18),h.cc(1,"h4"),h.Lc(2,"No records found"),h.bc(),h.bc())}function wc(t,c){if(1&t){const t=h.dc();h.cc(0,"tr"),h.cc(1,"td"),h.Lc(2),h.bc(),h.cc(3,"td"),h.Lc(4),h.bc(),h.cc(5,"td"),h.Lc(6),h.bc(),h.cc(7,"td",23),h.cc(8,"button",24),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onEdit(i)})),h.Xb(9,"i",25),h.bc(),h.cc(10,"button",26),h.kc("click",(function(){h.Dc(t);const i=c.$implicit;return h.mc(2).onDelete(i)})),h.Xb(11,"i",27),h.bc(),h.bc(),h.bc()}if(2&t){const t=c.$implicit;h.Kb(2),h.Mc(t.name),h.Kb(2),h.Mc(t.material_type),h.Kb(2),h.Mc(t.grade)}}function Mc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",19),h.cc(1,"table",20),h.cc(2,"thead"),h.cc(3,"tr"),h.cc(4,"th"),h.cc(5,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(6,"th"),h.cc(7,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.cc(8,"th"),h.cc(9,"app-sort-column",21),h.kc("onSortBy",(function(c){return h.Dc(t),h.mc().onSortBy(c)})),h.bc(),h.bc(),h.Xb(10,"th"),h.bc(),h.bc(),h.cc(11,"tbody"),h.Jc(12,wc,12,3,"tr",22),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(5),h.sc("name","Name")("sort","name")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Material Type")("sort","material_type")("dir",t.sortDir)("current",t.sort),h.Kb(2),h.sc("name","Grade")("sort","grade")("dir",t.sortDir)("current",t.sort),h.Kb(3),h.sc("ngForOf",t.list)}}function Bc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",28),h.cc(1,"div",29),h.cc(2,"pagination",30),h.kc("ngModelChange",(function(c){return h.Dc(t),h.mc().page=c}))("pageChanged",(function(c){return h.Dc(t),h.mc().pageChanged(c)})),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(2),h.sc("totalItems",t.totalCount)("itemsPerPage",t.pageSize)("maxSize",t.MAX_PAGE_NUMBERS)("ngModel",t.page)}}let Pc=(()=>{class t{constructor(t,c,i,s,e){this.router=t,this.materialService=c,this.msService=i,this.toastr=s,this.modalService=e,this.isLoading=!1,this.list=[],this.totalCount=0,this.pageSize=l.a.PAGE_SIZE,this.page=1,this.search="",this.sort="name",this.sortDir="asc",this.sx=0,this.sy=0,this.uiState="setup.material.material-listing",this.isEmpty=u.a.isEmpty,this.PAGE_SIZE=l.a.PAGE_SIZE,this.MAX_PAGE_NUMBERS=l.a.MAX_PAGE_NUMBERS,this.subs=this.msService.get().subscribe(t=>{if(t.name===this.uiState){const c=t.data;this.page=c.page,this.sort=c.sort,this.sortDir=c.dir,this.search=c.search,this.sx=c.sx,this.sy=c.sy}})}ngOnInit(){this.load()}ngOnDestroy(){this.subs.unsubscribe()}load(){""===this.search?(this.isLoading=!0,this.materialService.list(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})):this.onSearch(this.search)}onSearch(t){this.search=t,this.isLoading=!0,this.materialService.search(this.page,l.a.PAGE_SIZE,this.sort,this.sortDir,t).subscribe(t=>{this.list=t.body,this.totalCount=Number(t.headers.get(l.a.HTTP_HEADER.X_TOTAL_COUNT)),this.isLoading=!1,setTimeout(()=>{window.scrollTo(this.sx,this.sy)},200)},t=>{},()=>{this.isLoading=!1})}pageChanged(t){this.page=t.page,this.load()}onSortBy(t){""===t.sort&&"asc"===t.dir?(this.sort="name",this.sortDir="asc"):(this.sort=t.sort,this.sortDir=t.dir),this.load()}goto(t){this.msService.send(this.uiState,{page:this.page,sort:this.sort,dir:this.sortDir,search:this.search,sx:window.scrollX,sy:window.scrollY}),this.router.navigate(["/ams/setup/material/"+t])}onEdit(t){this.goto("edit/"+t.id)}onDelete(t){this.bsModalRef=this.modalService.show(b.a,{initialState:{title:"Delete Material",message:`Are you sure to delete this Material ${t.name} ?`}}),this.bsModalRef.content.onClose.subscribe(c=>{!0===c.result&&this.materialService.remove(t.id).subscribe(t=>{this.toastr.success("Material successfully deleted"),this.load()})})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(d.g),h.Wb(Ac.a),h.Wb(f.a),h.Wb(v.b),h.Wb(n.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-material-listing"]],decls:21,vars:4,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-sm-6","col-12","p-1"],[3,"search","onSearch"],[1,"col-sm-6","col-12","p-1","text-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card-body"],["class","text-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"text-center"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","table-hover"],[3,"name","sort","dir","current","onSortBy"],[4,"ngFor","ngForOf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","btn-primary","mr-2",3,"click"],[1,"fas","fa-pencil-alt"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-footer"],[1,"float-right"],[3,"totalItems","itemsPerPage","maxSize","ngModel","ngModelChange","pageChanged"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Material Listing"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.cc(7,"div",1),h.cc(8,"div",6),h.cc(9,"div",7),h.cc(10,"div",8),h.cc(11,"div",9),h.cc(12,"app-search-input",10),h.kc("onSearch",(function(t){return c.onSearch(t)})),h.bc(),h.bc(),h.cc(13,"div",11),h.cc(14,"button",12),h.kc("click",(function(){return c.goto("create")})),h.Xb(15,"i",13),h.Lc(16," Add New"),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(17,"div",14),h.Jc(18,Nc,3,0,"div",15),h.Jc(19,Mc,13,13,"div",16),h.bc(),h.Jc(20,Bc,3,4,"div",17),h.bc(),h.bc(),h.bc()),2&t&&(h.Kb(12),h.sc("search",c.search),h.Kb(6),h.sc("ngIf",c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",!c.isEmpty(c.list)&&!c.isLoading),h.Kb(1),h.sc("ngIf",c.totalCount))},directives:[y.a,s.m,_.a,s.l,a.a,e.j,e.l],styles:[""]}),t})();function Tc(t,c){1&t&&(h.cc(0,"small",23),h.Lc(1," Name is required "),h.bc())}const Xc=function(t){return{"is-invalid":t}};function Uc(t,c){if(1&t){const t=h.dc();h.cc(0,"div",1),h.cc(1,"form",7),h.kc("ngSubmit",(function(){return h.Dc(t),h.mc().onSubmit()})),h.cc(2,"div",8),h.cc(3,"div",9),h.cc(4,"div",10),h.cc(5,"label",11),h.Lc(6,"Name\xa0"),h.cc(7,"span",12),h.Lc(8,"*"),h.bc(),h.bc(),h.cc(9,"div",13),h.Xb(10,"input",14),h.Jc(11,Tc,2,0,"small",15),h.bc(),h.bc(),h.cc(12,"div",10),h.cc(13,"label",11),h.Lc(14,"Material Type"),h.bc(),h.cc(15,"div",13),h.Xb(16,"input",16),h.bc(),h.bc(),h.cc(17,"div",10),h.cc(18,"label",11),h.Lc(19,"Grade"),h.bc(),h.cc(20,"div",13),h.Xb(21,"input",17),h.bc(),h.bc(),h.bc(),h.cc(22,"div",18),h.cc(23,"button",19),h.kc("click",(function(){return h.Dc(t),h.mc().onBack()})),h.Xb(24,"i",20),h.Lc(25," Back"),h.bc(),h.cc(26,"button",21),h.Xb(27,"i",22),h.Lc(28," Save"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc()}if(2&t){const t=h.mc();h.Kb(1),h.sc("formGroup",t.mform),h.Kb(9),h.sc("ngClass",h.vc(3,Xc,t.invalid("name"))),h.Kb(1),h.sc("ngIf",t.invalid("name")&&t.f.name.hasError("required"))}}let Gc=(()=>{class t extends I.a{constructor(t,c,i,s,e){super(),this.fb=t,this.route=c,this.router=i,this.materialService=s,this.toastr=e,this.isLoading=!1,this.data={id:""},this.isEdit=!1,this.createForm()}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.get("id"),K.a.isNull(this.id)||(this.isEdit=!0),this.load()})}createForm(){this.mform=this.fb.group({name:["",[e.r.required]],material_type:[""],grade:[""]})}setForm(){const t=this.data;this.mform.patchValue({name:t.name,material_type:t.material_type,grade:t.grade})}load(){K.a.isNull(this.id)||K.a.isUndefined(this.id)||(this.isLoading=!0,this.materialService.edit(this.id).subscribe(t=>{this.data=t,this.setForm()},t=>{},()=>{this.isLoading=!1}))}onBack(){this.router.navigate(["/ams/setup/material/list"])}onSubmit(){if(this.mform.invalid)return void this.mform.markAllAsTouched();const t=this.mform.value,c={name:t.name,material_type:t.material_type,grade:t.grade};this.isEdit?this.materialService.update(this.data.id,c).subscribe(t=>{this.toastr.success("Material successfully updated")}):this.materialService.create(c).subscribe(t=>{this.toastr.success("New Material successfully created"),this.mform.reset()})}}return t.\u0275fac=function(c){return new(c||t)(h.Wb(e.c),h.Wb(d.a),h.Wb(d.g),h.Wb(Ac.a),h.Wb(v.b))},t.\u0275cmp=h.Qb({type:t,selectors:[["app-material-create"]],features:[h.Hb],decls:8,vars:1,consts:[[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-12"],[1,"m-0","text-dark"],[1,"content"],["class","container-fluid",4,"ngIf"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-2","col-form-label"],[1,"text-danger"],[1,"col-sm-10"],["type","text","placeholder","Name","name","name","formControlName","name",1,"form-control",3,"ngClass"],["class","badge badge-danger",4,"ngIf"],["type","text","placeholder","Material Type","name","material_type","formControlName","material_type",1,"form-control"],["type","text","placeholder","Grade","name","grade","formControlName","grade",1,"form-control"],[1,"card-footer"],["type","button",1,"btn","btn-outline-dark","mr-2",3,"click"],[1,"fas","fa-chevron-circle-left"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-save"],[1,"badge","badge-danger"]],template:function(t,c){1&t&&(h.cc(0,"section",0),h.cc(1,"div",1),h.cc(2,"div",2),h.cc(3,"div",3),h.cc(4,"h1",4),h.Lc(5,"Add / Edit Material"),h.bc(),h.bc(),h.bc(),h.bc(),h.bc(),h.cc(6,"section",5),h.Jc(7,Uc,29,5,"div",6),h.bc()),2&t&&(h.Kb(7),h.sc("ngIf",!c.isLoading))},directives:[s.m,e.t,e.k,e.e,e.a,e.j,e.d,s.k],styles:[""]}),t})();const Wc=[{path:"user",children:[{path:"list",component:C},{path:"create",component:W},{path:"edit/:id",component:W}]},{path:"country",children:[{path:"list",component:F},{path:"create",component:V},{path:"edit/:id",component:V}]},{path:"state",children:[{path:"list",component:st},{path:"create",component:at},{path:"edit/:id",component:at}]},{path:"buyer",children:[{path:"list",component:mt},{path:"create",component:Ct},{path:"edit/:id",component:Ct},{path:"truck/:buyer_id",children:[{path:"list",component:Nt},{path:"create",component:Pt},{path:"edit/:id",component:Pt}]},{path:"driver/:buyer_id",children:[{path:"list",component:Ot},{path:"create",component:Ft},{path:"edit/:id",component:Ft}]},{path:"user/:buyer_id",children:[{path:"list",component:cc}]}]},{path:"mining-company",children:[{path:"list",component:oc},{path:"create",component:_c},{path:"edit/:id",component:_c},{path:"user/:mining_company_id",children:[{path:"list",component:xc}]}]},{path:"material",children:[{path:"list",component:Pc},{path:"create",component:Gc},{path:"edit/:id",component:Gc}]}];let Oc=(()=>{class t{}return t.\u0275mod=h.Ub({type:t}),t.\u0275inj=h.Tb({factory:function(c){return new(c||t)},imports:[[d.i.forChild(Wc)],d.i]}),t})();var Rc=i("jgPy");let $c=(()=>{class t{}return t.\u0275mod=h.Ub({type:t}),t.\u0275inj=h.Tb({factory:function(c){return new(c||t)},providers:[g,O.a,Q.a,dt.a,Dt.a,Tt.a,Zt,ic.a,Sc,Ac.a],imports:[[s.c,Oc,e.g,e.o,Rc.a,r.b,n.c.forRoot(),o.c.forRoot(),a.b.forRoot()]]}),t})()}}]);